{
  "name": "VMware_vSphere_6-5_ESXi_STIG",
  "title": "VMware vSphere 6.5 ESXi Security Technical Implementation Guide",
  "maintainer": "Kasey Linden",
  "copyright": "Kasey Linden",
  "copyright_email": "klinden@vmware.com",
  "license": "Apache 2.0",
  "summary": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via e-mail to the following address: disa.stig_spt@mail.mil.",
  "version": "0.1.0",
  "supports": [],
  "controls": [
    {
      "title": "The ESXi host must set a timeout to automatically disable idle\nsessions after 10 minutes.",
      "desc": "If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The ESXiShellInteractiveTimeOut allows you to\nautomatically terminate idle shell sessions.",
      "descriptions": {
        "default": "If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The ESXiShellInteractiveTimeOut allows you to\nautomatically terminate idle shell sessions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000163-VMM-000700",
        "gid": "V-94029",
        "rid": "SV-104115r1_rule",
        "stig_id": "ESXI-65-000041",
        "fix_id": "F-100277r1_fix",
        "cci": [
          "CCI-001133"
        ],
        "nist": [
          "SC-10",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.ESXiShellInteractiveTimeOut value and verify it is set to 600 (10\nMinutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut\n\nIf the UserVars.ESXiShellInteractiveTimeOut setting is not set to 600, this is\na finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.ESXiShellInteractiveTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94029\" do\n  title \"The ESXi host must set a timeout to automatically disable idle\nsessions after 10 minutes.\"\n  desc  \"If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The ESXiShellInteractiveTimeOut allows you to\nautomatically terminate idle shell sessions.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000163-VMM-000700\"\n  tag \"gid\": \"V-94029\"\n  tag \"rid\": \"SV-104115r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000041\"\n  tag \"fix_id\": \"F-100277r1_fix\"\n  tag \"cci\": [\"CCI-001133\"]\n  tag \"nist\": [\"SC-10\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.ESXiShellInteractiveTimeOut value and verify it is set to 600 (10\nMinutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut\n\nIf the UserVars.ESXiShellInteractiveTimeOut setting is not set to 600, this is\na finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.ESXiShellInteractiveTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut |\nSet-AdvancedSetting -Value 600\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"600\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94029.rb",
        "line": 1
      },
      "id": "V-94029"
    },
    {
      "title": "The ESXi host SSH daemon must be configured to not allow X11\nforwarding.",
      "desc": "X11 forwarding over SSH allows for the secure remote execution of\nX11-based applications. This feature can increase the attack surface of an SSH\nconnection.",
      "descriptions": {
        "default": "X11 forwarding over SSH allows for the secure remote execution of\nX11-based applications. This feature can increase the attack surface of an SSH\nconnection."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93993",
        "rid": "SV-104079r1_rule",
        "stig_id": "ESXI-65-000023",
        "fix_id": "F-100241r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^X11Forwarding\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"X11Forwarding no\", this\nis a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nX11Forwarding no"
      },
      "code": "control \"V-93993\" do\n  title \"The ESXi host SSH daemon must be configured to not allow X11\nforwarding.\"\n  desc  \"X11 forwarding over SSH allows for the secure remote execution of\nX11-based applications. This feature can increase the attack surface of an SSH\nconnection.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93993\"\n  tag \"rid\": \"SV-104079r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000023\"\n  tag \"fix_id\": \"F-100241r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^X11Forwarding\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"X11Forwarding no\\\", this\nis a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nX11Forwarding no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93993.rb",
        "line": 1
      },
      "id": "V-93993"
    },
    {
      "title": "The password hashes stored on the ESXi host must have been generated\nusing a FIPS 140-2 approved cryptographic hashing algorithm.",
      "desc": "Systems must employ cryptographic hashes for passwords using the SHA-2\nfamily of algorithms or FIPS 140-2 approved successors. The use of unapproved\nalgorithms may result in weak password hashes more vulnerable to compromise.",
      "descriptions": {
        "default": "Systems must employ cryptographic hashes for passwords using the SHA-2\nfamily of algorithms or FIPS 140-2 approved successors. The use of unapproved\nalgorithms may result in weak password hashes more vulnerable to compromise."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94013",
        "rid": "SV-104099r1_rule",
        "stig_id": "ESXI-65-000033",
        "fix_id": "F-100261r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^password\" /etc/pam.d/passwd | grep sufficient\n\nIf sha512 is not listed, this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in “/etc/pam.d/passwd”:\n\npassword sufficient /lib/security/$ISA/pam_unix.so use_authtok nullok shadow\nsha512 remember=5"
      },
      "code": "control \"V-94013\" do\n  title \"The password hashes stored on the ESXi host must have been generated\nusing a FIPS 140-2 approved cryptographic hashing algorithm.\"\n  desc  \"Systems must employ cryptographic hashes for passwords using the SHA-2\nfamily of algorithms or FIPS 140-2 approved successors. The use of unapproved\nalgorithms may result in weak password hashes more vulnerable to compromise.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94013\"\n  tag \"rid\": \"SV-104099r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000033\"\n  tag \"fix_id\": \"F-100261r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^password\\\" /etc/pam.d/passwd | grep sufficient\n\nIf sha512 is not listed, this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in “/etc/pam.d/passwd”:\n\npassword sufficient /lib/security/$ISA/pam_unix.so use_authtok nullok shadow\nsha512 remember=5\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94013.rb",
        "line": 1
      },
      "id": "V-94013"
    },
    {
      "title": "The ESXi host SSH daemon must ignore .rhosts files.",
      "desc": "SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH can emulate the behavior of the\nobsolete rsh command in allowing users to enable insecure access to their\naccounts via \".rhosts\" files.",
      "descriptions": {
        "default": "SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH can emulate the behavior of the\nobsolete rsh command in allowing users to enable insecure access to their\naccounts via \".rhosts\" files."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000107-VMM-000530",
        "gid": "V-93971",
        "rid": "SV-104057r1_rule",
        "stig_id": "ESXI-65-000012",
        "fix_id": "F-100219r1_fix",
        "cci": [
          "CCI-000767"
        ],
        "nist": [
          "IA-2 (3)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^IgnoreRhosts\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"IgnoreRhosts yes\", this\nis a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\":\n\nIgnoreRhosts yes"
      },
      "code": "control \"V-93971\" do\n  title \"The ESXi host SSH daemon must ignore .rhosts files.\"\n  desc  \"SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH can emulate the behavior of the\nobsolete rsh command in allowing users to enable insecure access to their\naccounts via \\\".rhosts\\\" files.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000107-VMM-000530\"\n  tag \"gid\": \"V-93971\"\n  tag \"rid\": \"SV-104057r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000012\"\n  tag \"fix_id\": \"F-100219r1_fix\"\n  tag \"cci\": [\"CCI-000767\"]\n  tag \"nist\": [\"IA-2 (3)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^IgnoreRhosts\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"IgnoreRhosts yes\\\", this\nis a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nAdd or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nIgnoreRhosts yes\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93971.rb",
        "line": 1
      },
      "id": "V-93971"
    },
    {
      "title": "The ESXi host must retain the Standard Mandatory DoD Notice and\nConsent Banner on the screen until users acknowledge the usage conditions and\ntake explicit actions to log on for further access.",
      "desc": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.",
      "descriptions": {
        "default": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000024-VMM-000070",
        "gid": "V-94495",
        "rid": "SV-104325r1_rule",
        "stig_id": "ESXI-65-100007",
        "fix_id": "F-100611r1_fix",
        "cci": [
          "CCI-000050"
        ],
        "nist": [
          "AC-8 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Annotations.WelcomeMessage\"\nvalue and verify it contains the DoD logon banner:\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage\n\nCheck for either of the following login banners based on the character\nlimitations imposed by the system. An exact match of the text is required.\n\nIf one of these banners is not displayed, this is a finding.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent\nto the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests- -not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nOR\n\nI've read & consent to terms in IS user agreem't.\n\nIf the DCUI logon screen does not display the DoD logon banner, this is a\nfinding.",
        "fix": "From a PowerCLI command prompt while connected to the ESXi host\ncopy the following contents into a script(.ps1 file) and run to set the DCUI\nscreen to display the DoD logon banner:\n\n<script begin>\n\n$value = @\"\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} ,\n{ip}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct}\n{esxversion}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory}\nRAM{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:black}{color:white}{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are\naccessing a U.S. Government (USG) Information System (IS) that is provided for\nUSG-authorized use only. By      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this\nIS (which includes any device attached to this IS), you consent to the\nfollowing conditions:                 {/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} to,\npenetration testing, COMSEC monitoring, network operations and defense,\npersonnel misconduct (PM), law      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} enforcement\n(LE), and counterintelligence (CI) investigations.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - At any\ntime, the USG may inspect and seize data stored on this\nIS.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nCommunications using, or data stored on, this IS are not private, are subject\nto routine monitoring,            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} interception,\nand search, and may be disclosed or used for any USG-authorized purpose.\n                  {/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - This IS\nincludes security measures (e.g., authentication and access controls) to\nprotect USG interests--not     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} for your\npersonal benefit or privacy.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nNotwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching    {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} or monitoring\nof the content of privileged communications, or work product, related to\npersonal representation  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work       {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} product are\nprivate and confidential. See User Agreement for\ndetails.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2>\nAccept Conditions and Customize System / View Logs{/align}{align:right}<F12>\nAccept Conditions and Shut Down/Restart  {bgcolor:black}\n{/color}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n\"\n\n@Get-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage |\nSet-AdvancedSetting -Value $value\n\n<script end>"
      },
      "code": "control \"V-94495\" do\n  title \"The ESXi host must retain the Standard Mandatory DoD Notice and\nConsent Banner on the screen until users acknowledge the usage conditions and\ntake explicit actions to log on for further access.\"\n  desc  \"Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000024-VMM-000070\"\n  tag \"gid\": \"V-94495\"\n  tag \"rid\": \"SV-104325r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100007\"\n  tag \"fix_id\": \"F-100611r1_fix\"\n  tag \"cci\": [\"CCI-000050\"]\n  tag \"nist\": [\"AC-8 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Annotations.WelcomeMessage\\\"\nvalue and verify it contains the DoD logon banner:\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage\n\nCheck for either of the following login banners based on the character\nlimitations imposed by the system. An exact match of the text is required.\n\nIf one of these banners is not displayed, this is a finding.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent\nto the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests- -not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nOR\n\nI've read & consent to terms in IS user agreem't.\n\nIf the DCUI logon screen does not display the DoD logon banner, this is a\nfinding.\"\n  tag \"fix\": \"From a PowerCLI command prompt while connected to the ESXi host\ncopy the following contents into a script(.ps1 file) and run to set the DCUI\nscreen to display the DoD logon banner:\n\n<script begin>\n\n$value = @\\\"\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} ,\n{ip}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct}\n{esxversion}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory}\nRAM{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:black}{color:white}{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are\naccessing a U.S. Government (USG) Information System (IS) that is provided for\nUSG-authorized use only. By      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this\nIS (which includes any device attached to this IS), you consent to the\nfollowing conditions:                 {/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} to,\npenetration testing, COMSEC monitoring, network operations and defense,\npersonnel misconduct (PM), law      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} enforcement\n(LE), and counterintelligence (CI) investigations.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - At any\ntime, the USG may inspect and seize data stored on this\nIS.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nCommunications using, or data stored on, this IS are not private, are subject\nto routine monitoring,            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} interception,\nand search, and may be disclosed or used for any USG-authorized purpose.\n                  {/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  - This IS\nincludes security measures (e.g., authentication and access controls) to\nprotect USG interests--not     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} for your\npersonal benefit or privacy.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nNotwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching    {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} or monitoring\nof the content of privileged communications, or work product, related to\npersonal representation  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work       {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black} product are\nprivate and confidential. See User Agreement for\ndetails.{/color}{/bgcolor}{/align}\n{bgcolor:black}\n{/color}{align:left}{bgcolor:yellow}{color:black}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2>\nAccept Conditions and Customize System / View Logs{/align}{align:right}<F12>\nAccept Conditions and Shut Down/Restart  {bgcolor:black}\n{/color}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}{/color}{/bgcolor}\n\\\"\n\n@Get-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage |\nSet-AdvancedSetting -Value $value\n\n<script end>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94495.rb",
        "line": 1
      },
      "id": "V-94495"
    },
    {
      "title": "The ESXi host must disable the Managed Object Browser (MOB).",
      "desc": "The Managed Object Browser (MOB) provides a way to explore the object\nmodel used by the VMkernel to manage the host and enables configurations to be\nchanged as well. This interface is meant to be used primarily for debugging the\nvSphere SDK, but because there are no access controls it could also be used as\na method obtain information about a host being targeted for unauthorized\naccess.  By default this is disabled for ESXi in version 6.",
      "descriptions": {
        "default": "The Managed Object Browser (MOB) provides a way to explore the object\nmodel used by the VMkernel to manage the host and enables configurations to be\nchanged as well. This interface is meant to be used primarily for debugging the\nvSphere SDK, but because there are no access controls it could also be used as\na method obtain information about a host being targeted for unauthorized\naccess.  By default this is disabled for ESXi in version 6."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000095-VMM-000480",
        "gid": "V-94015",
        "rid": "SV-104101r1_rule",
        "stig_id": "ESXI-65-000034",
        "fix_id": "F-100263r1_fix",
        "cci": [
          "CCI-000381"
        ],
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nConfig.HostAgent.plugins.solo.enableMob value and verify it is set to false.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob\n\nIf the Config.HostAgent.plugins.solo.enableMob setting is not set to false,\nthis is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.solo.enableMob value and configure it to false.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob\n| Set-AdvancedSetting -Value false"
      },
      "code": "control \"V-94015\" do\n  title \"The ESXi host must disable the Managed Object Browser (MOB).\"\n  desc  \"The Managed Object Browser (MOB) provides a way to explore the object\nmodel used by the VMkernel to manage the host and enables configurations to be\nchanged as well. This interface is meant to be used primarily for debugging the\nvSphere SDK, but because there are no access controls it could also be used as\na method obtain information about a host being targeted for unauthorized\naccess.  By default this is disabled for ESXi in version 6.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000095-VMM-000480\"\n  tag \"gid\": \"V-94015\"\n  tag \"rid\": \"SV-104101r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000034\"\n  tag \"fix_id\": \"F-100263r1_fix\"\n  tag \"cci\": [\"CCI-000381\"]\n  tag \"nist\": [\"CM-7 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nConfig.HostAgent.plugins.solo.enableMob value and verify it is set to false.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob\n\nIf the Config.HostAgent.plugins.solo.enableMob setting is not set to false,\nthis is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.solo.enableMob value and configure it to false.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob\n| Set-AdvancedSetting -Value false\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"false\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94015.rb",
        "line": 1
      },
      "id": "V-94015"
    },
    {
      "title": "The virtual switch MAC Address Change policy must be set to reject on\nthe ESXi host.",
      "desc": "If the virtual machine operating system changes the MAC address, it\ncan send frames with an impersonated source MAC address at any time. This\nallows it to stage malicious attacks on the devices in a network by\nimpersonating a network adaptor authorized by the receiving network. This will\nprevent VMs from changing their effective MAC address. It will affect\napplications that require this functionality. This will also affect how a layer\n2 bridge will operate. This will also affect applications that require a\nspecific MAC address for licensing. Reject MAC Changes can be set at the\nvSwitch and/or the Portgroup level. You can override switch level settings at\nthe Portgroup level.",
      "descriptions": {
        "default": "If the virtual machine operating system changes the MAC address, it\ncan send frames with an impersonated source MAC address at any time. This\nallows it to stage malicious attacks on the devices in a network by\nimpersonating a network adaptor authorized by the receiving network. This will\nprevent VMs from changing their effective MAC address. It will affect\napplications that require this functionality. This will also affect how a layer\n2 bridge will operate. This will also affect applications that require a\nspecific MAC address for licensing. Reject MAC Changes can be set at the\nvSwitch and/or the Portgroup level. You can override switch level settings at\nthe Portgroup level."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94067",
        "rid": "SV-104153r1_rule",
        "stig_id": "ESXI-65-000060",
        "fix_id": "F-100315r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \"MAC Address Changes\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"MAC Address Changes\" policy is set to accept, this is a finding.",
        "fix": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \"MAC Address Changes\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -MacChanges $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy\n-MacChangesInherited $true"
      },
      "code": "control \"V-94067\" do\n  title \"The virtual switch MAC Address Change policy must be set to reject on\nthe ESXi host.\"\n  desc  \"If the virtual machine operating system changes the MAC address, it\ncan send frames with an impersonated source MAC address at any time. This\nallows it to stage malicious attacks on the devices in a network by\nimpersonating a network adaptor authorized by the receiving network. This will\nprevent VMs from changing their effective MAC address. It will affect\napplications that require this functionality. This will also affect how a layer\n2 bridge will operate. This will also affect applications that require a\nspecific MAC address for licensing. Reject MAC Changes can be set at the\nvSwitch and/or the Portgroup level. You can override switch level settings at\nthe Portgroup level.\"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94067\"\n  tag \"rid\": \"SV-104153r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000060\"\n  tag \"fix_id\": \"F-100315r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \\\"MAC Address Changes\\\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \\\"MAC Address Changes\\\" policy is set to accept, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \\\"MAC Address Changes\\\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -MacChanges $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy\n-MacChangesInherited $true\"\n\ncommand1 = 'Get-VirtualSwitch | Get-SecurityPolicy | Select MacChanges -ExpandProperty MacChanges'\ndescribe powercli_command(command1) do\n  its('stdout.strip') { should_not match \"False\" }\nend\n\ncommand2 = 'Get-VirtualPortGroup | Get-SecurityPolicy | Select MacChangesInherited -ExpandProperty MacChangesInherited'\ndescribe powercli_command(command2) do\n  its('stdout.strip') { should match \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94067.rb",
        "line": 1
      },
      "id": "V-94067"
    },
    {
      "title": "The ESXi host  must enforce password complexity by requiring that at\nleast one upper-case character be used.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000069-VMM-000360",
        "gid": "V-94009",
        "rid": "SV-104095r1_rule",
        "stig_id": "ESXI-65-000031",
        "fix_id": "F-100257r1_fix",
        "cci": [
          "CCI-000192"
        ],
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nSecurity.PasswordQualityControl value and verify it is set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the Security.PasswordQualityControl setting is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.PasswordQualityControl value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94009\" do\n  title \"The ESXi host  must enforce password complexity by requiring that at\nleast one upper-case character be used.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000069-VMM-000360\"\n  tag \"gid\": \"V-94009\"\n  tag \"rid\": \"SV-104095r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000031\"\n  tag \"fix_id\": \"F-100257r1_fix\"\n  tag \"cci\": [\"CCI-000192\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nSecurity.PasswordQualityControl value and verify it is set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the Security.PasswordQualityControl setting is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.PasswordQualityControl value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94009.rb",
        "line": 1
      },
      "id": "V-94009"
    },
    {
      "title": "The ESXi host must be configured to disable non-essential capabilities\nby disabling SSH.",
      "desc": "The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.",
      "descriptions": {
        "default": "The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000095-VMM-000480",
        "gid": "V-94017",
        "rid": "SV-104103r1_rule",
        "stig_id": "ESXI-65-000035",
        "fix_id": "F-100265r1_fix",
        "cci": [
          "CCI-000381"
        ],
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit and view\nthe \"SSH\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"}\n\nIf the ESXi SSH service is running, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit then select\nthe SSH service and click the Stop button to stop the service. Use the\npull-down menu to change the Startup policy to \"Start and stop manually\" and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nStop-VMHostService"
      },
      "code": "control \"V-94017\" do\n  title \"The ESXi host must be configured to disable non-essential capabilities\nby disabling SSH.\"\n  desc  \"The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000095-VMM-000480\"\n  tag \"gid\": \"V-94017\"\n  tag \"rid\": \"SV-104103r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000035\"\n  tag \"fix_id\": \"F-100265r1_fix\"\n  tag \"cci\": [\"CCI-000381\"]\n  tag \"nist\": [\"CM-7 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit and view\nthe \\\"SSH\\\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"}\n\nIf the ESXi SSH service is running, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit then select\nthe SSH service and click the Stop button to stop the service. Use the\npull-down menu to change the Startup policy to \\\"Start and stop manually\\\" and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nStop-VMHostService\"\n\n#command = 'Get-VMHost | Get-VMHostService | Where {$_.Label -like \"SSH\"} | Select Policy, Running | Format-List'\n#describe powercli_command(command) do\n#  its('stdout.strip') { should match \"True\" }\n#  its('stdout.strip') { should_not match \"on\" }\n#end\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94017.rb",
        "line": 1
      },
      "id": "V-94017"
    },
    {
      "title": "The ESXi host must protect audit information from unauthorized\nmodification by configuring remote logging.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000058-VMM-000270",
        "gid": "V-94523",
        "rid": "SV-104353r1_rule",
        "stig_id": "ESXI-65-200004",
        "fix_id": "F-100639r1_fix",
        "cci": [
          "CCI-000163"
        ],
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" value is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<insert syslog server hostname>\""
      },
      "code": "control \"V-94523\" do\n  title \"The ESXi host must protect audit information from unauthorized\nmodification by configuring remote logging.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000058-VMM-000270\"\n  tag \"gid\": \"V-94523\"\n  tag \"rid\": \"SV-104353r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200004\"\n  tag \"fix_id\": \"F-100639r1_fix\"\n  tag \"cci\": [\"CCI-000163\"]\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \\\"Syslog.global.logHost\\\" value is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<insert syslog server hostname>\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94523.rb",
        "line": 1
      },
      "id": "V-94523"
    },
    {
      "title": "The ESXi host must enable Secure Boot.",
      "desc": "Secure Boot is a protocol of UEFI firmware that ensures the integrity\nof the boot process from hardware up through to the OS. Secure Boot for ESXi\nrequires support from the firmware and it requires that all ESXi kernel\nmodules, drivers, and VIBs be signed by VMware or a partner subordinate.",
      "descriptions": {
        "default": "Secure Boot is a protocol of UEFI firmware that ensures the integrity\nof the boot process from hardware up through to the OS. Secure Boot for ESXi\nrequires support from the firmware and it requires that all ESXi kernel\nmodules, drivers, and VIBs be signed by VMware or a partner subordinate."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94487",
        "rid": "SV-104317r1_rule",
        "stig_id": "ESXI-65-000076",
        "fix_id": "F-100603r2_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s\n\nIf the output is not Enabled, this is a finding.",
        "fix": "Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -c\n\nIf the output indicates that Secure Boot cannot be enabled, correct the\ndiscrepancies and try again. If the discrepancies cannot be rectified this\nfinding is downgraded to a CAT III.\n\nConsult your vendor documentation and boot the host into BIOS setup mode.\nEnable UEFI boot mode and Secure Boot. Restart the host.\n\nTemporarily enable SSH, connect to the ESXi host and run the following command\nto verify that Secure Boot is enabled:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s"
      },
      "code": "control \"V-94487\" do\n  title \"The ESXi host must enable Secure Boot.\"\n  desc  \"Secure Boot is a protocol of UEFI firmware that ensures the integrity\nof the boot process from hardware up through to the OS. Secure Boot for ESXi\nrequires support from the firmware and it requires that all ESXi kernel\nmodules, drivers, and VIBs be signed by VMware or a partner subordinate.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94487\"\n  tag \"rid\": \"SV-104317r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000076\"\n  tag \"fix_id\": \"F-100603r2_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s\n\nIf the output is not Enabled, this is a finding.\"\n  tag \"fix\": \"Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -c\n\nIf the output indicates that Secure Boot cannot be enabled, correct the\ndiscrepancies and try again. If the discrepancies cannot be rectified this\nfinding is downgraded to a CAT III.\n\nConsult your vendor documentation and boot the host into BIOS setup mode.\nEnable UEFI boot mode and Secure Boot. Restart the host.\n\nTemporarily enable SSH, connect to the ESXi host and run the following command\nto verify that Secure Boot is enabled:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94487.rb",
        "line": 1
      },
      "id": "V-94487"
    },
    {
      "title": "The ESXi host SSH daemon must not accept environment variables from\nthe client.",
      "desc": "Environment variables can be used to change the behavior of remote\nsessions and should be limited. Locale environment variables that specify the\nlanguage, character set, and other features modifying the operation of software\nto match the user's preferences.",
      "descriptions": {
        "default": "Environment variables can be used to change the behavior of remote\nsessions and should be limited. Locale environment variables that specify the\nlanguage, character set, and other features modifying the operation of software\nto match the user's preferences."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93995",
        "rid": "SV-104081r1_rule",
        "stig_id": "ESXI-65-000024",
        "fix_id": "F-100243r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^AcceptEnv\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"AcceptEnv\", this is a\nfinding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAcceptEnv"
      },
      "code": "control \"V-93995\" do\n  title \"The ESXi host SSH daemon must not accept environment variables from\nthe client.\"\n  desc  \"Environment variables can be used to change the behavior of remote\nsessions and should be limited. Locale environment variables that specify the\nlanguage, character set, and other features modifying the operation of software\nto match the user's preferences.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93995\"\n  tag \"rid\": \"SV-104081r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000024\"\n  tag \"fix_id\": \"F-100243r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^AcceptEnv\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"AcceptEnv\\\", this is a\nfinding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nAcceptEnv\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93995.rb",
        "line": 1
      },
      "id": "V-93995"
    },
    {
      "title": "The ESXi host must protect the confidentiality and integrity of\ntransmitted information by isolating vMotion traffic.",
      "desc": "While encrypted vMotion is available now vMotion traffic should still\nbe sequestered from other traffic to further protect it from attack. This\nnetwork must be only be accessible to other ESXi hosts preventing outside\naccess to the network.",
      "descriptions": {
        "default": "While encrypted vMotion is available now vMotion traffic should still\nbe sequestered from other traffic to further protect it from attack. This\nnetwork must be only be accessible to other ESXi hosts preventing outside\naccess to the network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000423-VMM-001700",
        "gid": "V-94043",
        "rid": "SV-104129r1_rule",
        "stig_id": "ESXI-65-000048",
        "fix_id": "F-100291r1_fix",
        "cci": [
          "CCI-002418"
        ],
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "The vMotion VMKernel port group should in a dedicated VLAN that\ncan be on a common standard or distributed virtual switch as long as the\nvMotion VLAN is not shared by any other function and it not routed to anything\nbut ESXi hosts.  The check for this will be unique per environment.  From the\nvSphere Client select the ESXi host and go to Configuration > Networking and\nreview the VLAN associated with the vMotion VMkernel(s) and verify they are\ndedicated for that purpose and are logically separated from other functions.\n\nIf long distance or cross vCenter vMotion is used the vMotion network can be\nroutable but must be accessible to only the intended ESXi hosts.\n\nIf the vMotion port group is not on an isolated VLAN and/or is routable to\nsystems other than ESXi hosts, this is a finding.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.",
        "fix": "Configuration of the vMotion VMkernel will be unique to each\nenvironment. As an example, to modify the IP address and VLAN information to\nthe correct network on a distributed switch do the following:\n\nFrom the vSphere Web Client go to Networking >> Select a distributed switch >>\nSelect a port group >> Configure >> Settings >> Edit >> VLAN. Change the \"VLAN\nType\" to \"VLAN\" and change the \"VLAN ID\" to a network allocated and\ndedicated to vMotion traffic exclusively."
      },
      "code": "control \"V-94043\" do\n  title \"The ESXi host must protect the confidentiality and integrity of\ntransmitted information by isolating vMotion traffic.\"\n  desc  \"While encrypted vMotion is available now vMotion traffic should still\nbe sequestered from other traffic to further protect it from attack. This\nnetwork must be only be accessible to other ESXi hosts preventing outside\naccess to the network.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000423-VMM-001700\"\n  tag \"gid\": \"V-94043\"\n  tag \"rid\": \"SV-104129r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000048\"\n  tag \"fix_id\": \"F-100291r1_fix\"\n  tag \"cci\": [\"CCI-002418\"]\n  tag \"nist\": [\"SC-8\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"The vMotion VMKernel port group should in a dedicated VLAN that\ncan be on a common standard or distributed virtual switch as long as the\nvMotion VLAN is not shared by any other function and it not routed to anything\nbut ESXi hosts.  The check for this will be unique per environment.  From the\nvSphere Client select the ESXi host and go to Configuration > Networking and\nreview the VLAN associated with the vMotion VMkernel(s) and verify they are\ndedicated for that purpose and are logically separated from other functions.\n\nIf long distance or cross vCenter vMotion is used the vMotion network can be\nroutable but must be accessible to only the intended ESXi hosts.\n\nIf the vMotion port group is not on an isolated VLAN and/or is routable to\nsystems other than ESXi hosts, this is a finding.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\"\n  tag \"fix\": \"Configuration of the vMotion VMkernel will be unique to each\nenvironment. As an example, to modify the IP address and VLAN information to\nthe correct network on a distributed switch do the following:\n\nFrom the vSphere Web Client go to Networking >> Select a distributed switch >>\nSelect a port group >> Configure >> Settings >> Edit >> VLAN. Change the \\\"VLAN\nType\\\" to \\\"VLAN\\\" and change the \\\"VLAN ID\\\" to a network allocated and\ndedicated to vMotion traffic exclusively.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94043.rb",
        "line": 1
      },
      "id": "V-94043"
    },
    {
      "title": "The ESXi host must configure the firewall to restrict access to\nservices running on the host.",
      "desc": "Unrestricted access to services running on an ESXi host can expose a\nhost to outside attacks and unauthorized access. Reduce the risk by configuring\nthe ESXi firewall to only allow access from authorized networks.",
      "descriptions": {
        "default": "Unrestricted access to services running on an ESXi host can expose a\nhost to outside attacks and unauthorized access. Reduce the risk by configuring\nthe ESXi firewall to only allow access from authorized networks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94059",
        "rid": "SV-104145r1_rule",
        "stig_id": "ESXI-65-000056",
        "fix_id": "F-100307r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under the Firewall section click Edit\nand for each enabled service click Firewall and review the allowed IPs. Check\nthis for Incoming and Outgoing connections.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostFirewallException | Where {$_.Enabled -eq $true} |\nSelect\nName,Enabled,@{N=\"AllIPEnabled\";E={$_.ExtensionData.AllowedHosts.AllIP}}\n\nIf for an enabled service \"Allow connections from any IP address\" is\nselected, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under the Firewall section click Edit\nand for each enabled service uncheck the check box to “Allow connections from\nany IP address,” and input the site specific network(s) required.Configure this\nfor Incoming and Outgoing connections.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$esxcli = Get-EsxCli\n#This disables the allow all rule for the target service\n$esxcli.network.firewall.ruleset.set($false,$true,\"sshServer\")\n$esxcli.network.firewall.ruleset.allowedip.add(\"192.168.0.0/24\",\"sshServer\")\n\nThis must be done for each enabled service."
      },
      "code": "control \"V-94059\" do\n  title \"The ESXi host must configure the firewall to restrict access to\nservices running on the host.\"\n  desc  \"Unrestricted access to services running on an ESXi host can expose a\nhost to outside attacks and unauthorized access. Reduce the risk by configuring\nthe ESXi firewall to only allow access from authorized networks.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94059\"\n  tag \"rid\": \"SV-104145r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000056\"\n  tag \"fix_id\": \"F-100307r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under the Firewall section click Edit\nand for each enabled service click Firewall and review the allowed IPs. Check\nthis for Incoming and Outgoing connections.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostFirewallException | Where {$_.Enabled -eq $true} |\nSelect\nName,Enabled,@{N=\\\"AllIPEnabled\\\";E={$_.ExtensionData.AllowedHosts.AllIP}}\n\nIf for an enabled service \\\"Allow connections from any IP address\\\" is\nselected, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under the Firewall section click Edit\nand for each enabled service uncheck the check box to “Allow connections from\nany IP address,” and input the site specific network(s) required.Configure this\nfor Incoming and Outgoing connections.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$esxcli = Get-EsxCli\n#This disables the allow all rule for the target service\n$esxcli.network.firewall.ruleset.set($false,$true,\\\"sshServer\\\")\n$esxcli.network.firewall.ruleset.allowedip.add(\\\"192.168.0.0/24\\\",\\\"sshServer\\\")\n\nThis must be done for each enabled service.\"\n\n\n#(Get-VMHost | Get-VMHostFirewallException | Where {$_.Enabled -eq $true}).ExtensionData.AllowedHosts.AllIP\ncommand = '(Get-VMHost | Get-VMHostFirewallException | Where {$_.Enabled -eq $true}).ExtensionData.AllowedHosts.AllIP'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94059.rb",
        "line": 1
      },
      "id": "V-94059"
    },
    {
      "title": "The ESXi host must use multifactor authentication for local access to\nprivileged accounts.",
      "desc": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000107-VMM-000530",
        "gid": "V-94027",
        "rid": "SV-104113r1_rule",
        "stig_id": "ESXI-65-000040",
        "fix_id": "F-100275r1_fix",
        "cci": [
          "CCI-000767"
        ],
        "nist": [
          "IA-2 (3)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services and view the Smart Card\nAuthentication status. If \"Enable Smart Card Authentication\" is checked, the\nsystem requires smart cards to authentication to an Active Directory Domain.\n\nFor systems that have no local user accounts, other than root and/or vpxuser,\nthis is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than root and/or vpxuser, this is a finding.",
        "fix": "The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi Host and go to Configure >> System\n>> Authentication Services and click Edit and check \"Enable Smart Card\nAuthentication\" checkbox, at the Certificates tab, click the green plus sign\nto import trusted certificate authority certificates and click OK."
      },
      "code": "control \"V-94027\" do\n  title \"The ESXi host must use multifactor authentication for local access to\nprivileged accounts.\"\n  desc  \"To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000107-VMM-000530\"\n  tag \"gid\": \"V-94027\"\n  tag \"rid\": \"SV-104113r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000040\"\n  tag \"fix_id\": \"F-100275r1_fix\"\n  tag \"cci\": [\"CCI-000767\"]\n  tag \"nist\": [\"IA-2 (3)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services and view the Smart Card\nAuthentication status. If \\\"Enable Smart Card Authentication\\\" is checked, the\nsystem requires smart cards to authentication to an Active Directory Domain.\n\nFor systems that have no local user accounts, other than root and/or vpxuser,\nthis is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than root and/or vpxuser, this is a finding.\"\n  tag \"fix\": \"The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi Host and go to Configure >> System\n>> Authentication Services and click Edit and check \\\"Enable Smart Card\nAuthentication\\\" checkbox, at the Certificates tab, click the green plus sign\nto import trusted certificate authority certificates and click OK.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94027.rb",
        "line": 1
      },
      "id": "V-94027"
    },
    {
      "title": "The ESXi host must use DoD-approved certificates.",
      "desc": "The default self-signed, VMCA issued host certificate must be replaced\nwith a DoD-approved certificate. The use of a DoD certificate on the host\nassures clients that the service they are connecting to is legitimate and\nproperly secured.",
      "descriptions": {
        "default": "The default self-signed, VMCA issued host certificate must be replaced\nwith a DoD-approved certificate. The use of a DoD certificate on the host\nassures clients that the service they are connecting to is legitimate and\nproperly secured."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94489",
        "rid": "SV-104319r1_rule",
        "stig_id": "ESXI-65-000078",
        "fix_id": "F-100605r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n# openssl x509 -in /etc/vmware/ssl/rui.crt -text | grep Issuer\n\nIf the issuer is not a DoD approved certificate authority, this is a finding.",
        "fix": "Obtain a DoD issued certificate and private key for the host\nfollowing the below requirements:\n\nKey size: 2048 bits or more (PEM encoded)\nKey format: PEM. VMware supports PKCS8 and PKCS1 (RSA keys)\nx509 version 3\nSubjectAltName must contain DNS Name=<machine_FQDN>\nCRT (Base-64) format\nContains the following Key Usages: Digital Signature, Non Repudiation, Key\nEncipherment\nStart time of one day before the current time\nCN (and SubjectAltName) set to the host name (or IP address) that the ESXi host\nhas in the vCenter Server inventory.\n\nPut the host into maintenance mode.\n\nTemporarily enable SSH on the host. SCP the new certificate and key to /tmp.\nSSH to the host. Back up the existing certificate and key:\n\nmv /etc/vmware/ssl/rui.crt /etc/vmware/ssl/rui.crt.bak\nmv /etc/vmware/ssl/rui.key /etc/vmware/ssl/rui.key.bak\n\nCopy your new certificate and key to /etc/vmware/ssl/ and rename them to\nrui.crt and rui.key respectively. Restart management agents to implement the\nnew certificate:\n\nservices.sh restart\n\nFrom the vSphere Web Client go to vCenter Inventory Lists >> vCenter Servers >>\nSelect your vCenter Server >> Manage >> Settings >> Advanced Settings. Find or\ncreate the vpxd.certmgmt.mode key and set its value to custom."
      },
      "code": "control \"V-94489\" do\n  title \"The ESXi host must use DoD-approved certificates.\"\n  desc  \"The default self-signed, VMCA issued host certificate must be replaced\nwith a DoD-approved certificate. The use of a DoD certificate on the host\nassures clients that the service they are connecting to is legitimate and\nproperly secured.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94489\"\n  tag \"rid\": \"SV-104319r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000078\"\n  tag \"fix_id\": \"F-100605r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n# openssl x509 -in /etc/vmware/ssl/rui.crt -text | grep Issuer\n\nIf the issuer is not a DoD approved certificate authority, this is a finding.\"\n  tag \"fix\": \"Obtain a DoD issued certificate and private key for the host\nfollowing the below requirements:\n\nKey size: 2048 bits or more (PEM encoded)\nKey format: PEM. VMware supports PKCS8 and PKCS1 (RSA keys)\nx509 version 3\nSubjectAltName must contain DNS Name=<machine_FQDN>\nCRT (Base-64) format\nContains the following Key Usages: Digital Signature, Non Repudiation, Key\nEncipherment\nStart time of one day before the current time\nCN (and SubjectAltName) set to the host name (or IP address) that the ESXi host\nhas in the vCenter Server inventory.\n\nPut the host into maintenance mode.\n\nTemporarily enable SSH on the host. SCP the new certificate and key to /tmp.\nSSH to the host. Back up the existing certificate and key:\n\nmv /etc/vmware/ssl/rui.crt /etc/vmware/ssl/rui.crt.bak\nmv /etc/vmware/ssl/rui.key /etc/vmware/ssl/rui.key.bak\n\nCopy your new certificate and key to /etc/vmware/ssl/ and rename them to\nrui.crt and rui.key respectively. Restart management agents to implement the\nnew certificate:\n\nservices.sh restart\n\nFrom the vSphere Web Client go to vCenter Inventory Lists >> vCenter Servers >>\nSelect your vCenter Server >> Manage >> Settings >> Advanced Settings. Find or\ncreate the vpxd.certmgmt.mode key and set its value to custom.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94489.rb",
        "line": 1
      },
      "id": "V-94489"
    },
    {
      "title": "The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown.",
      "desc": "When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged on to avoid unauthorized\nprivilege gains.  The \"DcuiTimeOut\" value defines a window of time after\nwhich the DCUI will be logged off.",
      "descriptions": {
        "default": "When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged on to avoid unauthorized\nprivilege gains.  The \"DcuiTimeOut\" value defines a window of time after\nwhich the DCUI will be logged off."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000279-VMM-001010",
        "gid": "V-94517",
        "rid": "SV-104347r1_rule",
        "stig_id": "ESXI-65-100043",
        "fix_id": "F-100633r1_fix",
        "cci": [
          "CCI-002361"
        ],
        "nist": [
          "AC-12",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"UserVars.DcuiTimeOut\" value\nand verify it is set to \"600\" (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut\n\nIf the \"UserVars.DcuiTimeOut\" setting is not set to \"600\", this is a\nfinding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"UserVars.DcuiTimeOut\" value\nand configure it to \"600\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94517\" do\n  title \"The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown.\"\n  desc  \"When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged on to avoid unauthorized\nprivilege gains.  The \\\"DcuiTimeOut\\\" value defines a window of time after\nwhich the DCUI will be logged off.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000279-VMM-001010\"\n  tag \"gid\": \"V-94517\"\n  tag \"rid\": \"SV-104347r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100043\"\n  tag \"fix_id\": \"F-100633r1_fix\"\n  tag \"cci\": [\"CCI-002361\"]\n  tag \"nist\": [\"AC-12\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"UserVars.DcuiTimeOut\\\" value\nand verify it is set to \\\"600\\\" (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut\n\nIf the \\\"UserVars.DcuiTimeOut\\\" setting is not set to \\\"600\\\", this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"UserVars.DcuiTimeOut\\\" value\nand configure it to \\\"600\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut |\nSet-AdvancedSetting -Value 600\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94517.rb",
        "line": 1
      },
      "id": "V-94517"
    },
    {
      "title": "The ESXi host must enable lockdown mode to restrict remote access.",
      "desc": "Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced.\n\n    Note: In strict lockdown mode the DCUI service is stopped. If the\nconnection to vCenter Server is lost and the vSphere Web Client is no longer\navailable, the ESXi host becomes inaccessible.",
      "descriptions": {
        "default": "Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced.\n\n    Note: In strict lockdown mode the DCUI service is stopped. If the\nconnection to vCenter Server is lost and the vSphere Web Client is no longer\navailable, the ESXi host becomes inaccessible."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000123-VMM-000620",
        "gid": "V-94491",
        "rid": "SV-104321r1_rule",
        "stig_id": "ESXI-65-100001",
        "fix_id": "F-100607r1_fix",
        "cci": [
          "CCI-001682"
        ],
        "nist": [
          "AC-2 (2)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For environments that do not use vCenter server to manage ESXi,\nthis is not applicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >> Settings\n>> System >> Security Profile.  Scroll down to \"Lockdown Mode\" and verify it\nis set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.LockdownMode}}\n\nIf \"Lockdown Mode\" is disabled, this is a finding.",
        "fix": "From the vSphere Web Client, select the ESXi Host and go to\nManage >> Settings >> System >> Security Profile.  Click edit on \"Lockdown\nMode\" and set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$level = \"lockdownNormal\" OR \"lockdownStrict\"\n$vmhost = Get-VMHost -Name <hostname> | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.ChangeLockdownMode($level)"
      },
      "code": "control \"V-94491\" do\n  title \"The ESXi host must enable lockdown mode to restrict remote access.\"\n  desc  \"Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced.\n\n    Note: In strict lockdown mode the DCUI service is stopped. If the\nconnection to vCenter Server is lost and the vSphere Web Client is no longer\navailable, the ESXi host becomes inaccessible.\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000123-VMM-000620\"\n  tag \"gid\": \"V-94491\"\n  tag \"rid\": \"SV-104321r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100001\"\n  tag \"fix_id\": \"F-100607r1_fix\"\n  tag \"cci\": [\"CCI-001682\"]\n  tag \"nist\": [\"AC-2 (2)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For environments that do not use vCenter server to manage ESXi,\nthis is not applicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >> Settings\n>> System >> Security Profile.  Scroll down to \\\"Lockdown Mode\\\" and verify it\nis set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Select Name,@{N=\\\"Lockdown\\\";E={$_.Extensiondata.Config.LockdownMode}}\n\nIf \\\"Lockdown Mode\\\" is disabled, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client, select the ESXi Host and go to\nManage >> Settings >> System >> Security Profile.  Click edit on \\\"Lockdown\nMode\\\" and set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$level = \\\"lockdownNormal\\\" OR \\\"lockdownStrict\\\"\n$vmhost = Get-VMHost -Name <hostname> | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.ChangeLockdownMode($level)\"\n\ncommand = '(Get-VMHost).Extensiondata.Config.LockdownMode'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"lockdownDisabled\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94491.rb",
        "line": 1
      },
      "id": "V-94491"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by using Active Directory\nfor local user authentication.",
      "desc": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.",
      "descriptions": {
        "default": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000112-VMM-000560",
        "gid": "V-94529",
        "rid": "SV-104359r1_rule",
        "stig_id": "ESXI-65-200037",
        "fix_id": "F-100645r1_fix",
        "cci": [
          "CCI-001941"
        ],
        "nist": [
          "IA-2 (8)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \"Directory Services Type\" is set to\n\"Active Directory\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf the \"Directory Services Type\" is not set to \"Active Directory\", this is\na finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \"Properties\" and change the\n\"Directory Service Type\" to \"Active Directory\", enter the domain to join,\ncheck \"Use vSphere Authentication Proxy\" and enter the proxy server address\nthen click \"Join Domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \"domain name\" -User \"username\" -Password \"password\""
      },
      "code": "control \"V-94529\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by using Active Directory\nfor local user authentication.\"\n  desc  \"Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \\\"ESX Admins\\\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000112-VMM-000560\"\n  tag \"gid\": \"V-94529\"\n  tag \"rid\": \"SV-104359r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200037\"\n  tag \"fix_id\": \"F-100645r1_fix\"\n  tag \"cci\": [\"CCI-001941\"]\n  tag \"nist\": [\"IA-2 (8)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \\\"Directory Services Type\\\" is set to\n\\\"Active Directory\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf the \\\"Directory Services Type\\\" is not set to \\\"Active Directory\\\", this is\na finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \\\"Properties\\\" and change the\n\\\"Directory Service Type\\\" to \\\"Active Directory\\\", enter the domain to join,\ncheck \\\"Use vSphere Authentication Proxy\\\" and enter the proxy server address\nthen click \\\"Join Domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \\\"domain name\\\" -User \\\"username\\\" -Password \\\"password\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94529.rb",
        "line": 1
      },
      "id": "V-94529"
    },
    {
      "title": "The ESXi host must enforce the unlock timeout of 15 minutes after a\nuser account is locked out.",
      "desc": "By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account.",
      "descriptions": {
        "default": "By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000329-VMM-001180",
        "gid": "V-93959",
        "rid": "SV-104045r1_rule",
        "stig_id": "ESXI-65-000006",
        "fix_id": "F-100207r1_fix",
        "cci": [
          "CCI-002238"
        ],
        "nist": [
          "AC-7 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSecurity.AccountUnlockTime value and verify it is set to 900.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime and verify it\nis set to 900.\n\nIf the Security.AccountUnlockTime is set to a value other than 900, this is a\nfinding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.AccountUnlockTime value and configure it to 900.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime |\nSet-AdvancedSetting -Value 900"
      },
      "code": "control \"V-93959\" do\n  title \"The ESXi host must enforce the unlock timeout of 15 minutes after a\nuser account is locked out.\"\n  desc  \"By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000329-VMM-001180\"\n  tag \"gid\": \"V-93959\"\n  tag \"rid\": \"SV-104045r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000006\"\n  tag \"fix_id\": \"F-100207r1_fix\"\n  tag \"cci\": [\"CCI-002238\"]\n  tag \"nist\": [\"AC-7 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSecurity.AccountUnlockTime value and verify it is set to 900.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime and verify it\nis set to 900.\n\nIf the Security.AccountUnlockTime is set to a value other than 900, this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.AccountUnlockTime value and configure it to 900.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime |\nSet-AdvancedSetting -Value 900\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"900\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93959.rb",
        "line": 1
      },
      "id": "V-93959"
    },
    {
      "title": "The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by restricting\nuse of Active Directory ESX Admin group membership.",
      "desc": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group.",
      "descriptions": {
        "default": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000109-VMM-000550",
        "gid": "V-94509",
        "rid": "SV-104339r1_rule",
        "stig_id": "ESXI-65-100039",
        "fix_id": "F-100625r1_fix",
        "cci": [
          "CCI-000770"
        ],
        "nist": [
          "IA-2 (5)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and verify it is not\nset to \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value is set to\n\"ESX Admins\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and configure it to\nan Active Directory group other than \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>"
      },
      "code": "control \"V-94509\" do\n  title \"The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by restricting\nuse of Active Directory ESX Admin group membership.\"\n  desc  \"When adding ESXi hosts to Active Directory, if the group \\\"ESX\nAdmins\\\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \\\"ESX Admins\\\" group.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000109-VMM-000550\"\n  tag \"gid\": \"V-94509\"\n  tag \"rid\": \"SV-104339r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100039\"\n  tag \"fix_id\": \"F-100625r1_fix\"\n  tag \"cci\": [\"CCI-000770\"]\n  tag \"nist\": [\"IA-2 (5)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and verify it is not\nset to \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf the \\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value is set to\n\\\"ESX Admins\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and configure it to\nan Active Directory group other than \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94509.rb",
        "line": 1
      },
      "id": "V-94509"
    },
    {
      "title": "The ESXi host must synchronize internal information system clocks to\nthe authoritative time source when the time difference is greater than one\nsecond.",
      "desc": "To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value.",
      "descriptions": {
        "default": "To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000356-VMM-001340",
        "gid": "V-94519",
        "rid": "SV-104349r1_rule",
        "stig_id": "ESXI-65-100046",
        "fix_id": "F-100635r1_fix",
        "cci": [
          "CCI-002046"
        ],
        "nist": [
          "AU-8 (1) (b)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Time Configuration.  Select Properties >> Options and view the\nconfigured NTP servers and service startup policy.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostNTPServer\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"}\n\nIf the NTP service is not configured with authoritative DoD time sources, and\nthe service is not configured to start and stop with the host, this is a\nfinding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Time Configuration.  Select Properties >> Options and\nconfigure the NTP service to start and stop with the host and with\nauthoritative DoD time sources.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$NTPServers = \"ntpserver1\",\"ntpserver2\"\nGet-VMHost | Add-VMHostNTPServer $NTPServers\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} |\nSet-VMHostService -Policy On\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} |\nStart-VMHostService"
      },
      "code": "control \"V-94519\" do\n  title \"The ESXi host must synchronize internal information system clocks to\nthe authoritative time source when the time difference is greater than one\nsecond.\"\n  desc  \"To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000356-VMM-001340\"\n  tag \"gid\": \"V-94519\"\n  tag \"rid\": \"SV-104349r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100046\"\n  tag \"fix_id\": \"F-100635r1_fix\"\n  tag \"cci\": [\"CCI-002046\"]\n  tag \"nist\": [\"AU-8 (1) (b)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Time Configuration.  Select Properties >> Options and view the\nconfigured NTP servers and service startup policy.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostNTPServer\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"}\n\nIf the NTP service is not configured with authoritative DoD time sources, and\nthe service is not configured to start and stop with the host, this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Time Configuration.  Select Properties >> Options and\nconfigure the NTP service to start and stop with the host and with\nauthoritative DoD time sources.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$NTPServers = \\\"ntpserver1\\\",\\\"ntpserver2\\\"\nGet-VMHost | Add-VMHostNTPServer $NTPServers\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"} |\nSet-VMHostService -Policy On\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"} |\nStart-VMHostService\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94519.rb",
        "line": 1
      },
      "id": "V-94519"
    },
    {
      "title": "The ESXi host must protect the confidentiality and integrity of\ntransmitted information by protecting ESXi management traffic.",
      "desc": "The vSphere management network provides access to the vSphere\nmanagement interface on each component. Services running on the management\ninterface provide an opportunity for an attacker to gain privileged access to\nthe systems. Any remote attack most likely would begin with gaining entry to\nthis network.",
      "descriptions": {
        "default": "The vSphere management network provides access to the vSphere\nmanagement interface on each component. Services running on the management\ninterface provide an opportunity for an attacker to gain privileged access to\nthe systems. Any remote attack most likely would begin with gaining entry to\nthis network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000423-VMM-001700",
        "gid": "V-94045",
        "rid": "SV-104131r1_rule",
        "stig_id": "ESXI-65-000049",
        "fix_id": "F-100293r1_fix",
        "cci": [
          "CCI-002418"
        ],
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "The Management VMkernel port group should in a dedicated VLAN\nthat can be on a common standard or distributed virtual switch as long as the\nManagement VLAN is not shared by any other function and it not accessible to\nanything other than management related functions such as vCenter.  The check\nfor this will be unique per environment.\n\nFrom the vSphere Web Client select the ESXi host and go to Configure >>\nNetworking and review the VLAN associated with the Management VMkernel and\nverify they are dedicated for that purpose and are logically separated from\nother functions.\n\nIf the network segment is accessible, except to networks where other\nmanagement-related entities are located such as vCenter, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi host and go to\nConfigure >> Networking >> VMkernel adapters. Select the Management VMkernel\nand click Edit settings >> On the Port properties tab uncheck everything but\n\"Management.” On the IP Settings tab >> Enter the appropriate IP address and\nsubnet information and click OK. Set the appropriate VLAN ID >> Configure >>\nNetworking >> Virtual switches. Select the Management portgroup and click Edit\nsettings >> On the properties tab, enter the appropriate VLAN ID and click OK."
      },
      "code": "control \"V-94045\" do\n  title \"The ESXi host must protect the confidentiality and integrity of\ntransmitted information by protecting ESXi management traffic.\"\n  desc  \"The vSphere management network provides access to the vSphere\nmanagement interface on each component. Services running on the management\ninterface provide an opportunity for an attacker to gain privileged access to\nthe systems. Any remote attack most likely would begin with gaining entry to\nthis network.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000423-VMM-001700\"\n  tag \"gid\": \"V-94045\"\n  tag \"rid\": \"SV-104131r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000049\"\n  tag \"fix_id\": \"F-100293r1_fix\"\n  tag \"cci\": [\"CCI-002418\"]\n  tag \"nist\": [\"SC-8\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"The Management VMkernel port group should in a dedicated VLAN\nthat can be on a common standard or distributed virtual switch as long as the\nManagement VLAN is not shared by any other function and it not accessible to\nanything other than management related functions such as vCenter.  The check\nfor this will be unique per environment.\n\nFrom the vSphere Web Client select the ESXi host and go to Configure >>\nNetworking and review the VLAN associated with the Management VMkernel and\nverify they are dedicated for that purpose and are logically separated from\nother functions.\n\nIf the network segment is accessible, except to networks where other\nmanagement-related entities are located such as vCenter, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi host and go to\nConfigure >> Networking >> VMkernel adapters. Select the Management VMkernel\nand click Edit settings >> On the Port properties tab uncheck everything but\n\\\"Management.” On the IP Settings tab >> Enter the appropriate IP address and\nsubnet information and click OK. Set the appropriate VLAN ID >> Configure >>\nNetworking >> Virtual switches. Select the Management portgroup and click Edit\nsettings >> On the properties tab, enter the appropriate VLAN ID and click OK.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94045.rb",
        "line": 1
      },
      "id": "V-94045"
    },
    {
      "title": "The ESXi host SSH daemon must be configured to use only the SSHv2\nprotocol.",
      "desc": "SSH protocol version 1 suffers from design flaws that result in\nsecurity vulnerabilities and should not be used. Only SSH protocol version 2\nconnections should be permitted.",
      "descriptions": {
        "default": "SSH protocol version 1 suffers from design flaws that result in\nsecurity vulnerabilities and should not be used. Only SSH protocol version 2\nconnections should be permitted."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000033-VMM-000140",
        "gid": "V-93969",
        "rid": "SV-104055r1_rule",
        "stig_id": "ESXI-65-000011",
        "fix_id": "F-100217r1_fix",
        "cci": [
          "CCI-000068"
        ],
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^Protocol\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Protocol 2\", this is a\nfinding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\":\n\nProtocol 2"
      },
      "code": "control \"V-93969\" do\n  title \"The ESXi host SSH daemon must be configured to use only the SSHv2\nprotocol.\"\n  desc  \"SSH protocol version 1 suffers from design flaws that result in\nsecurity vulnerabilities and should not be used. Only SSH protocol version 2\nconnections should be permitted.\"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000033-VMM-000140\"\n  tag \"gid\": \"V-93969\"\n  tag \"rid\": \"SV-104055r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000011\"\n  tag \"fix_id\": \"F-100217r1_fix\"\n  tag \"cci\": [\"CCI-000068\"]\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^Protocol\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"Protocol 2\\\", this is a\nfinding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nAdd or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nProtocol 2\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93969.rb",
        "line": 1
      },
      "id": "V-93969"
    },
    {
      "title": "The ESXi host must implement cryptographic mechanisms to prevent\nunauthorized modification of all information at rest on all VMM components by\nverifying Image Profile and VIP Acceptance Levels.",
      "desc": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
      "descriptions": {
        "default": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000404-VMM-001650",
        "gid": "V-94537",
        "rid": "SV-104367r1_rule",
        "stig_id": "ESXI-65-200047",
        "fix_id": "F-100653r1_fix",
        "cci": [
          "CCI-002475"
        ],
        "nist": [
          "SC-28 (1)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Host Image Profile Acceptance\nLevel\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is \"CommunitySupported\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Host Image Profile Acceptance\nLevel\" edit the acceptance level to be either \"VMwareCertified\",\n\"VMwareAccepted\", or \"PartnerSupported\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\"PartnerSupported\")\n\nNote: \"VMwareCertified\" or \"VMwareAccepted\" may be substituted for\n\"PartnerSupported\", depending upon local requirements."
      },
      "code": "control \"V-94537\" do\n  title \"The ESXi host must implement cryptographic mechanisms to prevent\nunauthorized modification of all information at rest on all VMM components by\nverifying Image Profile and VIP Acceptance Levels.\"\n  desc  \"Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.\n  \"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000404-VMM-001650\"\n  tag \"gid\": \"V-94537\"\n  tag \"rid\": \"SV-104367r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200047\"\n  tag \"fix_id\": \"F-100653r1_fix\"\n  tag \"cci\": [\"CCI-002475\"]\n  tag \"nist\": [\"SC-28 (1)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Host Image Profile Acceptance\nLevel\\\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is \\\"CommunitySupported\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Host Image Profile Acceptance\nLevel\\\" edit the acceptance level to be either \\\"VMwareCertified\\\",\n\\\"VMwareAccepted\\\", or \\\"PartnerSupported\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\\\"PartnerSupported\\\")\n\nNote: \\\"VMwareCertified\\\" or \\\"VMwareAccepted\\\" may be substituted for\n\\\"PartnerSupported\\\", depending upon local requirements.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94537.rb",
        "line": 1
      },
      "id": "V-94537"
    },
    {
      "title": "The ESXi host must accept Personal Identity Verification (PIV)\ncredentials.",
      "desc": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000376-VMM-001520",
        "gid": "V-94511",
        "rid": "SV-104341r1_rule",
        "stig_id": "ESXI-65-100040",
        "fix_id": "F-100627r1_fix",
        "cci": [
          "CCI-001953"
        ],
        "nist": [
          "IA-2 (12)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that have no local user accounts, other than\n\"root\" and/or \"vpxuser\", this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the \"Enable Smart Card Authentication\"\nstatus.\n\nIf \"Enable Smart Card Authentication\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is a finding.",
        "fix": "The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi Host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \"Enable Smart Card\nAuthentication\" and click \"OK\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website."
      },
      "code": "control \"V-94511\" do\n  title \"The ESXi host must accept Personal Identity Verification (PIV)\ncredentials.\"\n  desc  \"To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000376-VMM-001520\"\n  tag \"gid\": \"V-94511\"\n  tag \"rid\": \"SV-104341r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100040\"\n  tag \"fix_id\": \"F-100627r1_fix\"\n  tag \"cci\": [\"CCI-001953\"]\n  tag \"nist\": [\"IA-2 (12)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that have no local user accounts, other than\n\\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the \\\"Enable Smart Card Authentication\\\"\nstatus.\n\nIf \\\"Enable Smart Card Authentication\\\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\"\n  tag \"fix\": \"The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi Host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \\\"Enable Smart Card\nAuthentication\\\" and click \\\"OK\\\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94511.rb",
        "line": 1
      },
      "id": "V-94511"
    },
    {
      "title": "The ESXi host must disable ESXi Shell unless needed for diagnostics or\ntroubleshooting.",
      "desc": "The ESXi Shell is an interactive command line environment available\nlocally from the DCUI or remotely via SSH. Activities performed from the ESXi\nShell bypass vCenter RBAC and audit controls. The ESXi shell should only be\nturned on when needed to troubleshoot/resolve problems that cannot be fixed\nthrough the vSphere client.",
      "descriptions": {
        "default": "The ESXi Shell is an interactive command line environment available\nlocally from the DCUI or remotely via SSH. Activities performed from the ESXi\nShell bypass vCenter RBAC and audit controls. The ESXi shell should only be\nturned on when needed to troubleshoot/resolve problems that cannot be fixed\nthrough the vSphere client."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000095-VMM-000480",
        "gid": "V-94019",
        "rid": "SV-104105r1_rule",
        "stig_id": "ESXI-65-000036",
        "fix_id": "F-100267r1_fix",
        "cci": [
          "CCI-000381"
        ],
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under Services select Edit and view\nthe \"ESXi Shell\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"}\n\nIf the ESXi Shell service is running, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit then select\nthe ESXi Shell service and click the Stop button to stop the service. Use the\npull-down menu to change the Startup policy to \"Start and stop manually\" and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"} |\nStop-VMHostService"
      },
      "code": "control \"V-94019\" do\n  title \"The ESXi host must disable ESXi Shell unless needed for diagnostics or\ntroubleshooting.\"\n  desc  \"The ESXi Shell is an interactive command line environment available\nlocally from the DCUI or remotely via SSH. Activities performed from the ESXi\nShell bypass vCenter RBAC and audit controls. The ESXi shell should only be\nturned on when needed to troubleshoot/resolve problems that cannot be fixed\nthrough the vSphere client.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000095-VMM-000480\"\n  tag \"gid\": \"V-94019\"\n  tag \"rid\": \"SV-104105r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000036\"\n  tag \"fix_id\": \"F-100267r1_fix\"\n  tag \"cci\": [\"CCI-000381\"]\n  tag \"nist\": [\"CM-7 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under Services select Edit and view\nthe \\\"ESXi Shell\\\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"ESXi Shell\\\"}\n\nIf the ESXi Shell service is running, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under Services select Edit then select\nthe ESXi Shell service and click the Stop button to stop the service. Use the\npull-down menu to change the Startup policy to \\\"Start and stop manually\\\" and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"ESXi Shell\\\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"ESXi Shell\\\"} |\nStop-VMHostService\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94019.rb",
        "line": 1
      },
      "id": "V-94019"
    },
    {
      "title": "The ESXi host must disable SSH.",
      "desc": "The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.",
      "descriptions": {
        "default": "The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000297-VMM-001040",
        "gid": "V-94503",
        "rid": "SV-104333r1_rule",
        "stig_id": "ESXI-65-100035",
        "fix_id": "F-100619r1_fix",
        "cci": [
          "CCI-002314"
        ],
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Services\" select \"Edit\" and view\nthe \"SSH\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"}\n\nIf the ESXi SSH service is running, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Services\" select \"Edit\" then\nselect the SSH service and click options.  Change the service to \"Start and\nstop manually\" and stop the service and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nStop-VMHostService"
      },
      "code": "control \"V-94503\" do\n  title \"The ESXi host must disable SSH.\"\n  desc  \"The ESXi Shell is an interactive command line interface (CLI)\navailable at the ESXi server console. The ESXi shell provides temporary access\nto commands essential for server maintenance. Intended primarily for use in\nbreak-fix scenarios, the ESXi shell is well suited for checking and modifying\nconfiguration details, not always generally accessible, using the vSphere\nClient. The ESXi shell is accessible remotely using SSH by users with the\nAdministrator role. Under normal operating conditions, SSH access to the host\nmust be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000297-VMM-001040\"\n  tag \"gid\": \"V-94503\"\n  tag \"rid\": \"SV-104333r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100035\"\n  tag \"fix_id\": \"F-100619r1_fix\"\n  tag \"cci\": [\"CCI-002314\"]\n  tag \"nist\": [\"AC-17 (1)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Services\\\" select \\\"Edit\\\" and view\nthe \\\"SSH\\\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"}\n\nIf the ESXi SSH service is running, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Services\\\" select \\\"Edit\\\" then\nselect the SSH service and click options.  Change the service to \\\"Start and\nstop manually\\\" and stop the service and click \\\"OK\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nStop-VMHostService\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94503.rb",
        "line": 1
      },
      "id": "V-94503"
    },
    {
      "title": "The ESXi hostSSH daemon must set a timeout interval on idle sessions.",
      "desc": "Causing idle users to be automatically logged out guards against\ncompromises one system leading trivially to compromises on another.",
      "descriptions": {
        "default": "Causing idle users to be automatically logged out guards against\ncompromises one system leading trivially to compromises on another."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94001",
        "rid": "SV-104087r1_rule",
        "stig_id": "ESXI-65-000027",
        "fix_id": "F-100249r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^ClientAliveInterval\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"ClientAliveInterval 200\",\nthis is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nClientAliveInterval 200"
      },
      "code": "control \"V-94001\" do\n  title \"The ESXi hostSSH daemon must set a timeout interval on idle sessions.\"\n  desc  \"Causing idle users to be automatically logged out guards against\ncompromises one system leading trivially to compromises on another.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94001\"\n  tag \"rid\": \"SV-104087r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000027\"\n  tag \"fix_id\": \"F-100249r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^ClientAliveInterval\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"ClientAliveInterval 200\\\",\nthis is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nClientAliveInterval 200\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94001.rb",
        "line": 1
      },
      "id": "V-94001"
    },
    {
      "title": "The ESXi host SSH daemon must not permit user environment settings.",
      "desc": "SSH environment options potentially allow users to bypass access\nrestriction in some configurations. Users must not be able to present\nenvironment options to the SSH daemon.",
      "descriptions": {
        "default": "SSH environment options potentially allow users to bypass access\nrestriction in some configurations. Users must not be able to present\nenvironment options to the SSH daemon."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93979",
        "rid": "SV-104065r1_rule",
        "stig_id": "ESXI-65-000016",
        "fix_id": "F-100227r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^PermitUserEnvironment\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitUserEnvironment\nno\", this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitUserEnvironment no"
      },
      "code": "control \"V-93979\" do\n  title \"The ESXi host SSH daemon must not permit user environment settings.\"\n  desc  \"SSH environment options potentially allow users to bypass access\nrestriction in some configurations. Users must not be able to present\nenvironment options to the SSH daemon.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93979\"\n  tag \"rid\": \"SV-104065r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000016\"\n  tag \"fix_id\": \"F-100227r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^PermitUserEnvironment\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"PermitUserEnvironment\nno\\\", this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nPermitUserEnvironment no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93979.rb",
        "line": 1
      },
      "id": "V-93979"
    },
    {
      "title": "The ESXi host must logout of the console UI after 10 minutes.",
      "desc": "When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged in to avoid unauthorized\nprivilege gains.  The DcuiTimeOut defines a window of time after which the DCUI\nwill be logged out.",
      "descriptions": {
        "default": "When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged in to avoid unauthorized\nprivilege gains.  The DcuiTimeOut defines a window of time after which the DCUI\nwill be logged out."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000163-VMM-000700",
        "gid": "V-94033",
        "rid": "SV-104119r1_rule",
        "stig_id": "ESXI-65-000043",
        "fix_id": "F-100281r1_fix",
        "cci": [
          "CCI-001133"
        ],
        "nist": [
          "SC-10",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.DcuiTimeOut value and verify it is set to 600 (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut\n\nIf the UserVars.DcuiTimeOut setting is not set to 600, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.DcuiTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94033\" do\n  title \"The ESXi host must logout of the console UI after 10 minutes.\"\n  desc  \"When the Direct console user interface (DCUI) is enabled and logged in\nit should be automatically logged out if left logged in to avoid unauthorized\nprivilege gains.  The DcuiTimeOut defines a window of time after which the DCUI\nwill be logged out.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000163-VMM-000700\"\n  tag \"gid\": \"V-94033\"\n  tag \"rid\": \"SV-104119r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000043\"\n  tag \"fix_id\": \"F-100281r1_fix\"\n  tag \"cci\": [\"CCI-001133\"]\n  tag \"nist\": [\"SC-10\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.DcuiTimeOut value and verify it is set to 600 (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut\n\nIf the UserVars.DcuiTimeOut setting is not set to 600, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.DcuiTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut |\nSet-AdvancedSetting -Value 600\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"600\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94033.rb",
        "line": 1
      },
      "id": "V-94033"
    },
    {
      "title": "The ESXi host must protect the confidentiality and integrity of\ntransmitted information by utilizing different TCP/IP stacks where possible.",
      "desc": "There are three different TCP/IP stacks by default available on ESXi\nnow which are Default, Provisioning, and vMotion.  To better protect and\nisolate sensitive network traffic within ESXi admins must configure each of\nthese stacks.  Additional custom TCP/IP stacks can be created if desired.",
      "descriptions": {
        "default": "There are three different TCP/IP stacks by default available on ESXi\nnow which are Default, Provisioning, and vMotion.  To better protect and\nisolate sensitive network traffic within ESXi admins must configure each of\nthese stacks.  Additional custom TCP/IP stacks can be created if desired."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000423-VMM-001700",
        "gid": "V-94051",
        "rid": "SV-104137r1_rule",
        "stig_id": "ESXI-65-000052",
        "fix_id": "F-100299r1_fix",
        "cci": [
          "CCI-002418"
        ],
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> TCP/IP configuration. Review the default system\nTCP/IP stacks and verify they are configured with the appropriate IP address\ninformation.\n\nIf vMotion and Provisioning VMKernels are in use and are not utilizing their\nown TCP/IP stack, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> TCP/IP configuration >> Select a TCP/IP stack >>\nClick Edit >> Enter the appropriate site specific IP address information for\nthe particular TCP/IP stack and click OK."
      },
      "code": "control \"V-94051\" do\n  title \"The ESXi host must protect the confidentiality and integrity of\ntransmitted information by utilizing different TCP/IP stacks where possible.\"\n  desc  \"There are three different TCP/IP stacks by default available on ESXi\nnow which are Default, Provisioning, and vMotion.  To better protect and\nisolate sensitive network traffic within ESXi admins must configure each of\nthese stacks.  Additional custom TCP/IP stacks can be created if desired.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000423-VMM-001700\"\n  tag \"gid\": \"V-94051\"\n  tag \"rid\": \"SV-104137r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000052\"\n  tag \"fix_id\": \"F-100299r1_fix\"\n  tag \"cci\": [\"CCI-002418\"]\n  tag \"nist\": [\"SC-8\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> TCP/IP configuration. Review the default system\nTCP/IP stacks and verify they are configured with the appropriate IP address\ninformation.\n\nIf vMotion and Provisioning VMKernels are in use and are not utilizing their\nown TCP/IP stack, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> TCP/IP configuration >> Select a TCP/IP stack >>\nClick Edit >> Enter the appropriate site specific IP address information for\nthe particular TCP/IP stack and click OK.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94051.rb",
        "line": 1
      },
      "id": "V-94051"
    },
    {
      "title": "The ESXi host must exclusively enable TLS 1.2 for the authd service.",
      "desc": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces\nand TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third\nparty integrations and add-ons to vSphere. Test these integrations carefully\nafter implementing TLS 1.2 and roll back where appropriate. On interfaces where\nrequired functionality is broken with TLS 1.2 this finding is N/A until such\ntime as the third party software supports TLS 1.2.",
      "descriptions": {
        "default": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces\nand TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third\nparty integrations and add-ons to vSphere. Test these integrations carefully\nafter implementing TLS 1.2 and roll back where appropriate. On interfaces where\nrequired functionality is broken with TLS 1.2 this finding is N/A until such\ntime as the third party software supports TLS 1.2."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94485",
        "rid": "SV-104315r1_rule",
        "stig_id": "ESXI-65-000075",
        "fix_id": "F-100601r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "\"From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.VMAuthdDisabledProtocols value and verify that it is set to the\nfollowing:\n\ntlsv1,tlsv1.1,sslv3\n\nIf the value is not set as above or it does not exist, this is a finding.\n\nor\n\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.VMAuthdDisabledProtocols\n\n\nIf the value returned is not \"tlsv1,tlsv1.1,sslv3\" or the setting does not\nexist, this is a finding.",
        "fix": "From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.VMAuthdDisabledProtocols value and set to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.VMAuthdDisabledProtocols |\nSet-AdvancedSetting -Value \"tlsv1,tlsv1.1,sslv3\n\nA host reboot is required for changes to take effect."
      },
      "code": "control \"V-94485\" do\n  title \"The ESXi host must exclusively enable TLS 1.2 for the authd service.\"\n  desc  \"TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces\nand TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third\nparty integrations and add-ons to vSphere. Test these integrations carefully\nafter implementing TLS 1.2 and roll back where appropriate. On interfaces where\nrequired functionality is broken with TLS 1.2 this finding is N/A until such\ntime as the third party software supports TLS 1.2.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94485\"\n  tag \"rid\": \"SV-104315r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000075\"\n  tag \"fix_id\": \"F-100601r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"\\\"From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.VMAuthdDisabledProtocols value and verify that it is set to the\nfollowing:\n\ntlsv1,tlsv1.1,sslv3\n\nIf the value is not set as above or it does not exist, this is a finding.\n\nor\n\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.VMAuthdDisabledProtocols\n\n\nIf the value returned is not \\\"tlsv1,tlsv1.1,sslv3\\\" or the setting does not\nexist, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.VMAuthdDisabledProtocols value and set to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.VMAuthdDisabledProtocols |\nSet-AdvancedSetting -Value \\\"tlsv1,tlsv1.1,sslv3\n\nA host reboot is required for changes to take effect.\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name UserVars.VMAuthdDisabledProtocols).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match \"tlsv1,tlsv1.1,sslv3\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94485.rb",
        "line": 1
      },
      "id": "V-94485"
    },
    {
      "title": "Active Directory ESX Admin group membership must not be used when\nadding ESXi hosts to Active Directory.",
      "desc": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group.",
      "descriptions": {
        "default": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000104-VMM-000500",
        "gid": "V-94025",
        "rid": "SV-104111r1_rule",
        "stig_id": "ESXI-65-000039",
        "fix_id": "F-100273r1_fix",
        "cci": [
          "CCI-000764"
        ],
        "nist": [
          "IA-2",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfiguration >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup value and verify it is not set\nto \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and have no local user accounts,\nother than root and/or vpxuser, this is not applicable.\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than root and/or vpxuser, this is a finding.\n\nIf the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" keyword is set to\n\"ESX Admins\", this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfiguration >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup value and configure it to an\nActive Directory group other than \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>"
      },
      "code": "control \"V-94025\" do\n  title \"Active Directory ESX Admin group membership must not be used when\nadding ESXi hosts to Active Directory.\"\n  desc  \"When adding ESXi hosts to Active Directory, if the group \\\"ESX\nAdmins\\\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \\\"ESX Admins\\\" group.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000104-VMM-000500\"\n  tag \"gid\": \"V-94025\"\n  tag \"rid\": \"SV-104111r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000039\"\n  tag \"fix_id\": \"F-100273r1_fix\"\n  tag \"cci\": [\"CCI-000764\"]\n  tag \"nist\": [\"IA-2\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfiguration >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup value and verify it is not set\nto \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and have no local user accounts,\nother than root and/or vpxuser, this is not applicable.\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than root and/or vpxuser, this is a finding.\n\nIf the \\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" keyword is set to\n\\\"ESX Admins\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfiguration >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup value and configure it to an\nActive Directory group other than \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94025.rb",
        "line": 1
      },
      "id": "V-94025"
    },
    {
      "title": "The ESXi host must enable BPDU filter on the host to prevent being\nlocked out of physical switch ports with Portfast and BPDU Guard enabled.",
      "desc": "BPDU Guard and Portfast are commonly enabled on the physical switch to\nwhich the ESXi host is directly connected to reduce the STP convergence delay.\nIf a BPDU packet is sent from a virtual machine on the ESXi host to the\nphysical switch so configured, a cascading lockout of all the uplink interfaces\nfrom the ESXi host can occur. To prevent this type of lockout, BPDU Filter can\nbe enabled on the ESXi host to drop any BPDU packets being sent to the physical\nswitch. The caveat is that certain SSL VPN which use Windows bridging\ncapability can legitimately generate BPDU packets. The administrator should\nverify that there are no legitimate BPDU packets generated by virtual machines\non the ESXi host prior to enabling BPDU Filter.  If BPDU Filter is enabled in\nthis situation, enabling Reject Forged Transmits on the virtual switch port\ngroup adds protection against Spanning Tree loops.",
      "descriptions": {
        "default": "BPDU Guard and Portfast are commonly enabled on the physical switch to\nwhich the ESXi host is directly connected to reduce the STP convergence delay.\nIf a BPDU packet is sent from a virtual machine on the ESXi host to the\nphysical switch so configured, a cascading lockout of all the uplink interfaces\nfrom the ESXi host can occur. To prevent this type of lockout, BPDU Filter can\nbe enabled on the ESXi host to drop any BPDU packets being sent to the physical\nswitch. The caveat is that certain SSL VPN which use Windows bridging\ncapability can legitimately generate BPDU packets. The administrator should\nverify that there are no legitimate BPDU packets generated by virtual machines\non the ESXi host prior to enabling BPDU Filter.  If BPDU Filter is enabled in\nthis situation, enabling Reject Forged Transmits on the virtual switch port\ngroup adds protection against Spanning Tree loops."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94063",
        "rid": "SV-104149r1_rule",
        "stig_id": "ESXI-65-000058",
        "fix_id": "F-100311r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the Net.BlockGuestBPDU\nvalue and verify it is set to 1.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU\n\nIf the Net.BlockGuestBPDU setting is not set to 1, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nNet.BlockGuestBPDU value and configure it to 1.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU | Set-AdvancedSetting\n-Value 1"
      },
      "code": "control \"V-94063\" do\n  title \"The ESXi host must enable BPDU filter on the host to prevent being\nlocked out of physical switch ports with Portfast and BPDU Guard enabled.\"\n  desc  \"BPDU Guard and Portfast are commonly enabled on the physical switch to\nwhich the ESXi host is directly connected to reduce the STP convergence delay.\nIf a BPDU packet is sent from a virtual machine on the ESXi host to the\nphysical switch so configured, a cascading lockout of all the uplink interfaces\nfrom the ESXi host can occur. To prevent this type of lockout, BPDU Filter can\nbe enabled on the ESXi host to drop any BPDU packets being sent to the physical\nswitch. The caveat is that certain SSL VPN which use Windows bridging\ncapability can legitimately generate BPDU packets. The administrator should\nverify that there are no legitimate BPDU packets generated by virtual machines\non the ESXi host prior to enabling BPDU Filter.  If BPDU Filter is enabled in\nthis situation, enabling Reject Forged Transmits on the virtual switch port\ngroup adds protection against Spanning Tree loops.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94063\"\n  tag \"rid\": \"SV-104149r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000058\"\n  tag \"fix_id\": \"F-100311r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the Net.BlockGuestBPDU\nvalue and verify it is set to 1.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU\n\nIf the Net.BlockGuestBPDU setting is not set to 1, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nNet.BlockGuestBPDU value and configure it to 1.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU | Set-AdvancedSetting\n-Value 1\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match \"1\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94063.rb",
        "line": 1
      },
      "id": "V-94063"
    },
    {
      "title": "The ESXi host SSH daemon must use DoD-approved encryption to protect\nthe confidentiality of remote access sessions.",
      "desc": "Approved algorithms should impart some level of confidence in their\nimplementation. Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\n    Note: This does not imply FIPS 140-2 validation.",
      "descriptions": {
        "default": "Approved algorithms should impart some level of confidence in their\nimplementation. Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\n    Note: This does not imply FIPS 140-2 validation."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000033-VMM-000140",
        "gid": "V-93967",
        "rid": "SV-104053r1_rule",
        "stig_id": "ESXI-65-000010",
        "fix_id": "F-100215r1_fix",
        "cci": [
          "CCI-000068"
        ],
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Only FIPS-approved ciphers should be used. To verify that only\nFIPS-approved ciphers are in use, run the following command from an SSH session\nconnected to the ESXi host, or from the ESXi shell:\n\n# grep -i \"^Ciphers\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Ciphers\naes128-ctr,aes192-ctr,aes256-ctr\", this is a finding.",
        "fix": "Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\nFrom an SSH session connected to the ESXi host, or from the ESXi shell, add or\ncorrect the following line in \"/etc/ssh/sshd_config\":\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr"
      },
      "code": "control \"V-93967\" do\n  title \"The ESXi host SSH daemon must use DoD-approved encryption to protect\nthe confidentiality of remote access sessions.\"\n  desc  \"Approved algorithms should impart some level of confidence in their\nimplementation. Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\n    Note: This does not imply FIPS 140-2 validation.\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000033-VMM-000140\"\n  tag \"gid\": \"V-93967\"\n  tag \"rid\": \"SV-104053r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000010\"\n  tag \"fix_id\": \"F-100215r1_fix\"\n  tag \"cci\": [\"CCI-000068\"]\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Only FIPS-approved ciphers should be used. To verify that only\nFIPS-approved ciphers are in use, run the following command from an SSH session\nconnected to the ESXi host, or from the ESXi shell:\n\n# grep -i \\\"^Ciphers\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"Ciphers\naes128-ctr,aes192-ctr,aes256-ctr\\\", this is a finding.\"\n  tag \"fix\": \"Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\nFrom an SSH session connected to the ESXi host, or from the ESXi shell, add or\ncorrect the following line in \\\"/etc/ssh/sshd_config\\\":\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93967.rb",
        "line": 1
      },
      "id": "V-93967"
    },
    {
      "title": "The ESXi host must, at a minimum, off-load interconnected systems in\nreal time and off-load standalone systems weekly by configuring remote logging.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000479-VMM-001990",
        "gid": "V-94555",
        "rid": "SV-104385r1_rule",
        "stig_id": "ESXI-65-500004",
        "fix_id": "F-100671r1_fix",
        "cci": [
          "CCI-001851"
        ],
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" value is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<insert syslog server hostname>\""
      },
      "code": "control \"V-94555\" do\n  title \"The ESXi host must, at a minimum, off-load interconnected systems in\nreal time and off-load standalone systems weekly by configuring remote logging.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000479-VMM-001990\"\n  tag \"gid\": \"V-94555\"\n  tag \"rid\": \"SV-104385r1_rule\"\n  tag \"stig_id\": \"ESXI-65-500004\"\n  tag \"fix_id\": \"F-100671r1_fix\"\n  tag \"cci\": [\"CCI-001851\"]\n  tag \"nist\": [\"AU-4 (1)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \\\"Syslog.global.logHost\\\" value is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<insert syslog server hostname>\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94555.rb",
        "line": 1
      },
      "id": "V-94555"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by using the vSphere\nAuthentication Proxy.",
      "desc": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.",
      "descriptions": {
        "default": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000112-VMM-000560",
        "gid": "V-94531",
        "rid": "SV-104361r1_rule",
        "stig_id": "ESXI-65-200038",
        "fix_id": "F-100647r1_fix",
        "cci": [
          "CCI-001941"
        ],
        "nist": [
          "IA-2 (8)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomainMethod.  Verify the method used to join\nhosts to a domain is set to \"Use vSphere Authentication Proxy to add the host\nto domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, `\n@{N=\"JoinADEnabled\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\"JoinDomainMethod\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\"JoinDomainMethodPolicy\"}).Policyoption.Id}}\n\nVerify if \"JoinADEnabled\" is \"True\" then \"JoinDomainMethod\" should be\n\"FixedCAMConfigOption\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.",
        "fix": "When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Set the method used to\njoin hosts to a domain to \"Use vSphere Authentication Proxy to add the host to\ndomain\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Click \"Properties\" and change the \"Directory\nService Type\" to \"Active Directory\", enter the domain to join, check \"Use\nvSphere Authentication Proxy\" and enter the proxy server address then click\n\"Join Domain\"."
      },
      "code": "control \"V-94531\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by using the vSphere\nAuthentication Proxy.\"\n  desc  \"If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000112-VMM-000560\"\n  tag \"gid\": \"V-94531\"\n  tag \"rid\": \"SV-104361r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200038\"\n  tag \"fix_id\": \"F-100647r1_fix\"\n  tag \"cci\": [\"CCI-001941\"]\n  tag \"nist\": [\"IA-2 (8)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomainMethod.  Verify the method used to join\nhosts to a domain is set to \\\"Use vSphere Authentication Proxy to add the host\nto domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\\\"HostProfile\\\";E={$_ | Get-VMHostProfile}}, `\n@{N=\\\"JoinADEnabled\\\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\\\"JoinDomainMethod\\\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\\\"JoinDomainMethodPolicy\\\"}).Policyoption.Id}}\n\nVerify if \\\"JoinADEnabled\\\" is \\\"True\\\" then \\\"JoinDomainMethod\\\" should be\n\\\"FixedCAMConfigOption\\\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.\"\n  tag \"fix\": \"When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Set the method used to\njoin hosts to a domain to \\\"Use vSphere Authentication Proxy to add the host to\ndomain\\\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Click \\\"Properties\\\" and change the \\\"Directory\nService Type\\\" to \\\"Active Directory\\\", enter the domain to join, check \\\"Use\nvSphere Authentication Proxy\\\" and enter the proxy server address then click\n\\\"Join Domain\\\".\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94531.rb",
        "line": 1
      },
      "id": "V-94531"
    },
    {
      "title": "The ESXi host must terminate shell services after 10 minutes.",
      "desc": "When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\nESXiShellTimeOut.  The ESXiShellTimeOut defines a window of time after which\nthe ESXi Shell and SSH services will automatically be terminated.",
      "descriptions": {
        "default": "When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\nESXiShellTimeOut.  The ESXiShellTimeOut defines a window of time after which\nthe ESXi Shell and SSH services will automatically be terminated."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000163-VMM-000700",
        "gid": "V-94031",
        "rid": "SV-104117r1_rule",
        "stig_id": "ESXI-65-000042",
        "fix_id": "F-100279r1_fix",
        "cci": [
          "CCI-001133"
        ],
        "nist": [
          "SC-10",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.ESXiShellTimeOut value and verify it is set to 600 (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut\n\nIf the UserVars.ESXiShellTimeOut setting is not set to 600, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.ESXiShellTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94031\" do\n  title \"The ESXi host must terminate shell services after 10 minutes.\"\n  desc  \"When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\nESXiShellTimeOut.  The ESXiShellTimeOut defines a window of time after which\nthe ESXi Shell and SSH services will automatically be terminated.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000163-VMM-000700\"\n  tag \"gid\": \"V-94031\"\n  tag \"rid\": \"SV-104117r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000042\"\n  tag \"fix_id\": \"F-100279r1_fix\"\n  tag \"cci\": [\"CCI-001133\"]\n  tag \"nist\": [\"SC-10\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nUserVars.ESXiShellTimeOut value and verify it is set to 600 (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut\n\nIf the UserVars.ESXiShellTimeOut setting is not set to 600, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nUserVars.ESXiShellTimeOut value and configure it to 600.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut |\nSet-AdvancedSetting -Value 600\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"600\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94031.rb",
        "line": 1
      },
      "id": "V-94031"
    },
    {
      "title": "The ESXi host SSH daemon must not permit root logins.",
      "desc": "Permitting direct root login reduces auditable information about who\nran privileged commands on the system and also allows direct attack attempts on\nroot's password.",
      "descriptions": {
        "default": "Permitting direct root login reduces auditable information about who\nran privileged commands on the system and also allows direct attack attempts on\nroot's password."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93975",
        "rid": "SV-104061r1_rule",
        "stig_id": "ESXI-65-000014",
        "fix_id": "F-100223r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^PermitRootLogin\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitRootLogin no\", this\nis a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitRootLogin no"
      },
      "code": "control \"V-93975\" do\n  title \"The ESXi host SSH daemon must not permit root logins.\"\n  desc  \"Permitting direct root login reduces auditable information about who\nran privileged commands on the system and also allows direct attack attempts on\nroot's password.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93975\"\n  tag \"rid\": \"SV-104061r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000014\"\n  tag \"fix_id\": \"F-100223r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^PermitRootLogin\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"PermitRootLogin no\\\", this\nis a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nAdd or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nPermitRootLogin no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93975.rb",
        "line": 1
      },
      "id": "V-93975"
    },
    {
      "title": "The ESXi host must verify the DCUI.Access list.",
      "desc": "Lockdown mode disables direct host access requiring that admins manage\nhosts from vCenter Server.  However, if a host becomes isolated from vCenter\nServer, the admin is locked out and can no longer manage the host. If you are\nusing normal lockdown mode, you can avoid becoming locked out of an ESXi host\nthat is running in lockdown mode, by setting DCUI.Access to a list of highly\ntrusted users who can override lockdown mode and access the DCUI. The DCUI is\nnot running in strict lockdown mode.",
      "descriptions": {
        "default": "Lockdown mode disables direct host access requiring that admins manage\nhosts from vCenter Server.  However, if a host becomes isolated from vCenter\nServer, the admin is locked out and can no longer manage the host. If you are\nusing normal lockdown mode, you can avoid becoming locked out of an ESXi host\nthat is running in lockdown mode, by setting DCUI.Access to a list of highly\ntrusted users who can override lockdown mode and access the DCUI. The DCUI is\nnot running in strict lockdown mode."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93951",
        "rid": "SV-104037r1_rule",
        "stig_id": "ESXI-65-000002",
        "fix_id": "F-100199r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the DCUI.Access value\nand verify only the root user is listed.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access and verify it is set to root.\n\nIf the DCUI.Access is not restricted to root, this is a finding.\n\nNote: This list is only for local user accounts and should only contain the\nroot user.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Click Edit and select the\nDCUI.Access value and configure it to root.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access | Set-AdvancedSetting -Value\n\"root\""
      },
      "code": "control \"V-93951\" do\n  title \"The ESXi host must verify the DCUI.Access list.\"\n  desc  \"Lockdown mode disables direct host access requiring that admins manage\nhosts from vCenter Server.  However, if a host becomes isolated from vCenter\nServer, the admin is locked out and can no longer manage the host. If you are\nusing normal lockdown mode, you can avoid becoming locked out of an ESXi host\nthat is running in lockdown mode, by setting DCUI.Access to a list of highly\ntrusted users who can override lockdown mode and access the DCUI. The DCUI is\nnot running in strict lockdown mode.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93951\"\n  tag \"rid\": \"SV-104037r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000002\"\n  tag \"fix_id\": \"F-100199r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the DCUI.Access value\nand verify only the root user is listed.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access and verify it is set to root.\n\nIf the DCUI.Access is not restricted to root, this is a finding.\n\nNote: This list is only for local user accounts and should only contain the\nroot user.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Click Edit and select the\nDCUI.Access value and configure it to root.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access | Set-AdvancedSetting -Value\n\\\"root\\\"\"\n\ncommand = 'Get-VMHost | Get-AdvancedSetting -Name DCUI.Access'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match 'root' }\nend\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93951.rb",
        "line": 1
      },
      "id": "V-93951"
    },
    {
      "title": "The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by using Active\nDirectory for local user authentication.",
      "desc": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.",
      "descriptions": {
        "default": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000109-VMM-000550",
        "gid": "V-94505",
        "rid": "SV-104335r1_rule",
        "stig_id": "ESXI-65-100037",
        "fix_id": "F-100621r1_fix",
        "cci": [
          "CCI-000770"
        ],
        "nist": [
          "IA-2 (5)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \"Directory Services Type\" is set to\n\"Active Directory\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\"\", this is a finding.\n\nIf the \"Directory Services Type\" is not set to \"Active Directory\", this is\na finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \"Properties\" and change the\n\"Directory Service Type\" to \"Active Directory\", enter the domain to join,\ncheck \"Use vSphere Authentication Proxy\" and enter the proxy server address\nthen click \"Join Domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \"domain name\" -User \"username\" -Password \"password\""
      },
      "code": "control \"V-94505\" do\n  title \"The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by using Active\nDirectory for local user authentication.\"\n  desc  \"Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \\\"ESX Admins\\\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000109-VMM-000550\"\n  tag \"gid\": \"V-94505\"\n  tag \"rid\": \"SV-104335r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100037\"\n  tag \"fix_id\": \"F-100621r1_fix\"\n  tag \"cci\": [\"CCI-000770\"]\n  tag \"nist\": [\"IA-2 (5)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \\\"Directory Services Type\\\" is set to\n\\\"Active Directory\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\"\\\", this is a finding.\n\nIf the \\\"Directory Services Type\\\" is not set to \\\"Active Directory\\\", this is\na finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \\\"Properties\\\" and change the\n\\\"Directory Service Type\\\" to \\\"Active Directory\\\", enter the domain to join,\ncheck \\\"Use vSphere Authentication Proxy\\\" and enter the proxy server address\nthen click \\\"Join Domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \\\"domain name\\\" -User \\\"username\\\" -Password \\\"password\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94505.rb",
        "line": 1
      },
      "id": "V-94505"
    },
    {
      "title": "The ESXi host SSH daemon must be configured to only use Message\nAuthentication Codes (MACs) employing FIPS 140-2 approved cryptographic hash\nalgorithms.",
      "desc": "DoD information systems are required to use FIPS 140-2 approved\ncryptographic hash functions.",
      "descriptions": {
        "default": "DoD information systems are required to use FIPS 140-2 approved\ncryptographic hash functions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93981",
        "rid": "SV-104067r1_rule",
        "stig_id": "ESXI-65-000017",
        "fix_id": "F-100229r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^MACs\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"MACs\nhmac-sha1,hmac-sha2-256,hmac-sha2-512\", this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nMACs hmac-sha1,hmac-sha2-256,hmac-sha2-512"
      },
      "code": "control \"V-93981\" do\n  title \"The ESXi host SSH daemon must be configured to only use Message\nAuthentication Codes (MACs) employing FIPS 140-2 approved cryptographic hash\nalgorithms.\"\n  desc  \"DoD information systems are required to use FIPS 140-2 approved\ncryptographic hash functions.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93981\"\n  tag \"rid\": \"SV-104067r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000017\"\n  tag \"fix_id\": \"F-100229r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^MACs\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"MACs\nhmac-sha1,hmac-sha2-256,hmac-sha2-512\\\", this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nMACs hmac-sha1,hmac-sha2-256,hmac-sha2-512\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93981.rb",
        "line": 1
      },
      "id": "V-93981"
    },
    {
      "title": "The ESXi host must centrally review and analyze audit records from\nmultiple components within the system by configuring remote logging.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000051-VMM-000230",
        "gid": "V-94493",
        "rid": "SV-104323r1_rule",
        "stig_id": "ESXI-65-100004",
        "fix_id": "F-100609r1_fix",
        "cci": [
          "CCI-000154"
        ],
        "nist": [
          "AU-6 (4)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" value is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<insert syslog server hostname>\""
      },
      "code": "control \"V-94493\" do\n  title \"The ESXi host must centrally review and analyze audit records from\nmultiple components within the system by configuring remote logging.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000051-VMM-000230\"\n  tag \"gid\": \"V-94493\"\n  tag \"rid\": \"SV-104323r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100004\"\n  tag \"fix_id\": \"F-100609r1_fix\"\n  tag \"cci\": [\"CCI-000154\"]\n  tag \"nist\": [\"AU-6 (4)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \\\"Syslog.global.logHost\\\" value is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<insert syslog server hostname>\\\"\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94493.rb",
        "line": 1
      },
      "id": "V-94493"
    },
    {
      "title": "The ESXi host SSH daemon must be configured with the Department of\nDefense (DoD) login banner.",
      "desc": "The warning message reinforces policy awareness during the logon\nprocess and facilitates possible legal action against attackers. Alternatively,\nsystems whose ownership should not be obvious should ensure usage of a banner\nthat does not provide easy attribution.",
      "descriptions": {
        "default": "The warning message reinforces policy awareness during the logon\nprocess and facilitates possible legal action against attackers. Alternatively,\nsystems whose ownership should not be obvious should ensure usage of a banner\nthat does not provide easy attribution."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000023-VMM-000060",
        "gid": "V-93965",
        "rid": "SV-104051r1_rule",
        "stig_id": "ESXI-65-000009",
        "fix_id": "F-100213r1_fix",
        "cci": [
          "CCI-000048"
        ],
        "nist": [
          "AC-8 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^Banner\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Banner /etc/issue\", this\nis a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nBanner /etc/issue"
      },
      "code": "control \"V-93965\" do\n  title \"The ESXi host SSH daemon must be configured with the Department of\nDefense (DoD) login banner.\"\n  desc  \"The warning message reinforces policy awareness during the logon\nprocess and facilitates possible legal action against attackers. Alternatively,\nsystems whose ownership should not be obvious should ensure usage of a banner\nthat does not provide easy attribution.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000023-VMM-000060\"\n  tag \"gid\": \"V-93965\"\n  tag \"rid\": \"SV-104051r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000009\"\n  tag \"fix_id\": \"F-100213r1_fix\"\n  tag \"cci\": [\"CCI-000048\"]\n  tag \"nist\": [\"AC-8 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^Banner\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"Banner /etc/issue\\\", this\nis a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nBanner /etc/issue\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93965.rb",
        "line": 1
      },
      "id": "V-93965"
    },
    {
      "title": "The ESXi host must display the Standard Mandatory DoD Notice and\nConsent Banner before granting access to the system.",
      "desc": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.",
      "descriptions": {
        "default": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000023-VMM-000060",
        "gid": "V-93963",
        "rid": "SV-104049r1_rule",
        "stig_id": "ESXI-65-000008",
        "fix_id": "F-100211r1_fix",
        "cci": [
          "CCI-000048"
        ],
        "nist": [
          "AC-8 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the Config.Etc.issue\nvalue and verify it is set to DoD logon banner below.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue\n\nIf the Config.Etc.issue setting (/etc/issue file) does not contain the logon\nbanner exactly as shown below this is a finding.\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions: -The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited to, penetration testing, COMSEC monitoring, network\noperations and defense, personnel misconduct (PM), law enforcement (LE), and\ncounterintelligence (CI) investigations. -At any time, the USG may inspect and\nseize data stored on this IS. -Communications using, or data stored on, this IS\nare not private, are subject to routine monitoring, interception, and search,\nand may be disclosed or used for any USG-authorized purpose. -This IS includes\nsecurity measures (e.g., authentication and access controls) to protect USG\ninterests--not for your personal benefit or privacy. -Notwithstanding the\nabove, using this IS does not constitute consent to PM, LE or CI investigative\nsearching or monitoring of the content of privileged communications, or work\nproduct, related to personal representation or services by attorneys,\npsychotherapists, or clergy, and their assistants. Such communications and work\nproduct are private and confidential. See User Agreement for details.\"",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.Etc.issue value and set it to the following.\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions: -The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited to, penetration testing, COMSEC monitoring, network\noperations and defense, personnel misconduct (PM), law enforcement (LE), and\ncounterintelligence (CI) investigations. -At any time, the USG may inspect and\nseize data stored on this IS. -Communications using, or data stored on, this IS\nare not private, are subject to routine monitoring, interception, and search,\nand may be disclosed or used for any USG-authorized purpose. -This IS includes\nsecurity measures (e.g., authentication and access controls) to protect USG\ninterests--not for your personal benefit or privacy. -Notwithstanding the\nabove, using this IS does not constitute consent to PM, LE or CI investigative\nsearching or monitoring of the content of privileged communications, or work\nproduct, related to personal representation or services by attorneys,\npsychotherapists, or clergy, and their assistants. Such communications and work\nproduct are private and confidential. See User Agreement for details.\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue | Set-AdvancedSetting\n-Value \"<insert logon banner>\""
      },
      "code": "control \"V-93963\" do\n  title \"The ESXi host must display the Standard Mandatory DoD Notice and\nConsent Banner before granting access to the system.\"\n  desc  \"Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000023-VMM-000060\"\n  tag \"gid\": \"V-93963\"\n  tag \"rid\": \"SV-104049r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000008\"\n  tag \"fix_id\": \"F-100211r1_fix\"\n  tag \"cci\": [\"CCI-000048\"]\n  tag \"nist\": [\"AC-8 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the Config.Etc.issue\nvalue and verify it is set to DoD logon banner below.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue\n\nIf the Config.Etc.issue setting (/etc/issue file) does not contain the logon\nbanner exactly as shown below this is a finding.\n\n\\\"You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions: -The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited to, penetration testing, COMSEC monitoring, network\noperations and defense, personnel misconduct (PM), law enforcement (LE), and\ncounterintelligence (CI) investigations. -At any time, the USG may inspect and\nseize data stored on this IS. -Communications using, or data stored on, this IS\nare not private, are subject to routine monitoring, interception, and search,\nand may be disclosed or used for any USG-authorized purpose. -This IS includes\nsecurity measures (e.g., authentication and access controls) to protect USG\ninterests--not for your personal benefit or privacy. -Notwithstanding the\nabove, using this IS does not constitute consent to PM, LE or CI investigative\nsearching or monitoring of the content of privileged communications, or work\nproduct, related to personal representation or services by attorneys,\npsychotherapists, or clergy, and their assistants. Such communications and work\nproduct are private and confidential. See User Agreement for details.\\\"\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.Etc.issue value and set it to the following.\n\n\\\"You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions: -The USG\nroutinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited to, penetration testing, COMSEC monitoring, network\noperations and defense, personnel misconduct (PM), law enforcement (LE), and\ncounterintelligence (CI) investigations. -At any time, the USG may inspect and\nseize data stored on this IS. -Communications using, or data stored on, this IS\nare not private, are subject to routine monitoring, interception, and search,\nand may be disclosed or used for any USG-authorized purpose. -This IS includes\nsecurity measures (e.g., authentication and access controls) to protect USG\ninterests--not for your personal benefit or privacy. -Notwithstanding the\nabove, using this IS does not constitute consent to PM, LE or CI investigative\nsearching or monitoring of the content of privileged communications, or work\nproduct, related to personal representation or services by attorneys,\npsychotherapists, or clergy, and their assistants. Such communications and work\nproduct are private and confidential. See User Agreement for details.\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue | Set-AdvancedSetting\n-Value \\\"<insert logon banner>\\\"\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Config.Etc.issue).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not eq \"\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93963.rb",
        "line": 1
      },
      "id": "V-93963"
    },
    {
      "title": "The ESXi host must protect the confidentiality and integrity of\ntransmitted information by protecting IP based management traffic.",
      "desc": "Virtual machines might share virtual switches and VLANs with the\nIP-based storage configurations. IP-based storage includes vSAN, iSCSI and NFS.\nThis configuration might expose IP-based storage traffic to unauthorized\nvirtual machine users. IP-based storage frequently is not encrypted. It can be\nviewed by anyone with access to this network. To restrict unauthorized users\nfrom viewing the IP-based storage traffic, the IP-based storage network must be\nlogically separated from the production traffic. Configuring the IP-based\nstorage adaptors on separate VLANs or network segments from other VMkernels and\nVirtual Machines will limit unauthorized users from viewing the traffic.",
      "descriptions": {
        "default": "Virtual machines might share virtual switches and VLANs with the\nIP-based storage configurations. IP-based storage includes vSAN, iSCSI and NFS.\nThis configuration might expose IP-based storage traffic to unauthorized\nvirtual machine users. IP-based storage frequently is not encrypted. It can be\nviewed by anyone with access to this network. To restrict unauthorized users\nfrom viewing the IP-based storage traffic, the IP-based storage network must be\nlogically separated from the production traffic. Configuring the IP-based\nstorage adaptors on separate VLANs or network segments from other VMkernels and\nVirtual Machines will limit unauthorized users from viewing the traffic."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000423-VMM-001700",
        "gid": "V-94047",
        "rid": "SV-104133r1_rule",
        "stig_id": "ESXI-65-000050",
        "fix_id": "F-100295r1_fix",
        "cci": [
          "CCI-002418"
        ],
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "IP-Based storage (iSCSI, NFS, vSAN) VMkernel port groups must\nbe in a dedicated VLAN that can be on a common standard or distributed virtual\nswitch that is logically separated from other traffic types.  The check for\nthis will be unique per environment.\n\nFrom the vSphere Web Client select the ESXi Host and go to Configure >>\nNetworking >> VMkernel adapters and review the VLANs associated with any\nIP-Based storage VMkernels and verify they are dedicated for that purpose and\nare logically separated from other functions.\n\nIf any IP-Based storage networks are not isolated from other traffic types,\nthis is a finding.\n\nIf IP-based storage is not used, this is not applicable.",
        "fix": "Configuration of an IP-Based VMkernel will be unique to each\nenvironment but for example to modify the IP address and VLAN information to\nthe correct network on a standard switch for an iSCSI VMkernel do the following:\n\nFrom the vSphere Web Client select the ESXi host and go to Configure >>\nNetworking >> VMkernel adapters. Select the Storage VMkernel (for vSAN only)\nand click Edit settings >> On the Port properties tab uncheck everything but\n\"vSAN.” On the IP Settings tab >> Enter the appropriate IP address and subnet\ninformation and click OK.\n\nSet the appropriate VLAN ID >> Configure >> Networking >> Virtual switches.\nSelect the Storage portgroup (iSCSI, NFS, vSAN) and click Edit settings >> On\nthe properties tab, enter the appropriate VLAN ID and click OK."
      },
      "code": "control \"V-94047\" do\n  title \"The ESXi host must protect the confidentiality and integrity of\ntransmitted information by protecting IP based management traffic.\"\n  desc  \"Virtual machines might share virtual switches and VLANs with the\nIP-based storage configurations. IP-based storage includes vSAN, iSCSI and NFS.\nThis configuration might expose IP-based storage traffic to unauthorized\nvirtual machine users. IP-based storage frequently is not encrypted. It can be\nviewed by anyone with access to this network. To restrict unauthorized users\nfrom viewing the IP-based storage traffic, the IP-based storage network must be\nlogically separated from the production traffic. Configuring the IP-based\nstorage adaptors on separate VLANs or network segments from other VMkernels and\nVirtual Machines will limit unauthorized users from viewing the traffic.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000423-VMM-001700\"\n  tag \"gid\": \"V-94047\"\n  tag \"rid\": \"SV-104133r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000050\"\n  tag \"fix_id\": \"F-100295r1_fix\"\n  tag \"cci\": [\"CCI-002418\"]\n  tag \"nist\": [\"SC-8\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"IP-Based storage (iSCSI, NFS, vSAN) VMkernel port groups must\nbe in a dedicated VLAN that can be on a common standard or distributed virtual\nswitch that is logically separated from other traffic types.  The check for\nthis will be unique per environment.\n\nFrom the vSphere Web Client select the ESXi Host and go to Configure >>\nNetworking >> VMkernel adapters and review the VLANs associated with any\nIP-Based storage VMkernels and verify they are dedicated for that purpose and\nare logically separated from other functions.\n\nIf any IP-Based storage networks are not isolated from other traffic types,\nthis is a finding.\n\nIf IP-based storage is not used, this is not applicable.\"\n  tag \"fix\": \"Configuration of an IP-Based VMkernel will be unique to each\nenvironment but for example to modify the IP address and VLAN information to\nthe correct network on a standard switch for an iSCSI VMkernel do the following:\n\nFrom the vSphere Web Client select the ESXi host and go to Configure >>\nNetworking >> VMkernel adapters. Select the Storage VMkernel (for vSAN only)\nand click Edit settings >> On the Port properties tab uncheck everything but\n\\\"vSAN.” On the IP Settings tab >> Enter the appropriate IP address and subnet\ninformation and click OK.\n\nSet the appropriate VLAN ID >> Configure >> Networking >> Virtual switches.\nSelect the Storage portgroup (iSCSI, NFS, vSAN) and click Edit settings >> On\nthe properties tab, enter the appropriate VLAN ID and click OK.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94047.rb",
        "line": 1
      },
      "id": "V-94047"
    },
    {
      "title": "The ESXi host SSH daemon must perform strict mode checking of home\ndirectory configuration files.",
      "desc": "If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log into the system as another user.",
      "descriptions": {
        "default": "If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log into the system as another user."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93987",
        "rid": "SV-104073r1_rule",
        "stig_id": "ESXI-65-000020",
        "fix_id": "F-100235r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^StrictModes\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"StrictModes yes\", this is\na finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nStrictModes yes"
      },
      "code": "control \"V-93987\" do\n  title \"The ESXi host SSH daemon must perform strict mode checking of home\ndirectory configuration files.\"\n  desc  \"If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log into the system as another user.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93987\"\n  tag \"rid\": \"SV-104073r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000020\"\n  tag \"fix_id\": \"F-100235r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^StrictModes\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"StrictModes yes\\\", this is\na finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nStrictModes yes\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93987.rb",
        "line": 1
      },
      "id": "V-93987"
    },
    {
      "title": "SNMP must be configured properly on the ESXi host.",
      "desc": "If SNMP is not being used, it must remain disabled. If it is being\nused, the proper trap destination must be configured. If SNMP is not properly\nconfigured, monitoring information can be sent to a malicious host that can\nthen use this information to plan an attack.",
      "descriptions": {
        "default": "If SNMP is not being used, it must remain disabled. If it is being\nused, the proper trap destination must be configured. If SNMP is not properly\nconfigured, monitoring information can be sent to a malicious host that can\nthen use this information to plan an attack."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94053",
        "rid": "SV-104139r1_rule",
        "stig_id": "ESXI-65-000053",
        "fix_id": "F-100301r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostSnmp | Select *\n\nor\n\nFrom a console or ssh session run the follow command:\n\nesxcli system snmp get\n\nIf SNMP is not in use and is enabled, this is a finding.\n\nIf SNMP is enabled and read only communities is set to public, this is a\nfinding.\n\nIf SNMP is enabled and is not using v3 targets, this is a finding.\n\nNote: SNMP v3 targets can only be viewed and configured from the esxcli\ncommand.",
        "fix": "To disable SNMP run the following command from a PowerCLI command\nprompt while connected to the ESXi Host:\n\nGet-VMHostSnmp | Set-VMHostSnmp -Enabled $false\n\nor\n\nFrom a console or ssh session run the follow command:\n\nesxcli system snmp set -e no\n\nTo configure SNMP for v3 targets use the \"esxcli system snmp set\" command\nset."
      },
      "code": "control \"V-94053\" do\n  title \"SNMP must be configured properly on the ESXi host.\"\n  desc  \"If SNMP is not being used, it must remain disabled. If it is being\nused, the proper trap destination must be configured. If SNMP is not properly\nconfigured, monitoring information can be sent to a malicious host that can\nthen use this information to plan an attack.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94053\"\n  tag \"rid\": \"SV-104139r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000053\"\n  tag \"fix_id\": \"F-100301r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostSnmp | Select *\n\nor\n\nFrom a console or ssh session run the follow command:\n\nesxcli system snmp get\n\nIf SNMP is not in use and is enabled, this is a finding.\n\nIf SNMP is enabled and read only communities is set to public, this is a\nfinding.\n\nIf SNMP is enabled and is not using v3 targets, this is a finding.\n\nNote: SNMP v3 targets can only be viewed and configured from the esxcli\ncommand.\"\n  tag \"fix\": \"To disable SNMP run the following command from a PowerCLI command\nprompt while connected to the ESXi Host:\n\nGet-VMHostSnmp | Set-VMHostSnmp -Enabled $false\n\nor\n\nFrom a console or ssh session run the follow command:\n\nesxcli system snmp set -e no\n\nTo configure SNMP for v3 targets use the \\\"esxcli system snmp set\\\" command\nset.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94053.rb",
        "line": 1
      },
      "id": "V-94053"
    },
    {
      "title": "The ESXi host must remove keys from the SSH authorized_keys file.",
      "desc": "ESXi hosts come with SSH which can be enabled to allow remote access\nwithout requiring user authentication.  To enable password free access copy the\nremote users public key into the \"/etc/ssh/keys-root/authorized_keys\" file on\nthe ESXi host.  The presence of the remote user's public key in the\n\"authorized_keys\" file identifies the user as trusted, meaning the user is\ngranted access to the host without providing a password.  If using Lockdown\nMode and SSH is disabled then login with authorized keys will have the same\nrestrictions as username/password.",
      "descriptions": {
        "default": "ESXi hosts come with SSH which can be enabled to allow remote access\nwithout requiring user authentication.  To enable password free access copy the\nremote users public key into the \"/etc/ssh/keys-root/authorized_keys\" file on\nthe ESXi host.  The presence of the remote user's public key in the\n\"authorized_keys\" file identifies the user as trusted, meaning the user is\ngranted access to the host without providing a password.  If using Lockdown\nMode and SSH is disabled then login with authorized keys will have the same\nrestrictions as username/password."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94005",
        "rid": "SV-104091r1_rule",
        "stig_id": "ESXI-65-000029",
        "fix_id": "F-100253r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# ls -la /etc/ssh/keys-root/authorized_keys\n\nor\n\n# cat /etc/ssh/keys-root/authorized_keys\n\nIf the authorized_keys file exists and is not empty, this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, zero or remove the /etc/ssh/keys-root/authorized_keys file:\n\n# >/etc/ssh/keys-root/authorized_keys\n\nor\n\n# rm /etc/ssh/keys-root/authorized_keys"
      },
      "code": "control \"V-94005\" do\n  title \"The ESXi host must remove keys from the SSH authorized_keys file.\"\n  desc  \"ESXi hosts come with SSH which can be enabled to allow remote access\nwithout requiring user authentication.  To enable password free access copy the\nremote users public key into the \\\"/etc/ssh/keys-root/authorized_keys\\\" file on\nthe ESXi host.  The presence of the remote user's public key in the\n\\\"authorized_keys\\\" file identifies the user as trusted, meaning the user is\ngranted access to the host without providing a password.  If using Lockdown\nMode and SSH is disabled then login with authorized keys will have the same\nrestrictions as username/password.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94005\"\n  tag \"rid\": \"SV-104091r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000029\"\n  tag \"fix_id\": \"F-100253r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# ls -la /etc/ssh/keys-root/authorized_keys\n\nor\n\n# cat /etc/ssh/keys-root/authorized_keys\n\nIf the authorized_keys file exists and is not empty, this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, zero or remove the /etc/ssh/keys-root/authorized_keys file:\n\n# >/etc/ssh/keys-root/authorized_keys\n\nor\n\n# rm /etc/ssh/keys-root/authorized_keys\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94005.rb",
        "line": 1
      },
      "id": "V-94005"
    },
    {
      "title": "The ESXi host must produce audit records containing information to\nestablish what type of events occurred.",
      "desc": "Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.",
      "descriptions": {
        "default": "Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000037-VMM-000150",
        "gid": "V-94007",
        "rid": "SV-104093r1_rule",
        "stig_id": "ESXI-65-000030",
        "fix_id": "F-100255r1_fix",
        "cci": [
          "CCI-000130"
        ],
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nConfig.HostAgent.log.level value and verify it is set to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level\n\nIf the Config.HostAgent.log.level setting is not set to info, this is a finding.\n\nNote: Verbose logging level is acceptable for troubleshooting purposes.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.log.level value and configure it to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level |\nSet-AdvancedSetting -Value \"info\""
      },
      "code": "control \"V-94007\" do\n  title \"The ESXi host must produce audit records containing information to\nestablish what type of events occurred.\"\n  desc  \"Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000037-VMM-000150\"\n  tag \"gid\": \"V-94007\"\n  tag \"rid\": \"SV-104093r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000030\"\n  tag \"fix_id\": \"F-100255r1_fix\"\n  tag \"cci\": [\"CCI-000130\"]\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nConfig.HostAgent.log.level value and verify it is set to \\\"info\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level\n\nIf the Config.HostAgent.log.level setting is not set to info, this is a finding.\n\nNote: Verbose logging level is acceptable for troubleshooting purposes.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nConfig.HostAgent.log.level value and configure it to \\\"info\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level |\nSet-AdvancedSetting -Value \\\"info\\\"\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq \"info\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94007.rb",
        "line": 1
      },
      "id": "V-94007"
    },
    {
      "title": "The ESXi host SSH daemon must be configured to only use FIPS 140-2\napproved ciphers.",
      "desc": "Approved algorithms should impart some level of confidence in their\nimplementation. These are also required for compliance.\n\n    Note: That this does not imply FIPS 140-2 certification.",
      "descriptions": {
        "default": "Approved algorithms should impart some level of confidence in their\nimplementation. These are also required for compliance.\n\n    Note: That this does not imply FIPS 140-2 certification."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000478-VMM-001980",
        "gid": "V-94497",
        "rid": "SV-104327r1_rule",
        "stig_id": "ESXI-65-100010",
        "fix_id": "F-100613r1_fix",
        "cci": [
          "CCI-002450"
        ],
        "nist": [
          "SC-13",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Only FIPS-approved ciphers should be used. To verify that only\nFIPS-approved ciphers are in use, run the following command:\n\n# grep -i \"^Ciphers\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Ciphers\naes128-ctr,aes192-ctr,aes256-ctr\", this is a finding.",
        "fix": "Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\":\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr"
      },
      "code": "control \"V-94497\" do\n  title \"The ESXi host SSH daemon must be configured to only use FIPS 140-2\napproved ciphers.\"\n  desc  \"Approved algorithms should impart some level of confidence in their\nimplementation. These are also required for compliance.\n\n    Note: That this does not imply FIPS 140-2 certification.\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000478-VMM-001980\"\n  tag \"gid\": \"V-94497\"\n  tag \"rid\": \"SV-104327r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100010\"\n  tag \"fix_id\": \"F-100613r1_fix\"\n  tag \"cci\": [\"CCI-002450\"]\n  tag \"nist\": [\"SC-13\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Only FIPS-approved ciphers should be used. To verify that only\nFIPS-approved ciphers are in use, run the following command:\n\n# grep -i \\\"^Ciphers\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"Ciphers\naes128-ctr,aes192-ctr,aes256-ctr\\\", this is a finding.\"\n  tag \"fix\": \"Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\n\nAdd or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94497.rb",
        "line": 1
      },
      "id": "V-94497"
    },
    {
      "title": "The ESXi host must have all security patches and updates installed.",
      "desc": "Installing software updates is a fundamental mitigation against the\nexploitation of publicly-known vulnerabilities.",
      "descriptions": {
        "default": "Installing software updates is a fundamental mitigation against the\nexploitation of publicly-known vulnerabilities."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94479",
        "rid": "SV-104309r1_rule",
        "stig_id": "ESXI-65-000072",
        "fix_id": "F-100595r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "If vCenter Update Manager is used on the network it can be used\nto scan all hosts for missing patches.  From the vSphere Client go to Hosts and\nClusters > Update Manager tab and select scan to view all hosts compliance\nstatus.\n\nIf vCenter Update Manager is not used a hosts compliance status must be\nmanually determined by the build number.  The following VMware KB 1014508 can\nbe used to correlate patches with build numbers.\n\nIf the ESXi host does not have the latest patches, this is a finding.\n\nIf the ESXi host is not on a supported release, this is a finding.\n\nVMware also publishes Advisories on security patches, and offers a way to\nsubscribe to email alerts for them.\nhttps://www.vmware.com/support/policies/security_response",
        "fix": "If vCenter Update Manager is used on the network, hosts can be\nremediated from the vSphere Web Client. From the vSphere Web Client go to Hosts\nand Clusters >> Update Manager tab and select a non-compliant host and click\nthe Remediate button.\n\nTo manually remediate a host the patch file must be copied locally and the\nfollowing command run from an SSH session connected to the ESXi host, or from\nthe ESXi shell:\n\nesxcli software vib update -d <path to offline patch bundle.zip>"
      },
      "code": "control \"V-94479\" do\n  title \"The ESXi host must have all security patches and updates installed.\"\n  desc  \"Installing software updates is a fundamental mitigation against the\nexploitation of publicly-known vulnerabilities.\"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94479\"\n  tag \"rid\": \"SV-104309r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000072\"\n  tag \"fix_id\": \"F-100595r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"If vCenter Update Manager is used on the network it can be used\nto scan all hosts for missing patches.  From the vSphere Client go to Hosts and\nClusters > Update Manager tab and select scan to view all hosts compliance\nstatus.\n\nIf vCenter Update Manager is not used a hosts compliance status must be\nmanually determined by the build number.  The following VMware KB 1014508 can\nbe used to correlate patches with build numbers.\n\nIf the ESXi host does not have the latest patches, this is a finding.\n\nIf the ESXi host is not on a supported release, this is a finding.\n\nVMware also publishes Advisories on security patches, and offers a way to\nsubscribe to email alerts for them.\nhttps://www.vmware.com/support/policies/security_response\"\n  tag \"fix\": \"If vCenter Update Manager is used on the network, hosts can be\nremediated from the vSphere Web Client. From the vSphere Web Client go to Hosts\nand Clusters >> Update Manager tab and select a non-compliant host and click\nthe Remediate button.\n\nTo manually remediate a host the patch file must be copied locally and the\nfollowing command run from an SSH session connected to the ESXi host, or from\nthe ESXi shell:\n\nesxcli software vib update -d <path to offline patch bundle.zip>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94479.rb",
        "line": 1
      },
      "id": "V-94479"
    },
    {
      "title": "The ESXi host must enforce password complexity by requiring that at\nleast one special character be used.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000266-VMM-000940",
        "gid": "V-94557",
        "rid": "SV-104387r1_rule",
        "stig_id": "ESXI-65-500031",
        "fix_id": "F-100673r1_fix",
        "cci": [
          "CCI-001619"
        ],
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and verify it is set to\n\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" value is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94557\" do\n  title \"The ESXi host must enforce password complexity by requiring that at\nleast one special character be used.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000266-VMM-000940\"\n  tag \"gid\": \"V-94557\"\n  tag \"rid\": \"SV-104387r1_rule\"\n  tag \"stig_id\": \"ESXI-65-500031\"\n  tag \"fix_id\": \"F-100673r1_fix\"\n  tag \"cci\": [\"CCI-001619\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and verify it is set to\n\\\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \\\"Security.PasswordQualityControl\\\" value is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94557.rb",
        "line": 1
      },
      "id": "V-94557"
    },
    {
      "title": "The ESXi host must immediately disconnect or disable remote access to\nthe information system by disabling SSH.",
      "desc": "Client. The ESXi shell is accessible remotely using SSH by users with\nthe Administrator role. Under normal operating conditions, SSH access to the\nhost must be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.",
      "descriptions": {
        "default": "Client. The ESXi shell is accessible remotely using SSH by users with\nthe Administrator role. Under normal operating conditions, SSH access to the\nhost must be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000298-VMM-001050",
        "gid": "V-94527",
        "rid": "SV-104357r1_rule",
        "stig_id": "ESXI-65-200035",
        "fix_id": "F-100643r1_fix",
        "cci": [
          "CCI-002322"
        ],
        "nist": [
          "AC-17 (9)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Services\" select \"Edit\" and view\nthe \"SSH\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"}\n\nIf the ESXi SSH service is running, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Services\" select \"Edit\" then\nselect the \"SSH\" service and click \"options\".  Change the service to\n\"Start and stop manually\" and stop the service and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} |\nStop-VMHostService"
      },
      "code": "control \"V-94527\" do\n  title \"The ESXi host must immediately disconnect or disable remote access to\nthe information system by disabling SSH.\"\n  desc  \"Client. The ESXi shell is accessible remotely using SSH by users with\nthe Administrator role. Under normal operating conditions, SSH access to the\nhost must be disabled as is the default.  As with the ESXi shell, SSH is also\nintended only for temporary use during break-fix scenarios. SSH must therefore\nbe disabled under normal operating conditions and must only be enabled for\ndiagnostics or troubleshooting. Remote access to the host must therefore be\nlimited to the vSphere Client at all other times.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000298-VMM-001050\"\n  tag \"gid\": \"V-94527\"\n  tag \"rid\": \"SV-104357r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200035\"\n  tag \"fix_id\": \"F-100643r1_fix\"\n  tag \"cci\": [\"CCI-002322\"]\n  tag \"nist\": [\"AC-17 (9)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Services\\\" select \\\"Edit\\\" and view\nthe \\\"SSH\\\" service and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"}\n\nIf the ESXi SSH service is running, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Services\\\" select \\\"Edit\\\" then\nselect the \\\"SSH\\\" service and click \\\"options\\\".  Change the service to\n\\\"Start and stop manually\\\" and stop the service and click \\\"OK\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nSet-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"SSH\\\"} |\nStop-VMHostService\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94527.rb",
        "line": 1
      },
      "id": "V-94527"
    },
    {
      "title": "The ESXi host must electronically verify Personal Identity\nVerification (PIV) credentials.",
      "desc": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000377-VMM-001530",
        "gid": "V-94535",
        "rid": "SV-104365r1_rule",
        "stig_id": "ESXI-65-200040",
        "fix_id": "F-100651r1_fix",
        "cci": [
          "CCI-001954"
        ],
        "nist": [
          "IA-2 (12)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that have no local user accounts, other than\n\"root\" and/or \"vpxuser\", this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the Smart Card Authentication status.\n\nIf \"Enable Smart Card Authentication\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is a finding.",
        "fix": "The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \"Enable Smart Card\nAuthentication\" and click \"OK\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website."
      },
      "code": "control \"V-94535\" do\n  title \"The ESXi host must electronically verify Personal Identity\nVerification (PIV) credentials.\"\n  desc  \"To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000377-VMM-001530\"\n  tag \"gid\": \"V-94535\"\n  tag \"rid\": \"SV-104365r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200040\"\n  tag \"fix_id\": \"F-100651r1_fix\"\n  tag \"cci\": [\"CCI-001954\"]\n  tag \"nist\": [\"IA-2 (12)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that have no local user accounts, other than\n\\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the Smart Card Authentication status.\n\nIf \\\"Enable Smart Card Authentication\\\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\"\n  tag \"fix\": \"The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \\\"Enable Smart Card\nAuthentication\\\" and click \\\"OK\\\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94535.rb",
        "line": 1
      },
      "id": "V-94535"
    },
    {
      "title": "The ESXi host SSH daemon must not permit GSSAPI authentication.",
      "desc": "GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe system’s GSSAPI to remote hosts, increasing the attack surface of the\nsystem.",
      "descriptions": {
        "default": "GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe system’s GSSAPI to remote hosts, increasing the attack surface of the\nsystem."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93983",
        "rid": "SV-104069r1_rule",
        "stig_id": "ESXI-65-000018",
        "fix_id": "F-100231r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^GSSAPIAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"GSSAPIAuthentication no\",\nthis is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nGSSAPIAuthentication no"
      },
      "code": "control \"V-93983\" do\n  title \"The ESXi host SSH daemon must not permit GSSAPI authentication.\"\n  desc  \"GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe system’s GSSAPI to remote hosts, increasing the attack surface of the\nsystem.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93983\"\n  tag \"rid\": \"SV-104069r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000018\"\n  tag \"fix_id\": \"F-100231r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^GSSAPIAuthentication\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"GSSAPIAuthentication no\\\",\nthis is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nGSSAPIAuthentication no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93983.rb",
        "line": 1
      },
      "id": "V-93983"
    },
    {
      "title": "For the ESXi host all port groups must not be configured to VLAN 4095\nunless Virtual Guest Tagging (VGT) is required.",
      "desc": "When a port group is set to VLAN 4095, this activates VGT mode. In\nthis mode, the vSwitch passes all network frames to the guest VM without\nmodifying the VLAN tags, leaving it up to the guest to deal with them. VLAN\n4095 should be used only if the guest has been specifically configured to\nmanage VLAN tags itself. If VGT is enabled inappropriately, it might cause\ndenial-of-service or allow a guest VM to interact with traffic on an\nunauthorized VLAN.",
      "descriptions": {
        "default": "When a port group is set to VLAN 4095, this activates VGT mode. In\nthis mode, the vSwitch passes all network frames to the guest VM without\nmodifying the VLAN tags, leaving it up to the guest to deal with them. VLAN\n4095 should be used only if the guest has been specifically configured to\nmanage VLAN tags itself. If VGT is enabled inappropriately, it might cause\ndenial-of-service or allow a guest VM to interact with traffic on an\nunauthorized VLAN."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94075",
        "rid": "SV-104161r1_rule",
        "stig_id": "ESXI-65-000064",
        "fix_id": "F-100323r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to 4095.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanID\n\nIf any port group is configured with VLAN 4095 and is not documented as a\nneeded exception, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to 4095) and click Edit settings. Change the VLAN ID to not be 4095 and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId\n\"New VLAN#\""
      },
      "code": "control \"V-94075\" do\n  title \"For the ESXi host all port groups must not be configured to VLAN 4095\nunless Virtual Guest Tagging (VGT) is required.\"\n  desc  \"When a port group is set to VLAN 4095, this activates VGT mode. In\nthis mode, the vSwitch passes all network frames to the guest VM without\nmodifying the VLAN tags, leaving it up to the guest to deal with them. VLAN\n4095 should be used only if the guest has been specifically configured to\nmanage VLAN tags itself. If VGT is enabled inappropriately, it might cause\ndenial-of-service or allow a guest VM to interact with traffic on an\nunauthorized VLAN.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94075\"\n  tag \"rid\": \"SV-104161r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000064\"\n  tag \"fix_id\": \"F-100323r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to 4095.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanID\n\nIf any port group is configured with VLAN 4095 and is not documented as a\nneeded exception, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to 4095) and click Edit settings. Change the VLAN ID to not be 4095 and\nclick OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \\\"portgroup name\\\" | Set-VirtualPortGroup -VLanId\n\\\"New VLAN#\\\"\"\n\ncommand = 'Get-VirtualPortGroup | Select VLanId -ExpandProperty VLanId'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"4095\" }\nend\n\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94075.rb",
        "line": 1
      },
      "id": "V-94075"
    },
    {
      "title": "The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown by setting an idle timeout on\nshell services.",
      "desc": "When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\n\"ESXiShellTimeOut\" value.  The \"ESXiShellTimeOut\" value defines a window of\ntime after which the ESXi Shell and SSH services will automatically be\nterminated.",
      "descriptions": {
        "default": "When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\n\"ESXiShellTimeOut\" value.  The \"ESXiShellTimeOut\" value defines a window of\ntime after which the ESXi Shell and SSH services will automatically be\nterminated."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000279-VMM-001010",
        "gid": "V-94515",
        "rid": "SV-104345r1_rule",
        "stig_id": "ESXI-65-100042",
        "fix_id": "F-100631r1_fix",
        "cci": [
          "CCI-002361"
        ],
        "nist": [
          "AC-12",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"UserVars.ESXiShellTimeOut\"\nvalue and verify it is set to \"600\" (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut\n\nIf the \"UserVars.ESXiShellTimeOut\" value is not set to \"600\", this is a\nfinding.",
        "fix": "From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the \"UserVars.ESXiShellTimeOut\"\nvalue and configure it to \"600\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94515\" do\n  title \"The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown by setting an idle timeout on\nshell services.\"\n  desc  \"When the ESXi Shell or SSH services are enabled on a host they will\nrun indefinitely.  To avoid having these services left running set the\n\\\"ESXiShellTimeOut\\\" value.  The \\\"ESXiShellTimeOut\\\" value defines a window of\ntime after which the ESXi Shell and SSH services will automatically be\nterminated.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000279-VMM-001010\"\n  tag \"gid\": \"V-94515\"\n  tag \"rid\": \"SV-104345r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100042\"\n  tag \"fix_id\": \"F-100631r1_fix\"\n  tag \"cci\": [\"CCI-002361\"]\n  tag \"nist\": [\"AC-12\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"UserVars.ESXiShellTimeOut\\\"\nvalue and verify it is set to \\\"600\\\" (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut\n\nIf the \\\"UserVars.ESXiShellTimeOut\\\" value is not set to \\\"600\\\", this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the \\\"UserVars.ESXiShellTimeOut\\\"\nvalue and configure it to \\\"600\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut |\nSet-AdvancedSetting -Value 600\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94515.rb",
        "line": 1
      },
      "id": "V-94515"
    },
    {
      "title": "The ESXi host must not provide root/administrator level access to\nCIM-based hardware monitoring tools or other third-party applications.",
      "desc": "The CIM system provides an interface that enables hardware-level\nmanagement from remote applications via a set of standard APIs. Create a\nlimited-privilege, read-only service account for CIM. Grant this role to the\nuser on the ESXi server.  Place this user in the Exception Users list.\nWhen/where write access is required, create/enable a limited-privilege, service\naccount and grant only the minimum required privileges.",
      "descriptions": {
        "default": "The CIM system provides an interface that enables hardware-level\nmanagement from remote applications via a set of standard APIs. Create a\nlimited-privilege, read-only service account for CIM. Grant this role to the\nuser on the ESXi server.  Place this user in the Exception Users list.\nWhen/where write access is required, create/enable a limited-privilege, service\naccount and grant only the minimum required privileges."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94349",
        "rid": "SV-104303r1_rule",
        "stig_id": "ESXI-65-000070",
        "fix_id": "F-100465r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client, select the ESXi host, and go to\n\"Permissions\". Select the CIM account user, then click Edit settings to\nverify read-only access.\n\nIf write access is not required and the access level is not \"read-only\", this\nis a finding.",
        "fix": "From the vSphere Web Client, select the ESXi host, go to\n“Permissions”. Click the green plus sign and click Add to add a\nlimited-privileged, read-only service account for CIM. Place the CIM account\ninto the \"root\" group. Select Users and right-click in the user screen.\nSelect \"Add\", then Add a new user. If write access is required only grant the\nminimum required privileges. CIM accounts should be limited to the \"Host >>\nConfig >> System Management\" and \"Host >> CIM >> CIMInteraction\" privileges."
      },
      "code": "control \"V-94349\" do\n  title \"The ESXi host must not provide root/administrator level access to\nCIM-based hardware monitoring tools or other third-party applications.\"\n  desc  \"The CIM system provides an interface that enables hardware-level\nmanagement from remote applications via a set of standard APIs. Create a\nlimited-privilege, read-only service account for CIM. Grant this role to the\nuser on the ESXi server.  Place this user in the Exception Users list.\nWhen/where write access is required, create/enable a limited-privilege, service\naccount and grant only the minimum required privileges.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94349\"\n  tag \"rid\": \"SV-104303r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000070\"\n  tag \"fix_id\": \"F-100465r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client, select the ESXi host, and go to\n\\\"Permissions\\\". Select the CIM account user, then click Edit settings to\nverify read-only access.\n\nIf write access is not required and the access level is not \\\"read-only\\\", this\nis a finding.\"\n  tag \"fix\": \"From the vSphere Web Client, select the ESXi host, go to\n“Permissions”. Click the green plus sign and click Add to add a\nlimited-privileged, read-only service account for CIM. Place the CIM account\ninto the \\\"root\\\" group. Select Users and right-click in the user screen.\nSelect \\\"Add\\\", then Add a new user. If write access is required only grant the\nminimum required privileges. CIM accounts should be limited to the \\\"Host >>\nConfig >> System Management\\\" and \\\"Host >> CIM >> CIMInteraction\\\" privileges.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94349.rb",
        "line": 1
      },
      "id": "V-94349"
    },
    {
      "title": "The ESXi host must only allow the use of DoD PKI-established\ncertificate authorities for verification of the establishment of protected\nsessions.",
      "desc": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000403-VMM-001640",
        "gid": "V-94549",
        "rid": "SV-104379r1_rule",
        "stig_id": "ESXI-65-300040",
        "fix_id": "F-100665r1_fix",
        "cci": [
          "CCI-002470"
        ],
        "nist": [
          "SC-23 (5)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that have no local user accounts, other than root\nand/or vpxuser, this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the Smart Card Authentication status.\n\nIf \"Enable Smart Card Authentication\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is a finding.",
        "fix": "The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \"Enable Smart Card\nAuthentication\" and click \"OK\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website."
      },
      "code": "control \"V-94549\" do\n  title \"The ESXi host must only allow the use of DoD PKI-established\ncertificate authorities for verification of the establishment of protected\nsessions.\"\n  desc  \"To assure accountability and prevent unauthenticated access,\nprivileged users must utilize multifactor authentication to prevent potential\nmisuse and compromise of the system.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000403-VMM-001640\"\n  tag \"gid\": \"V-94549\"\n  tag \"rid\": \"SV-104379r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300040\"\n  tag \"fix_id\": \"F-100665r1_fix\"\n  tag \"cci\": [\"CCI-002470\"]\n  tag \"nist\": [\"SC-23 (5)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that have no local user accounts, other than root\nand/or vpxuser, this is not applicable.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and view the Smart Card Authentication status.\n\nIf \\\"Enable Smart Card Authentication\\\" is checked, the system requires smart\ncards to authentication to an Active Directory Domain.\n\nFor systems that do not use smart cards with Active Directory and do have local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\"\n  tag \"fix\": \"The following are pre-requisites to configuration smart card\nauthentication for the ESXi DCUI:\n-Active Directory domain that supports smart card authentication, smart card\nreaders, and smart cards.\n-ESXi joined to an Active Directory domain.\n-Trusted certificates for root and intermediary certificate authorities.\n\nFrom the vSphere Web Client select the ESXi host and go to Manage >>\nAuthentication Services and edit the Smart Card Authentication configuration to\nadd trusted certificate authority certificates and select \\\"Enable Smart Card\nAuthentication\\\" and click \\\"OK\\\".\n\nFor more information see the vSphere 6.5 documentation on VMware's website.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94549.rb",
        "line": 1
      },
      "id": "V-94549"
    },
    {
      "title": "The ESXi host must configure the firewall to block network traffic by\ndefault.",
      "desc": "In addition to service specific firewall rules ESXi has a default\nfirewall rule policy to allow or deny incoming and outgoing traffic.  Reduce\nthe risk of attack by making sure this is set to deny incoming and outgoing\ntraffic.",
      "descriptions": {
        "default": "In addition to service specific firewall rules ESXi has a default\nfirewall rule policy to allow or deny incoming and outgoing traffic.  Reduce\nthe risk of attack by making sure this is set to deny incoming and outgoing\ntraffic."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94061",
        "rid": "SV-104147r1_rule",
        "stig_id": "ESXI-65-000057",
        "fix_id": "F-100309r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostFirewallDefaultPolicy\n\nIf the Incoming or Outgoing policies are True, this is a finding.",
        "fix": "From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostFirewallDefaultPolicy | Set-VMHostFirewallDefaultPolicy\n-AllowIncoming $false -AllowOutgoing $false"
      },
      "code": "control \"V-94061\" do\n  title \"The ESXi host must configure the firewall to block network traffic by\ndefault.\"\n  desc  \"In addition to service specific firewall rules ESXi has a default\nfirewall rule policy to allow or deny incoming and outgoing traffic.  Reduce\nthe risk of attack by making sure this is set to deny incoming and outgoing\ntraffic.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94061\"\n  tag \"rid\": \"SV-104147r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000057\"\n  tag \"fix_id\": \"F-100309r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostFirewallDefaultPolicy\n\nIf the Incoming or Outgoing policies are True, this is a finding.\"\n  tag \"fix\": \"From a PowerCLI command prompt while connected to the ESXi host\nrun the following command:\n\nGet-VMHostFirewallDefaultPolicy | Set-VMHostFirewallDefaultPolicy\n-AllowIncoming $false -AllowOutgoing $false\"\n\ncommand = 'Get-VMHostFirewallDefaultPolicy'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94061.rb",
        "line": 1
      },
      "id": "V-94061"
    },
    {
      "title": "The ESXi host must enable TLS 1.2 exclusively for the SFCB service.",
      "desc": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi",
      "descriptions": {
        "default": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94481",
        "rid": "SV-104311r1_rule",
        "stig_id": "ESXI-65-000073",
        "fix_id": "F-100597r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\ngrep \"enableTLS\" /etc/sfcb/sfcb.cfg\n\nIf the output indicates that any protocol is enabled other than TLSv1_2, this\nis a finding.",
        "fix": "Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n\ncp -f /etc/sfcb/sfcb.cfg /etc/sfcb/sfcb.cfg.orig\n\ngrep -v \"enableTLS\" /etc/sfcb/sfcb.cfg.orig>/etc/sfcb/sfcb.cfg\n\necho enableTLSv1: false>>sfcb.cfg\n\necho enableTLSv1_1: false>>sfcb.cfg\n\necho enableTLSv1_2: true>>sfcb.cfg\n\n/etc/init.d/sfcbd-watchdog  restart"
      },
      "code": "control \"V-94481\" do\n  title \"The ESXi host must enable TLS 1.2 exclusively for the SFCB service.\"\n  desc  \"TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94481\"\n  tag \"rid\": \"SV-104311r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000073\"\n  tag \"fix_id\": \"F-100597r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\ngrep \\\"enableTLS\\\" /etc/sfcb/sfcb.cfg\n\nIf the output indicates that any protocol is enabled other than TLSv1_2, this\nis a finding.\"\n  tag \"fix\": \"Temporarily enable SSH, connect to the ESXi host and run the\nfollowing command:\n\n\ncp -f /etc/sfcb/sfcb.cfg /etc/sfcb/sfcb.cfg.orig\n\ngrep -v \\\"enableTLS\\\" /etc/sfcb/sfcb.cfg.orig>/etc/sfcb/sfcb.cfg\n\necho enableTLSv1: false>>sfcb.cfg\n\necho enableTLSv1_1: false>>sfcb.cfg\n\necho enableTLSv1_2: true>>sfcb.cfg\n\n/etc/init.d/sfcbd-watchdog  restart\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94481.rb",
        "line": 1
      },
      "id": "V-94481"
    },
    {
      "title": "The virtual switch Promiscuous Mode policy must be set to reject on\nthe ESXi host.",
      "desc": "When promiscuous mode is enabled for a virtual switch all virtual\nmachines connected to the Portgroup have the potential of reading all packets\nacross that network, meaning only the virtual machines connected to that\nPortgroup. Promiscuous mode is disabled by default on the ESXi Server, and this\nis the recommended setting. Promiscous mode can be set at the vSwitch and/or\nthe Portgroup level. You can override switch level settings at the Portgroup\nlevel.",
      "descriptions": {
        "default": "When promiscuous mode is enabled for a virtual switch all virtual\nmachines connected to the Portgroup have the potential of reading all packets\nacross that network, meaning only the virtual machines connected to that\nPortgroup. Promiscuous mode is disabled by default on the ESXi Server, and this\nis the recommended setting. Promiscous mode can be set at the vSwitch and/or\nthe Portgroup level. You can override switch level settings at the Portgroup\nlevel."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94069",
        "rid": "SV-104155r1_rule",
        "stig_id": "ESXI-65-000061",
        "fix_id": "F-100317r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \"Promiscuous Mode\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"Promiscuous Mode\" policy is set to accept, this is a finding.",
        "fix": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \"Promiscuous Mode\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuous\n$false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy\n-AllowPromiscuousInherited $true"
      },
      "code": "control \"V-94069\" do\n  title \"The virtual switch Promiscuous Mode policy must be set to reject on\nthe ESXi host.\"\n  desc  \"When promiscuous mode is enabled for a virtual switch all virtual\nmachines connected to the Portgroup have the potential of reading all packets\nacross that network, meaning only the virtual machines connected to that\nPortgroup. Promiscuous mode is disabled by default on the ESXi Server, and this\nis the recommended setting. Promiscous mode can be set at the vSwitch and/or\nthe Portgroup level. You can override switch level settings at the Portgroup\nlevel.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94069\"\n  tag \"rid\": \"SV-104155r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000061\"\n  tag \"fix_id\": \"F-100317r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \\\"Promiscuous Mode\\\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \\\"Promiscuous Mode\\\" policy is set to accept, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \\\"Promiscuous Mode\\\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuous\n$false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy\n-AllowPromiscuousInherited $true\"\n\ncommand1 = 'Get-VirtualSwitch | Get-SecurityPolicy | Select AllowPromiscuous -ExpandProperty AllowPromiscuous'\ndescribe powercli_command(command1) do\n  its('stdout.strip') { should_not match \"False\" }\nend\n\ncommand2 = 'Get-VirtualPortGroup | Get-SecurityPolicy | Select AllowPromiscuousInherited -ExpandProperty AllowPromiscuousInherited'\ndescribe powercli_command(command2) do\n  its('stdout.strip') { should match \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94069.rb",
        "line": 1
      },
      "id": "V-94069"
    },
    {
      "title": "The ESXi host must enable a persistent log location for all locally\nstored logs.",
      "desc": "ESXi can be configured to store log files on an in-memory file system.\n This occurs when the host's \"/scratch\" directory is linked to\n\"/tmp/scratch\". When this is done only a single day's worth of logs are\nstored at any time. In addition log files will be reinitialized upon each\nreboot.  This presents a security risk as user activity logged on the host is\nonly stored temporarily and will not persistent across reboots.  This can also\ncomplicate auditing and make it harder to monitor events and diagnose issues.\nESXi host logging should always be configured to a persistent datastore.\n\n    Note: Scratch space is configured automatically during installation or\nfirst boot of an ESXi host, and does not usually need to be manually\nconfigured. ESXi Installable creates a 4 GB Fat16 partition on the target\ndevice during installation if there is sufficient space, and if the device is\nconsidered Local.  If ESXi is installed on an SD card or USB device a\npersistent log location may not be configured upon install as normal.",
      "descriptions": {
        "default": "ESXi can be configured to store log files on an in-memory file system.\n This occurs when the host's \"/scratch\" directory is linked to\n\"/tmp/scratch\". When this is done only a single day's worth of logs are\nstored at any time. In addition log files will be reinitialized upon each\nreboot.  This presents a security risk as user activity logged on the host is\nonly stored temporarily and will not persistent across reboots.  This can also\ncomplicate auditing and make it harder to monitor events and diagnose issues.\nESXi host logging should always be configured to a persistent datastore.\n\n    Note: Scratch space is configured automatically during installation or\nfirst boot of an ESXi host, and does not usually need to be manually\nconfigured. ESXi Installable creates a 4 GB Fat16 partition on the target\ndevice during installation if there is sufficient space, and if the device is\nconsidered Local.  If ESXi is installed on an SD card or USB device a\npersistent log location may not be configured upon install as normal."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000341-VMM-001220",
        "gid": "V-94037",
        "rid": "SV-104123r1_rule",
        "stig_id": "ESXI-65-000045",
        "fix_id": "F-100285r1_fix",
        "cci": [
          "CCI-001849"
        ],
        "nist": [
          "AU-4",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nSyslog.global.logDir value and verify it is set to a persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logDir\n\nor\n\n$esxcli = Get-EsxCli\n$esxcli.system.syslog.config.get() | Select\nLocalLogOutput,LocalLogOutputIsPersistent\n\nIf the Syslog.global.logDir or LocalLogOutput value is not on persistent\nstorage, this is a finding.\n\nIf the LocalLogOutputIsPersistent value is not true, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSyslog.global.logDir value and set it to a known persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logDir |\nSet-AdvancedSetting -Value \"New Log Location\""
      },
      "code": "control \"V-94037\" do\n  title \"The ESXi host must enable a persistent log location for all locally\nstored logs.\"\n  desc  \"ESXi can be configured to store log files on an in-memory file system.\n This occurs when the host's \\\"/scratch\\\" directory is linked to\n\\\"/tmp/scratch\\\". When this is done only a single day's worth of logs are\nstored at any time. In addition log files will be reinitialized upon each\nreboot.  This presents a security risk as user activity logged on the host is\nonly stored temporarily and will not persistent across reboots.  This can also\ncomplicate auditing and make it harder to monitor events and diagnose issues.\nESXi host logging should always be configured to a persistent datastore.\n\n    Note: Scratch space is configured automatically during installation or\nfirst boot of an ESXi host, and does not usually need to be manually\nconfigured. ESXi Installable creates a 4 GB Fat16 partition on the target\ndevice during installation if there is sufficient space, and if the device is\nconsidered Local.  If ESXi is installed on an SD card or USB device a\npersistent log location may not be configured upon install as normal.\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000341-VMM-001220\"\n  tag \"gid\": \"V-94037\"\n  tag \"rid\": \"SV-104123r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000045\"\n  tag \"fix_id\": \"F-100285r1_fix\"\n  tag \"cci\": [\"CCI-001849\"]\n  tag \"nist\": [\"AU-4\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nSyslog.global.logDir value and verify it is set to a persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logDir\n\nor\n\n$esxcli = Get-EsxCli\n$esxcli.system.syslog.config.get() | Select\nLocalLogOutput,LocalLogOutputIsPersistent\n\nIf the Syslog.global.logDir or LocalLogOutput value is not on persistent\nstorage, this is a finding.\n\nIf the LocalLogOutputIsPersistent value is not true, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSyslog.global.logDir value and set it to a known persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logDir |\nSet-AdvancedSetting -Value \\\"New Log Location\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94037.rb",
        "line": 1
      },
      "id": "V-94037"
    },
    {
      "title": "The ESXi Image Profile and VIB Acceptance Levels must be verified.",
      "desc": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
      "descriptions": {
        "default": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000366-VMM-001430",
        "gid": "V-94041",
        "rid": "SV-104127r1_rule",
        "stig_id": "ESXI-65-000047",
        "fix_id": "F-100289r1_fix",
        "cci": [
          "CCI-001749"
        ],
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under \"Host Image Profile Acceptance\nLevel\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is CommunitySupported, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under \"Host Image Profile Acceptance\nLevel\" click Edit… and use the pull-down selection, set the acceptance level\nto be VMwareCertified, VMwareAccepted, or PartnerSupported.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\"PartnerSupported\")\n\nNote: VMwareCertified or VMwareAccepted may be substituted for\nPartnerSupported, depending upon local requirements."
      },
      "code": "control \"V-94041\" do\n  title \"The ESXi Image Profile and VIB Acceptance Levels must be verified.\"\n  desc  \"Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.\n  \"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000366-VMM-001430\"\n  tag \"gid\": \"V-94041\"\n  tag \"rid\": \"SV-104127r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000047\"\n  tag \"fix_id\": \"F-100289r1_fix\"\n  tag \"cci\": [\"CCI-001749\"]\n  tag \"nist\": [\"CM-5 (3)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under \\\"Host Image Profile Acceptance\nLevel\\\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is CommunitySupported, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Under \\\"Host Image Profile Acceptance\nLevel\\\" click Edit… and use the pull-down selection, set the acceptance level\nto be VMwareCertified, VMwareAccepted, or PartnerSupported.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\\\"PartnerSupported\\\")\n\nNote: VMwareCertified or VMwareAccepted may be substituted for\nPartnerSupported, depending upon local requirements.\"\n\ncommand = '$esxcli = Get-EsxCli -WarningAction:Ignore;;$esxcli.software.acceptance.get()'\nLIST = \"VMwareCertified, VMwareAccepted, or PartnerSupported\"\ndescribe powercli_command(command) do\n  its('stdout.strip') { should be_in LIST }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94041.rb",
        "line": 1
      },
      "id": "V-94041"
    },
    {
      "title": "The virtual switch Forged Transmits policy must be set to reject on\nthe ESXi host.",
      "desc": "If the virtual machine operating system changes the MAC address, the\noperating system can send frames with an impersonated source MAC address at any\ntime. This allows an operating system to stage malicious attacks on the devices\nin a network by impersonating a network adaptor authorized by the receiving\nnetwork.\n\n    This means the virtual switch does not compare the source and effective MAC\naddresses.\n\n    To protect against MAC address impersonation, all virtual switches should\nhave forged transmissions set to Reject. Reject Forged Transmit can be set at\nthe vSwitch and/or the Portgroup level. You can override switch level settings\nat the Portgroup level.",
      "descriptions": {
        "default": "If the virtual machine operating system changes the MAC address, the\noperating system can send frames with an impersonated source MAC address at any\ntime. This allows an operating system to stage malicious attacks on the devices\nin a network by impersonating a network adaptor authorized by the receiving\nnetwork.\n\n    This means the virtual switch does not compare the source and effective MAC\naddresses.\n\n    To protect against MAC address impersonation, all virtual switches should\nhave forged transmissions set to Reject. Reject Forged Transmit can be set at\nthe vSwitch and/or the Portgroup level. You can override switch level settings\nat the Portgroup level."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94065",
        "rid": "SV-104151r1_rule",
        "stig_id": "ESXI-65-000059",
        "fix_id": "F-100313r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \"Forged Transmits\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"Forged Transmits\" policy is set to accept, this is a finding.",
        "fix": "From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \"Forged Transmits\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmits $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmitsInherited $true"
      },
      "code": "control \"V-94065\" do\n  title \"The virtual switch Forged Transmits policy must be set to reject on\nthe ESXi host.\"\n  desc  \"If the virtual machine operating system changes the MAC address, the\noperating system can send frames with an impersonated source MAC address at any\ntime. This allows an operating system to stage malicious attacks on the devices\nin a network by impersonating a network adaptor authorized by the receiving\nnetwork.\n\n    This means the virtual switch does not compare the source and effective MAC\naddresses.\n\n    To protect against MAC address impersonation, all virtual switches should\nhave forged transmissions set to Reject. Reject Forged Transmit can be set at\nthe vSwitch and/or the Portgroup level. You can override switch level settings\nat the Portgroup level.\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94065\"\n  tag \"rid\": \"SV-104151r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000059\"\n  tag \"fix_id\": \"F-100313r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. View the properties on each virtual switch and port group and\nverify \\\"Forged Transmits\\\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \\\"Forged Transmits\\\" policy is set to accept, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client go to Configure >> Networking >>\nVirtual Switches. For each virtual switch and port group click Edit settings\nand change \\\"Forged Transmits\\\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmits $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmitsInherited $true\"\n\ncommand1 = 'Get-VirtualSwitch | Get-SecurityPolicy | Select ForgedTransmits -ExpandProperty ForgedTransmits'\ndescribe powercli_command(command1) do\n  its('stdout.strip') { should_not match \"False\" }\nend\n\ncommand2 = 'Get-VirtualPortGroup | Get-SecurityPolicy | Select ForgedTransmits -ExpandProperty ForgedTransmits'\ndescribe powercli_command(command2) do\n  its('stdout.strip') { should match \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94065.rb",
        "line": 1
      },
      "id": "V-94065"
    },
    {
      "title": "The ESXi host must verify the exception users list for lockdown mode.",
      "desc": "In vSphere you can add users to the Exception Users list from the\nvSphere Web Client. These users do not lose their permissions when the host\nenters lockdown mode. Usually you may want to add service accounts such as a\nbackup agent to the Exception Users list. Verify that the list of users who are\nexempted from losing permissions is legitimate and as needed per your\nenvironment. Users who do not require special permissions should not be\nexempted from lockdown mode.",
      "descriptions": {
        "default": "In vSphere you can add users to the Exception Users list from the\nvSphere Web Client. These users do not lose their permissions when the host\nenters lockdown mode. Usually you may want to add service accounts such as a\nbackup agent to the Exception Users list. Verify that the list of users who are\nexempted from losing permissions is legitimate and as needed per your\nenvironment. Users who do not require special permissions should not be\nexempted from lockdown mode."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93953",
        "rid": "SV-104039r1_rule",
        "stig_id": "ESXI-65-000003",
        "fix_id": "F-100201r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under lockdown mode review the\nexception users list.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing script:\n\n$vmhost = Get-VMHost | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.QueryLockdownExceptions()\n\nIf the Exception users list contains accounts that do not require special\npermissions, this is a finding.\n\nNote - This list is not intended for system administrator accounts but for\nspecial circumstances such as a service account.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under lockdown mode click Edit and\nremove unnecessary users to the exceptions list."
      },
      "code": "control \"V-93953\" do\n  title \"The ESXi host must verify the exception users list for lockdown mode.\"\n  desc  \"In vSphere you can add users to the Exception Users list from the\nvSphere Web Client. These users do not lose their permissions when the host\nenters lockdown mode. Usually you may want to add service accounts such as a\nbackup agent to the Exception Users list. Verify that the list of users who are\nexempted from losing permissions is legitimate and as needed per your\nenvironment. Users who do not require special permissions should not be\nexempted from lockdown mode.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93953\"\n  tag \"rid\": \"SV-104039r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000003\"\n  tag \"fix_id\": \"F-100201r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under lockdown mode review the\nexception users list.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing script:\n\n$vmhost = Get-VMHost | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.QueryLockdownExceptions()\n\nIf the Exception users list contains accounts that do not require special\npermissions, this is a finding.\n\nNote - This list is not intended for system administrator accounts but for\nspecial circumstances such as a service account.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Under lockdown mode click Edit and\nremove unnecessary users to the exceptions list.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93953.rb",
        "line": 1
      },
      "id": "V-93953"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by using Active\nDirectory for local user authentication.",
      "desc": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.",
      "descriptions": {
        "default": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000113-VMM-000570",
        "gid": "V-94543",
        "rid": "SV-104373r1_rule",
        "stig_id": "ESXI-65-300037",
        "fix_id": "F-100659r1_fix",
        "cci": [
          "CCI-001942"
        ],
        "nist": [
          "IA-2 (9)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \"Directory Services Type\" is set to\n\"Active Directory\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf the \"Directory Services Type\" is not set to \"Active Directory\", this is\na finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \"Properties\" and change the\n\"Directory Service Type\" to \"Active Directory\", enter the domain to join,\ncheck \"Use vSphere Authentication Proxy\" and enter the proxy server address\nthen click \"Join Domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \"domain name\" -User \"username\" -Password \"password\""
      },
      "code": "control \"V-94543\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by using Active\nDirectory for local user authentication.\"\n  desc  \"Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \\\"ESX Admins\\\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000113-VMM-000570\"\n  tag \"gid\": \"V-94543\"\n  tag \"rid\": \"SV-104373r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300037\"\n  tag \"fix_id\": \"F-100659r1_fix\"\n  tag \"cci\": [\"CCI-001942\"]\n  tag \"nist\": [\"IA-2 (9)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Verify the \\\"Directory Services Type\\\" is set to\n\\\"Active Directory\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf the \\\"Directory Services Type\\\" is not set to \\\"Active Directory\\\", this is\na finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Authentication Services.  Click \\\"Properties\\\" and change the\n\\\"Directory Service Type\\\" to \\\"Active Directory\\\", enter the domain to join,\ncheck \\\"Use vSphere Authentication Proxy\\\" and enter the proxy server address\nthen click \\\"Join Domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \\\"domain name\\\" -User \\\"username\\\" -Password \\\"password\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94543.rb",
        "line": 1
      },
      "id": "V-94543"
    },
    {
      "title": "The ESXi host SSH daemon must not permit Kerberos authentication.",
      "desc": "Kerberos authentication for SSH is often implemented using GSSAPI.  If\nKerberos is enabled through SSH, the SSH daemon provides a means of access to\nthe system's Kerberos implementation.  Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation.  To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled for systems.",
      "descriptions": {
        "default": "Kerberos authentication for SSH is often implemented using GSSAPI.  If\nKerberos is enabled through SSH, the SSH daemon provides a means of access to\nthe system's Kerberos implementation.  Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation.  To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled for systems."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93985",
        "rid": "SV-104071r1_rule",
        "stig_id": "ESXI-65-000019",
        "fix_id": "F-100233r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^KerberosAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"KerberosAuthentication\nno\", this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nKerberosAuthentication no"
      },
      "code": "control \"V-93985\" do\n  title \"The ESXi host SSH daemon must not permit Kerberos authentication.\"\n  desc  \"Kerberos authentication for SSH is often implemented using GSSAPI.  If\nKerberos is enabled through SSH, the SSH daemon provides a means of access to\nthe system's Kerberos implementation.  Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation.  To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled for systems.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93985\"\n  tag \"rid\": \"SV-104071r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000019\"\n  tag \"fix_id\": \"F-100233r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^KerberosAuthentication\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"KerberosAuthentication\nno\\\", this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nKerberosAuthentication no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93985.rb",
        "line": 1
      },
      "id": "V-93985"
    },
    {
      "title": "For the ESXi host all port groups must not be configured to VLAN\nvalues reserved by upstream physical switches.",
      "desc": "Certain physical switches reserve certain VLAN IDs for internal\npurposes and often disallow traffic configured to these values. For example,\nCisco Catalyst switches typically reserve VLANs 1001–1024 and 4094, while Nexus\nswitches typically reserve 3968–4047 and 4094. Check with the documentation for\nyour specific switch. Using a reserved VLAN might result in a denial of service\non the network.",
      "descriptions": {
        "default": "Certain physical switches reserve certain VLAN IDs for internal\npurposes and often disallow traffic configured to these values. For example,\nCisco Catalyst switches typically reserve VLANs 1001–1024 and 4094, while Nexus\nswitches typically reserve 3968–4047 and 4094. Check with the documentation for\nyour specific switch. Using a reserved VLAN might result in a denial of service\non the network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94077",
        "rid": "SV-104163r1_rule",
        "stig_id": "ESXI-65-000065",
        "fix_id": "F-100325r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to 4095) and click Edit settings (pencil). Change the VLAN ID to not be\na reserved VLAN ID and click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId\n\"New VLAN#\""
      },
      "code": "control \"V-94077\" do\n  title \"For the ESXi host all port groups must not be configured to VLAN\nvalues reserved by upstream physical switches.\"\n  desc  \"Certain physical switches reserve certain VLAN IDs for internal\npurposes and often disallow traffic configured to these values. For example,\nCisco Catalyst switches typically reserve VLANs 1001–1024 and 4094, while Nexus\nswitches typically reserve 3968–4047 and 4094. Check with the documentation for\nyour specific switch. Using a reserved VLAN might result in a denial of service\non the network.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94077\"\n  tag \"rid\": \"SV-104163r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000065\"\n  tag \"fix_id\": \"F-100325r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to 4095) and click Edit settings (pencil). Change the VLAN ID to not be\na reserved VLAN ID and click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \\\"portgroup name\\\" | Set-VirtualPortGroup -VLanId\n\\\"New VLAN#\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94077.rb",
        "line": 1
      },
      "id": "V-94077"
    },
    {
      "title": "The ESXi host must prevent unintended use of the dvFilter network\nAPIs.",
      "desc": "If you are not using products that make use of the dvfilter network\nAPI, the host should not be configured to send network information to a VM. If\nthe API is enabled an attacker might attempt to connect a VM to it thereby\npotentially providing access to the network of other VMs on the host. If you\nare using a product that makes use of this API then verify that the host has\nbeen configured correctly. If you are not using such a product make sure the\nsetting is blank.",
      "descriptions": {
        "default": "If you are not using products that make use of the dvfilter network\nAPI, the host should not be configured to send network information to a VM. If\nthe API is enabled an attacker might attempt to connect a VM to it thereby\npotentially providing access to the network of other VMs on the host. If you\nare using a product that makes use of this API then verify that the host has\nbeen configured correctly. If you are not using such a product make sure the\nsetting is blank."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94071",
        "rid": "SV-104157r1_rule",
        "stig_id": "ESXI-65-000062",
        "fix_id": "F-100319r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nNet.DVFilterBindIpAddress value and verify the value is blank or the correct IP\naddress of a security appliance if in use.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress\n\nIf the Net.DVFilterBindIpAddress is not blank and security appliances are not\nin use on the host, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nNet.DVFilterBindIpAddress value and remove any incorrect addresses.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress |\nSet-AdvancedSetting -Value \"\""
      },
      "code": "control \"V-94071\" do\n  title \"The ESXi host must prevent unintended use of the dvFilter network\nAPIs.\"\n  desc  \"If you are not using products that make use of the dvfilter network\nAPI, the host should not be configured to send network information to a VM. If\nthe API is enabled an attacker might attempt to connect a VM to it thereby\npotentially providing access to the network of other VMs on the host. If you\nare using a product that makes use of this API then verify that the host has\nbeen configured correctly. If you are not using such a product make sure the\nsetting is blank.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94071\"\n  tag \"rid\": \"SV-104157r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000062\"\n  tag \"fix_id\": \"F-100319r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nNet.DVFilterBindIpAddress value and verify the value is blank or the correct IP\naddress of a security appliance if in use.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress\n\nIf the Net.DVFilterBindIpAddress is not blank and security appliances are not\nin use on the host, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nNet.DVFilterBindIpAddress value and remove any incorrect addresses.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress |\nSet-AdvancedSetting -Value \\\"\\\"\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match \"\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94071.rb",
        "line": 1
      },
      "id": "V-94071"
    },
    {
      "title": "The ESXi host must require the change of at least 8 of the total\nnumber of characters when passwords are changed.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000072-VMM-000390",
        "gid": "V-94541",
        "rid": "SV-104371r1_rule",
        "stig_id": "ESXI-65-300031",
        "fix_id": "F-100657r1_fix",
        "cci": [
          "CCI-000195"
        ],
        "nist": [
          "IA-5 (1) (b)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and verify it is set to\n\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" value is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94541\" do\n  title \"The ESXi host must require the change of at least 8 of the total\nnumber of characters when passwords are changed.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000072-VMM-000390\"\n  tag \"gid\": \"V-94541\"\n  tag \"rid\": \"SV-104371r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300031\"\n  tag \"fix_id\": \"F-100657r1_fix\"\n  tag \"cci\": [\"CCI-000195\"]\n  tag \"nist\": [\"IA-5 (1) (b)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and verify it is set to\n\\\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \\\"Security.PasswordQualityControl\\\" value is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94541.rb",
        "line": 1
      },
      "id": "V-94541"
    },
    {
      "title": "All ESXi host-connected virtual switch VLANs must be fully documented\nand have only the required VLANs.",
      "desc": "When defining a physical switch port for trunk mode, only specified\nVLANs must be configured on the VLAN trunk link. The risk with not fully\ndocumenting all VLANs on the vSwitch is that it is possible that a physical\ntrunk port might be configured without needed VLANs, or with unneeded VLANs,\npotentially enabling an administrator to either accidentally or maliciously\nconnect a VM to an unauthorized VLAN.",
      "descriptions": {
        "default": "When defining a physical switch port for trunk mode, only specified\nVLANs must be configured on the VLAN trunk link. The risk with not fully\ndocumenting all VLANs on the vSwitch is that it is possible that a physical\ntrunk port might be configured without needed VLANs, or with unneeded VLANs,\npotentially enabling an administrator to either accidentally or maliciously\nconnect a VM to an unauthorized VLAN."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94083",
        "rid": "SV-104169r1_rule",
        "stig_id": "ESXI-65-000068",
        "fix_id": "F-100331r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of upstream physical\nswitches must be documented to ensure that unneeded VLANs are configured for\nall physical ports connected to ESXi hosts. Inspect the documentation and\nverify that the documentation is updated on an organization defined frequency\nand/or whenever modifications are made to either ESXi hosts or the upstream\nphysical switches. Alternatively, log in to the physical switch and verify that\nonly needed VLANs are configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's configuration is trunked VLANs that are not used by\nESXi for all physical ports connected to ESXi hosts, this is a finding.",
        "fix": "Note that this check refers to an entity outside the scope of the\nESXi server system.\n\nRemove any VLANs trunked across physical ports connected to ESXi hosts that are\nnot in use."
      },
      "code": "control \"V-94083\" do\n  title \"All ESXi host-connected virtual switch VLANs must be fully documented\nand have only the required VLANs.\"\n  desc  \"When defining a physical switch port for trunk mode, only specified\nVLANs must be configured on the VLAN trunk link. The risk with not fully\ndocumenting all VLANs on the vSwitch is that it is possible that a physical\ntrunk port might be configured without needed VLANs, or with unneeded VLANs,\npotentially enabling an administrator to either accidentally or maliciously\nconnect a VM to an unauthorized VLAN.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94083\"\n  tag \"rid\": \"SV-104169r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000068\"\n  tag \"fix_id\": \"F-100331r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of upstream physical\nswitches must be documented to ensure that unneeded VLANs are configured for\nall physical ports connected to ESXi hosts. Inspect the documentation and\nverify that the documentation is updated on an organization defined frequency\nand/or whenever modifications are made to either ESXi hosts or the upstream\nphysical switches. Alternatively, log in to the physical switch and verify that\nonly needed VLANs are configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's configuration is trunked VLANs that are not used by\nESXi for all physical ports connected to ESXi hosts, this is a finding.\"\n  tag \"fix\": \"Note that this check refers to an entity outside the scope of the\nESXi server system.\n\nRemove any VLANs trunked across physical ports connected to ESXi hosts that are\nnot in use.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94083.rb",
        "line": 1
      },
      "id": "V-94083"
    },
    {
      "title": "The ESXi host must enable kernel core dumps.",
      "desc": "In the event of a system failure, the system must preserve any\ninformation necessary to determine cause of failure and any information\nnecessary to return to operations with least disruption to mission processes.",
      "descriptions": {
        "default": "In the event of a system failure, the system must preserve any\ninformation necessary to determine cause of failure and any information\nnecessary to return to operations with least disruption to mission processes."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000269-VMM-000950",
        "gid": "V-94035",
        "rid": "SV-104121r1_rule",
        "stig_id": "ESXI-65-000044",
        "fix_id": "F-100283r1_fix",
        "cci": [
          "CCI-001665"
        ],
        "nist": [
          "SC-24",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and right\nclick.  If the \"Add Diagnostic Partition\" option is greyed out then core\ndumps are configured.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.system.coredump.partition.get()\n$esxcli.system.coredump.network.get()\n\nThe first command prepares for the other two. The second command shows whether\nthere is an active core dump partition configured. The third command shows\nwhether a network core dump collector is configured and enabled, via the\n\"HostVNic\", \"NetworkServerIP\", \"NetworkServerPort\", and \"Enabled\"\nvariables.\n\nIf there is no active core dump partition or the network core dump collector is\nnot configured and enabled, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and right click.\nSelect the \"Add Diagnostic Partition\" option configure a core dump diagnostic\npartition.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run at least\none of the following sets of commands:\n\nTo configure a core dump partition:\n\n$esxcli = Get-EsxCli\n#View available partitions to configure\n$esxcli.system.coredump.partition.list()\n$esxcli.system.coredump.partition.set($null,\"PartitionName\",$null,$null)\n\nTo configure a core dump collector:\n\n$esxcli = Get-EsxCli\n$esxcli.system.coredump.network.set($null,\"vmkernel port to\nuse\",$null,\"CollectorIP\",\"CollectorPort\")\n$esxcli.system.coredump.network.set($true)"
      },
      "code": "control \"V-94035\" do\n  title \"The ESXi host must enable kernel core dumps.\"\n  desc  \"In the event of a system failure, the system must preserve any\ninformation necessary to determine cause of failure and any information\nnecessary to return to operations with least disruption to mission processes.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000269-VMM-000950\"\n  tag \"gid\": \"V-94035\"\n  tag \"rid\": \"SV-104121r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000044\"\n  tag \"fix_id\": \"F-100283r1_fix\"\n  tag \"cci\": [\"CCI-001665\"]\n  tag \"nist\": [\"SC-24\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and right\nclick.  If the \\\"Add Diagnostic Partition\\\" option is greyed out then core\ndumps are configured.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.system.coredump.partition.get()\n$esxcli.system.coredump.network.get()\n\nThe first command prepares for the other two. The second command shows whether\nthere is an active core dump partition configured. The third command shows\nwhether a network core dump collector is configured and enabled, via the\n\\\"HostVNic\\\", \\\"NetworkServerIP\\\", \\\"NetworkServerPort\\\", and \\\"Enabled\\\"\nvariables.\n\nIf there is no active core dump partition or the network core dump collector is\nnot configured and enabled, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and right click.\nSelect the \\\"Add Diagnostic Partition\\\" option configure a core dump diagnostic\npartition.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run at least\none of the following sets of commands:\n\nTo configure a core dump partition:\n\n$esxcli = Get-EsxCli\n#View available partitions to configure\n$esxcli.system.coredump.partition.list()\n$esxcli.system.coredump.partition.set($null,\\\"PartitionName\\\",$null,$null)\n\nTo configure a core dump collector:\n\n$esxcli = Get-EsxCli\n$esxcli.system.coredump.network.set($null,\\\"vmkernel port to\nuse\\\",$null,\\\"CollectorIP\\\",\\\"CollectorPort\\\")\n$esxcli.system.coredump.network.set($true)\"\n\ncommand1 = '$esxcli = Get-EsxCli -WarningAction:Ignore;$esxcli.system.coredump.partition.get().Active'\ndescribe powercli_command(command1) do\n  its('stdout.strip') { should_not eq \"\" }\nend\n\n#command2 = '$esxcli = Get-EsxCli -WarningAction:Ignore;$esxcli.system.coredump.network.get().Active'\n#describe powercli_command(command2) do\n#  its('stdout.strip') { should eq \"600\" }\n#end\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94035.rb",
        "line": 1
      },
      "id": "V-94035"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by restricting use of\nActive Directory ESX Admin group membership.",
      "desc": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group.",
      "descriptions": {
        "default": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000112-VMM-000560",
        "gid": "V-94533",
        "rid": "SV-104363r1_rule",
        "stig_id": "ESXI-65-200039",
        "fix_id": "F-100649r1_fix",
        "cci": [
          "CCI-001941"
        ],
        "nist": [
          "IA-2 (8)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and verify it is NOT\nset to \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value is set to\n\"ESX Admins\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and configure it to\nan Active Directory group other than \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>"
      },
      "code": "control \"V-94533\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to privileged accounts by restricting use of\nActive Directory ESX Admin group membership.\"\n  desc  \"When adding ESXi hosts to Active Directory, if the group \\\"ESX\nAdmins\\\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \\\"ESX Admins\\\" group.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000112-VMM-000560\"\n  tag \"gid\": \"V-94533\"\n  tag \"rid\": \"SV-104363r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200039\"\n  tag \"fix_id\": \"F-100649r1_fix\"\n  tag \"cci\": [\"CCI-001941\"]\n  tag \"nist\": [\"IA-2 (8)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and verify it is NOT\nset to \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf the \\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value is set to\n\\\"ESX Admins\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and configure it to\nan Active Directory group other than \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94533.rb",
        "line": 1
      },
      "id": "V-94533"
    },
    {
      "title": "The ESXi host must enforce the limit of three consecutive invalid\nlogon attempts by a user.",
      "desc": "By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account.",
      "descriptions": {
        "default": "By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000021-VMM-000050",
        "gid": "V-93957",
        "rid": "SV-104043r1_rule",
        "stig_id": "ESXI-65-000005",
        "fix_id": "F-100205r1_fix",
        "cci": [
          "CCI-000044"
        ],
        "nist": [
          "AC-7 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSecurity.AccountLockFailures value and verify it is set to 3.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures and verify\nit is set to 3.\n\nIf the Security.AccountLockFailures is set to a value other than 3, this is a\nfinding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.AccountLockFailures value and configure it to 3.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures |\nSet-AdvancedSetting -Value 3"
      },
      "code": "control \"V-93957\" do\n  title \"The ESXi host must enforce the limit of three consecutive invalid\nlogon attempts by a user.\"\n  desc  \"By limiting the number of failed login attempts, the risk of\nunauthorized access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000021-VMM-000050\"\n  tag \"gid\": \"V-93957\"\n  tag \"rid\": \"SV-104043r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000005\"\n  tag \"fix_id\": \"F-100205r1_fix\"\n  tag \"cci\": [\"CCI-000044\"]\n  tag \"nist\": [\"AC-7 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSecurity.AccountLockFailures value and verify it is set to 3.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures and verify\nit is set to 3.\n\nIf the Security.AccountLockFailures is set to a value other than 3, this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSecurity.AccountLockFailures value and configure it to 3.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures |\nSet-AdvancedSetting -Value 3\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should eq 3 }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93957.rb",
        "line": 1
      },
      "id": "V-93957"
    },
    {
      "title": "The ESXi host SSH daemon must limit connections to a single session.",
      "desc": "The SSH protocol has the ability to provide multiple sessions over a\nsingle connection without reauthentication. A compromised client could use this\nfeature to establish additional sessions to a system without consent or\nknowledge of the user.",
      "descriptions": {
        "default": "The SSH protocol has the ability to provide multiple sessions over a\nsingle connection without reauthentication. A compromised client could use this\nfeature to establish additional sessions to a system without consent or\nknowledge of the user."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94003",
        "rid": "SV-104089r1_rule",
        "stig_id": "ESXI-65-000028",
        "fix_id": "F-100251r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^MaxSessions\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"MaxSessions 1\", this is a\nfinding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nMaxSessions 1"
      },
      "code": "control \"V-94003\" do\n  title \"The ESXi host SSH daemon must limit connections to a single session.\"\n  desc  \"The SSH protocol has the ability to provide multiple sessions over a\nsingle connection without reauthentication. A compromised client could use this\nfeature to establish additional sessions to a system without consent or\nknowledge of the user.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94003\"\n  tag \"rid\": \"SV-104089r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000028\"\n  tag \"fix_id\": \"F-100251r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^MaxSessions\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"MaxSessions 1\\\", this is a\nfinding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nMaxSessions 1\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94003.rb",
        "line": 1
      },
      "id": "V-94003"
    },
    {
      "title": "The ESXi host SSH daemon must not allow host-based authentication.",
      "desc": "SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH's cryptographic host-based\nauthentication is more secure than \".rhosts\" authentication, since hosts are\ncryptographically authenticated. However, it is not recommended that hosts\nunilaterally trust one another, even within an organization.",
      "descriptions": {
        "default": "SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH's cryptographic host-based\nauthentication is more secure than \".rhosts\" authentication, since hosts are\ncryptographically authenticated. However, it is not recommended that hosts\nunilaterally trust one another, even within an organization."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93973",
        "rid": "SV-104059r1_rule",
        "stig_id": "ESXI-65-000013",
        "fix_id": "F-100221r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^HostbasedAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"HostbasedAuthentication\nno\", this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\":\n\nHostbasedAuthentication no"
      },
      "code": "control \"V-93973\" do\n  title \"The ESXi host SSH daemon must not allow host-based authentication.\"\n  desc  \"SSH trust relationships mean a compromise on one host can allow an\nattacker to move trivially to other hosts. SSH's cryptographic host-based\nauthentication is more secure than \\\".rhosts\\\" authentication, since hosts are\ncryptographically authenticated. However, it is not recommended that hosts\nunilaterally trust one another, even within an organization.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93973\"\n  tag \"rid\": \"SV-104059r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000013\"\n  tag \"fix_id\": \"F-100221r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^HostbasedAuthentication\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"HostbasedAuthentication\nno\\\", this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nAdd or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nHostbasedAuthentication no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93973.rb",
        "line": 1
      },
      "id": "V-93973"
    },
    {
      "title": "For physical switch ports connected to the ESXi host, the\nnon-negotiate option must be configured for trunk links between external\nphysical switches and virtual switches in VST mode.",
      "desc": "In order to communicate with virtual switches in VST mode, external\nswitch ports must be configured as trunk ports. VST mode does not support\nDynamic Trunking Protocol (DTP), so the trunk must be static and unconditional.\nThe auto or desirable physical switch settings do not work with the ESXi Server\nbecause the physical switch communicates with the ESXi Server using DTP. The\nnon-negotiate and on options unconditionally enable VLAN trunking on the\nphysical switch and create a VLAN trunk link between the ESXi Server and the\nphysical switch. The difference between non-negotiate and on options is that on\nmode still sends out DTP frames, whereas the non-negotiate option does not.\nThe non-negotiate option should be used for all VLAN trunks, to minimize\nunnecessary network traffic for virtual switches in VST mode.",
      "descriptions": {
        "default": "In order to communicate with virtual switches in VST mode, external\nswitch ports must be configured as trunk ports. VST mode does not support\nDynamic Trunking Protocol (DTP), so the trunk must be static and unconditional.\nThe auto or desirable physical switch settings do not work with the ESXi Server\nbecause the physical switch communicates with the ESXi Server using DTP. The\nnon-negotiate and on options unconditionally enable VLAN trunking on the\nphysical switch and create a VLAN trunk link between the ESXi Server and the\nphysical switch. The difference between non-negotiate and on options is that on\nmode still sends out DTP frames, whereas the non-negotiate option does not.\nThe non-negotiate option should be used for all VLAN trunks, to minimize\nunnecessary network traffic for virtual switches in VST mode."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94079",
        "rid": "SV-104165r1_rule",
        "stig_id": "ESXI-65-000066",
        "fix_id": "F-100327r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of external switch ports as\ntrunk ports must be documented. Virtual Switch Tagging (VST) mode does not\nsupport Dynamic Trunking Protocol (DTP), so the trunk must be static and\nunconditional. Inspect the documentation and verify that the documentation is\ncorrect and updated on an organization defined frequency and/or whenever\nmodifications are made to either ESXi hosts or the upstream external switch\nports.\n\nIf DTP is enabled on the physical switch ports connected to the ESXi Host, this\nis a finding.",
        "fix": "Note that this check refers to an entity outside the physical\nscope of the ESXi server system. Document the configuration of external switch\nports as trunk ports. Log in to the vendor-specific physical switch and disable\nDTP on the physical switch ports connected to the ESXi Host. Update the\ndocumentation on an organization defined frequency or whenever modifications\nare made to either ESXi hosts or the upstream external switch ports."
      },
      "code": "control \"V-94079\" do\n  title \"For physical switch ports connected to the ESXi host, the\nnon-negotiate option must be configured for trunk links between external\nphysical switches and virtual switches in VST mode.\"\n  desc  \"In order to communicate with virtual switches in VST mode, external\nswitch ports must be configured as trunk ports. VST mode does not support\nDynamic Trunking Protocol (DTP), so the trunk must be static and unconditional.\nThe auto or desirable physical switch settings do not work with the ESXi Server\nbecause the physical switch communicates with the ESXi Server using DTP. The\nnon-negotiate and on options unconditionally enable VLAN trunking on the\nphysical switch and create a VLAN trunk link between the ESXi Server and the\nphysical switch. The difference between non-negotiate and on options is that on\nmode still sends out DTP frames, whereas the non-negotiate option does not.\nThe non-negotiate option should be used for all VLAN trunks, to minimize\nunnecessary network traffic for virtual switches in VST mode.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94079\"\n  tag \"rid\": \"SV-104165r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000066\"\n  tag \"fix_id\": \"F-100327r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of external switch ports as\ntrunk ports must be documented. Virtual Switch Tagging (VST) mode does not\nsupport Dynamic Trunking Protocol (DTP), so the trunk must be static and\nunconditional. Inspect the documentation and verify that the documentation is\ncorrect and updated on an organization defined frequency and/or whenever\nmodifications are made to either ESXi hosts or the upstream external switch\nports.\n\nIf DTP is enabled on the physical switch ports connected to the ESXi Host, this\nis a finding.\"\n  tag \"fix\": \"Note that this check refers to an entity outside the physical\nscope of the ESXi server system. Document the configuration of external switch\nports as trunk ports. Log in to the vendor-specific physical switch and disable\nDTP on the physical switch ports connected to the ESXi Host. Update the\ndocumentation on an organization defined frequency or whenever modifications\nare made to either ESXi hosts or the upstream external switch ports.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94079.rb",
        "line": 1
      },
      "id": "V-94079"
    },
    {
      "title": "The ESXi host SSH daemon must be configured to not allow gateway\nports.",
      "desc": "SSH TCP connection forwarding provides a mechanism to establish TCP\nconnections proxied by the SSH server. This function can provide similar\nconvenience to a Virtual Private Network (VPN) with the similar risk of\nproviding a path to circumvent firewalls and network ACLs. Gateway ports allow\nremote forwarded ports to bind to non-loopback addresses on the server.",
      "descriptions": {
        "default": "SSH TCP connection forwarding provides a mechanism to establish TCP\nconnections proxied by the SSH server. This function can provide similar\nconvenience to a Virtual Private Network (VPN) with the similar risk of\nproviding a path to circumvent firewalls and network ACLs. Gateway ports allow\nremote forwarded ports to bind to non-loopback addresses on the server."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93991",
        "rid": "SV-104077r1_rule",
        "stig_id": "ESXI-65-000022",
        "fix_id": "F-100239r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^GatewayPorts\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"GatewayPorts no\", this is\na finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nGatewayPorts no"
      },
      "code": "control \"V-93991\" do\n  title \"The ESXi host SSH daemon must be configured to not allow gateway\nports.\"\n  desc  \"SSH TCP connection forwarding provides a mechanism to establish TCP\nconnections proxied by the SSH server. This function can provide similar\nconvenience to a Virtual Private Network (VPN) with the similar risk of\nproviding a path to circumvent firewalls and network ACLs. Gateway ports allow\nremote forwarded ports to bind to non-loopback addresses on the server.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93991\"\n  tag \"rid\": \"SV-104077r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000022\"\n  tag \"fix_id\": \"F-100239r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^GatewayPorts\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"GatewayPorts no\\\", this is\na finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nGatewayPorts no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93991.rb",
        "line": 1
      },
      "id": "V-93991"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by using the vSphere\nAuthentication Proxy.",
      "desc": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.",
      "descriptions": {
        "default": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000113-VMM-000570",
        "gid": "V-94545",
        "rid": "SV-104375r1_rule",
        "stig_id": "ESXI-65-300038",
        "fix_id": "F-100661r1_fix",
        "cci": [
          "CCI-001942"
        ],
        "nist": [
          "IA-2 (9)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Verify the method used to\njoin hosts to a domain is set to \"Use vSphere Authentication Proxy to add the\nhost to domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, `\n@{N=\"JoinADEnabled\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\"JoinDomainMethod\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\"JoinDomainMethodPolicy\"}).Policyoption.Id}}\n\nVerify if \"JoinADEnabled\" is \"True\" then \"JoinDomainMethod\" should be\n\"FixedCAMConfigOption\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.",
        "fix": "When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Set the method used to\njoin hosts to a domain to \"Use vSphere Authentication Proxy to add the host to\ndomain\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Click \"Properties\" and change the \"Directory\nService Type\" to \"Active Directory\", enter the domain to join, check \"Use\nvSphere Authentication Proxy\" and enter the proxy server address then click\n\"Join Domain\"."
      },
      "code": "control \"V-94545\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by using the vSphere\nAuthentication Proxy.\"\n  desc  \"If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000113-VMM-000570\"\n  tag \"gid\": \"V-94545\"\n  tag \"rid\": \"SV-104375r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300038\"\n  tag \"fix_id\": \"F-100661r1_fix\"\n  tag \"cci\": [\"CCI-001942\"]\n  tag \"nist\": [\"IA-2 (9)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Verify the method used to\njoin hosts to a domain is set to \\\"Use vSphere Authentication Proxy to add the\nhost to domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\\\"HostProfile\\\";E={$_ | Get-VMHostProfile}}, `\n@{N=\\\"JoinADEnabled\\\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\\\"JoinDomainMethod\\\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\\\"JoinDomainMethodPolicy\\\"}).Policyoption.Id}}\n\nVerify if \\\"JoinADEnabled\\\" is \\\"True\\\" then \\\"JoinDomainMethod\\\" should be\n\\\"FixedCAMConfigOption\\\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.\"\n  tag \"fix\": \"When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles >> and select a Host\nProfile to edit.  View the settings under Authentication Configuration >>\nActive Directory Configuration >> JoinDomainMethod.  Set the method used to\njoin hosts to a domain to \\\"Use vSphere Authentication Proxy to add the host to\ndomain\\\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAuthentication Services.  Click \\\"Properties\\\" and change the \\\"Directory\nService Type\\\" to \\\"Active Directory\\\", enter the domain to join, check \\\"Use\nvSphere Authentication Proxy\\\" and enter the proxy server address then click\n\\\"Join Domain\\\".\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94545.rb",
        "line": 1
      },
      "id": "V-94545"
    },
    {
      "title": "The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by restricting use of\nActive Directory ESX Admin group membership.",
      "desc": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group.",
      "descriptions": {
        "default": "When adding ESXi hosts to Active Directory, if the group \"ESX\nAdmins\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \"ESX Admins\" group."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000113-VMM-000570",
        "gid": "V-94547",
        "rid": "SV-104377r1_rule",
        "stig_id": "ESXI-65-300039",
        "fix_id": "F-100663r1_fix",
        "cci": [
          "CCI-001942"
        ],
        "nist": [
          "IA-2 (9)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and verify it is not\nset to \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value is set to\n\"ESX Admins\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and configure it to\nan Active Directory group other than \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>"
      },
      "code": "control \"V-94547\" do\n  title \"The ESXi host must implement replay-resistant authentication\nmechanisms for network access to non-privileged accounts by restricting use of\nActive Directory ESX Admin group membership.\"\n  desc  \"When adding ESXi hosts to Active Directory, if the group \\\"ESX\nAdmins\\\" exists, all user/group accounts assigned to the group will have full\nadministrative access to the host. Discretion should be used when managing\nmembership to the \\\"ESX Admins\\\" group.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000113-VMM-000570\"\n  tag \"gid\": \"V-94547\"\n  tag \"rid\": \"SV-104377r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300039\"\n  tag \"fix_id\": \"F-100663r1_fix\"\n  tag \"cci\": [\"CCI-001942\"]\n  tag \"nist\": [\"IA-2 (9)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than root and/or vpxuser, this is not applicable.\n\nFrom the vSphere Client select the ESXi host and go to Configuration >>\nAdvanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and verify it is not\nset to \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf the \\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value is set to\n\\\"ESX Admins\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\\\" value and configure it to\nan Active Directory group other than \\\"ESX Admins\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name\nConfig.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value\n<AD Group>\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94547.rb",
        "line": 1
      },
      "id": "V-94547"
    },
    {
      "title": "The ESXi host must configure NTP time synchronization.",
      "desc": "To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value.",
      "descriptions": {
        "default": "To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000355-VMM-001330",
        "gid": "V-94039",
        "rid": "SV-104125r1_rule",
        "stig_id": "ESXI-65-000046",
        "fix_id": "F-100287r1_fix",
        "cci": [
          "CCI-001891"
        ],
        "nist": [
          "AU-8 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Time Configuration. Click Edit to verify the configured\nNTP servers and service startup policy.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostNTPServer\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"}\n\nIf the NTP service is not configured with authoritative DoD time sources and\nthe service is not configured to start and stop with the host and is running,\nthis is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Time Configuration. Click Edit to configure the NTP\nservice to start and stop with the host and with authoritative DoD time sources.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$NTPServers = \"ntpserver1\",\"ntpserver2\"\nGet-VMHost | Add-VMHostNTPServer $NTPServers\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Set-VMHostService -Policy On\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Start-VMHostService"
      },
      "code": "control \"V-94039\" do\n  title \"The ESXi host must configure NTP time synchronization.\"\n  desc  \"To assure the accuracy of the system clock, it must be synchronized\nwith an authoritative time source within DoD. Many system functions, including\ntime-based login and activity restrictions, automated reports, system logs, and\naudit records depend on an accurate system clock. If there is no confidence in\nthe correctness of the system clock, time-based functions may not operate as\nintended and records may be of diminished value.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000355-VMM-001330\"\n  tag \"gid\": \"V-94039\"\n  tag \"rid\": \"SV-104125r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000046\"\n  tag \"fix_id\": \"F-100287r1_fix\"\n  tag \"cci\": [\"CCI-001891\"]\n  tag \"nist\": [\"AU-8 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Time Configuration. Click Edit to verify the configured\nNTP servers and service startup policy.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostNTPServer\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"}\n\nIf the NTP service is not configured with authoritative DoD time sources and\nthe service is not configured to start and stop with the host and is running,\nthis is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Time Configuration. Click Edit to configure the NTP\nservice to start and stop with the host and with authoritative DoD time sources.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\n$NTPServers = \\\"ntpserver1\\\",\\\"ntpserver2\\\"\nGet-VMHost | Add-VMHostNTPServer $NTPServers\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"} | Set-VMHostService -Policy On\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \\\"NTP Daemon\\\"} | Start-VMHostService\"\n\ncommand1 = 'Get-VMHost | Get-VMHostNTPServer'\ndescribe powercli_command(command1) do\n  its('stdout.strip') { should_not eq \"\" }\nend\n\ncommand2 = 'Get-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Select Policy -ExpandProperty Policy'\ndescribe powercli_command(command2) do\n  its('stdout.strip') { should eq \"on\" }\nend\n\ncommand3 = 'Get-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Select Running -ExpandProperty Running'\ndescribe powercli_command(command3) do\n  its('stdout.strip') { should eq \"True\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94039.rb",
        "line": 1
      },
      "id": "V-94039"
    },
    {
      "title": "The ESXi host SSH daemon must not allow authentication using an empty\npassword.",
      "desc": "Configuring this setting for the SSH daemon provides additional\nassurance that remote login via SSH will require a password, even in the event\nof misconfiguration elsewhere.",
      "descriptions": {
        "default": "Configuring this setting for the SSH daemon provides additional\nassurance that remote login via SSH will require a password, even in the event\nof misconfiguration elsewhere."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93977",
        "rid": "SV-104063r1_rule",
        "stig_id": "ESXI-65-000015",
        "fix_id": "F-100225r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^PermitEmptyPasswords\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitEmptyPasswords no\",\nthis is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitEmptyPasswords no"
      },
      "code": "control \"V-93977\" do\n  title \"The ESXi host SSH daemon must not allow authentication using an empty\npassword.\"\n  desc  \"Configuring this setting for the SSH daemon provides additional\nassurance that remote login via SSH will require a password, even in the event\nof misconfiguration elsewhere.\"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93977\"\n  tag \"rid\": \"SV-104063r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000015\"\n  tag \"fix_id\": \"F-100225r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^PermitEmptyPasswords\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"PermitEmptyPasswords no\\\",\nthis is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nPermitEmptyPasswords no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93977.rb",
        "line": 1
      },
      "id": "V-93977"
    },
    {
      "title": "The ESXi host must protect audit information from unauthorized\ndeletion by configuring remote logging.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000059-VMM-000280",
        "gid": "V-94539",
        "rid": "SV-104369r1_rule",
        "stig_id": "ESXI-65-300004",
        "fix_id": "F-100655r1_fix",
        "cci": [
          "CCI-000164"
        ],
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" value is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<insert syslog server hostname>\""
      },
      "code": "control \"V-94539\" do\n  title \"The ESXi host must protect audit information from unauthorized\ndeletion by configuring remote logging.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000059-VMM-000280\"\n  tag \"gid\": \"V-94539\"\n  tag \"rid\": \"SV-104369r1_rule\"\n  tag \"stig_id\": \"ESXI-65-300004\"\n  tag \"fix_id\": \"F-100655r1_fix\"\n  tag \"cci\": [\"CCI-000164\"]\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \\\"Syslog.global.logHost\\\" value is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<insert syslog server hostname>\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94539.rb",
        "line": 1
      },
      "id": "V-94539"
    },
    {
      "title": "The ESXi host must prohibit the reuse of passwords within five\niterations.",
      "desc": "If a user, or root, used the same password continuously or was allowed\nto change it back shortly after being forced to change it to something else, it\nwould provide a potential intruder with the opportunity to keep guessing at one\nuser's password until it was guessed correctly.",
      "descriptions": {
        "default": "If a user, or root, used the same password continuously or was allowed\nto change it back shortly after being forced to change it to something else, it\nwould provide a potential intruder with the opportunity to keep guessing at one\nuser's password until it was guessed correctly."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000077-VMM-000440",
        "gid": "V-94011",
        "rid": "SV-104097r1_rule",
        "stig_id": "ESXI-65-000032",
        "fix_id": "F-100259r1_fix",
        "cci": [
          "CCI-000200"
        ],
        "nist": [
          "IA-5 (1) (e)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^password\" /etc/pam.d/passwd | grep sufficient\n\nIf the remember setting is not set or is not \"remember=5\", this is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in “/etc/pam.d/passwd”:\n\npassword sufficient /lib/security/$ISA/pam_unix.so use_authtok nullok shadow\nsha512 remember=5"
      },
      "code": "control \"V-94011\" do\n  title \"The ESXi host must prohibit the reuse of passwords within five\niterations.\"\n  desc  \"If a user, or root, used the same password continuously or was allowed\nto change it back shortly after being forced to change it to something else, it\nwould provide a potential intruder with the opportunity to keep guessing at one\nuser's password until it was guessed correctly.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000077-VMM-000440\"\n  tag \"gid\": \"V-94011\"\n  tag \"rid\": \"SV-104097r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000032\"\n  tag \"fix_id\": \"F-100259r1_fix\"\n  tag \"cci\": [\"CCI-000200\"]\n  tag \"nist\": [\"IA-5 (1) (e)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^password\\\" /etc/pam.d/passwd | grep sufficient\n\nIf the remember setting is not set or is not \\\"remember=5\\\", this is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in “/etc/pam.d/passwd”:\n\npassword sufficient /lib/security/$ISA/pam_unix.so use_authtok nullok shadow\nsha512 remember=5\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94011.rb",
        "line": 1
      },
      "id": "V-94011"
    },
    {
      "title": "The ESXi host must protect the confidentiality and integrity of\ntransmitted information.",
      "desc": "From the vSphere Web Client select the ESXi Host and go to Configure\n>> Networking >> VMkernel adapters. Review each VMkernel adapter that is\ndefined and ensure it is enabled for only one type of management traffic.",
      "descriptions": {
        "default": "From the vSphere Web Client select the ESXi Host and go to Configure\n>> Networking >> VMkernel adapters. Review each VMkernel adapter that is\ndefined and ensure it is enabled for only one type of management traffic."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000423-VMM-001700",
        "gid": "V-94049",
        "rid": "SV-104135r1_rule",
        "stig_id": "ESXI-65-000049",
        "fix_id": "F-100297r1_fix",
        "cci": [
          "CCI-002418"
        ],
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nManage > Networking > VMkernel adapters.  Review each VMkernel adapter that is\ndefined and ensure it is enabled for only one type of management traffic.\n\nIf any VMkernel is used for more than one type of management traffic, this is a\nfinding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> VMkernel adapters >> Select a VMkernel Adapter >>\nClick Edit settings >> Uncheck any additional services that have been enabled\non the VMkernel adapter so that there is only one service left checked."
      },
      "code": "control \"V-94049\" do\n  title \"The ESXi host must protect the confidentiality and integrity of\ntransmitted information.\"\n  desc  \"From the vSphere Web Client select the ESXi Host and go to Configure\n>> Networking >> VMkernel adapters. Review each VMkernel adapter that is\ndefined and ensure it is enabled for only one type of management traffic.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000423-VMM-001700\"\n  tag \"gid\": \"V-94049\"\n  tag \"rid\": \"SV-104135r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000049\"\n  tag \"fix_id\": \"F-100297r1_fix\"\n  tag \"cci\": [\"CCI-002418\"]\n  tag \"nist\": [\"SC-8\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nManage > Networking > VMkernel adapters.  Review each VMkernel adapter that is\ndefined and ensure it is enabled for only one type of management traffic.\n\nIf any VMkernel is used for more than one type of management traffic, this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> VMkernel adapters >> Select a VMkernel Adapter >>\nClick Edit settings >> Uncheck any additional services that have been enabled\non the VMkernel adapter so that there is only one service left checked.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94049.rb",
        "line": 1
      },
      "id": "V-94049"
    },
    {
      "title": "The ESXi host must exclusively enable TLS 1.2 for the ioFilter, vSANVP\nand reverse proxy services.",
      "desc": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi",
      "descriptions": {
        "default": "TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94483",
        "rid": "SV-104313r1_rule",
        "stig_id": "ESXI-65-000074",
        "fix_id": "F-100599r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.ESXiVPsDisabledProtocols value and verify that it is set to the\nfollowing:\n\ntlsv1,tlsv1.1,sslv3\n\nIf the value is not set as above or it does not exist, this is a finding.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols\n\nIf the value returned is not \"tlsv1,tlsv1.1,sslv3\" or the setting does not\nexist, this is a finding.",
        "fix": "From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.ESXiVPsDisabledProtocols value and set to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols |\nSet-AdvancedSetting -Value \"tlsv1,tlsv1.1,sslv3\"\n\nA host reboot is required for changes to take effect."
      },
      "code": "control \"V-94483\" do\n  title \"The ESXi host must exclusively enable TLS 1.2 for the ioFilter, vSANVP\nand reverse proxy services.\"\n  desc  \"TLS 1.0 and 1.1 are deprecated protocols with well published\nshortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces\nand SSLv3, TL 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break\nthird party integrations and add-ons to vSphere. Test these integrations\ncarefully after implementing TLS 1.2 and roll back where appropriate. On\ninterfaces where required functionality is broken with TLS 1.2 this finding is\nN/A until such time as the third party software supports TLS 1.2.\n\n    Make sure you modify TLS settings in the following order: 1. Platform\nServices Controllers (if applicable), 2. vCenter, 3. ESXi\n  \"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94483\"\n  tag \"rid\": \"SV-104313r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000074\"\n  tag \"fix_id\": \"F-100599r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.ESXiVPsDisabledProtocols value and verify that it is set to the\nfollowing:\n\ntlsv1,tlsv1.1,sslv3\n\nIf the value is not set as above or it does not exist, this is a finding.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols\n\nIf the value returned is not \\\"tlsv1,tlsv1.1,sslv3\\\" or the setting does not\nexist, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client, select the host and then click\nConfigure >> System >> Advanced System Settings. Find the\nUserVars.ESXiVPsDisabledProtocols value and set to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols |\nSet-AdvancedSetting -Value \\\"tlsv1,tlsv1.1,sslv3\\\"\n\nA host reboot is required for changes to take effect.\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match \"tlsv1,tlsv1.1,sslv3\" }\nend\n\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94483.rb",
        "line": 1
      },
      "id": "V-94483"
    },
    {
      "title": "The ESXi host SSH daemon must not allow compression or must only allow\ncompression after successful authentication.",
      "desc": "If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection, potentially with\nroot privileges.",
      "descriptions": {
        "default": "If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection, potentially with\nroot privileges."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93989",
        "rid": "SV-104075r1_rule",
        "stig_id": "ESXI-65-000021",
        "fix_id": "F-100237r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^Compression\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Compression no\", this is\na finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nCompression no"
      },
      "code": "control \"V-93989\" do\n  title \"The ESXi host SSH daemon must not allow compression or must only allow\ncompression after successful authentication.\"\n  desc  \"If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection, potentially with\nroot privileges.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93989\"\n  tag \"rid\": \"SV-104075r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000021\"\n  tag \"fix_id\": \"F-100237r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^Compression\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"Compression no\\\", this is\na finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nCompression no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93989.rb",
        "line": 1
      },
      "id": "V-93989"
    },
    {
      "title": "The ESXi host must display the Standard Mandatory DoD Notice and\nConsent Banner before granting access to the system.",
      "desc": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.",
      "descriptions": {
        "default": "Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000023-VMM-000060",
        "gid": "V-93961",
        "rid": "SV-104047r1_rule",
        "stig_id": "ESXI-65-000007",
        "fix_id": "F-100209r1_fix",
        "cci": [
          "CCI-000048"
        ],
        "nist": [
          "AC-8 a",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nAnnotations.WelcomeMessage value and verify it contains the DoD logon banner to\nfollow.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage\n\nCheck for either of the following login banners based on the character\nlimitations imposed by the system. An exact match of the text is required. If\none of these banners is not displayed, this is a finding.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent\nto the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests- -not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nOR\n\nI've read & consent to terms in IS user agreem't.\n\nIf the DCUI logon screen does not display the DoD logon banner, this is a\nfinding.",
        "fix": "From a PowerCLI command prompt while connected to the ESXi host\ncopy the following contents into a script(.ps1 file) and run to set the DCUI\nscreen to display the DoD logon banner:\n\n<script begin>\n\n$value = @\"\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} ,\n{ip}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct}\n{esxversion}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory}\nRAM{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:white}\n{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are\naccessing a U.S. Government (USG) Information System (IS) that is provided for\nUSG-authorized use only. By      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this\nIS (which includes any device attached to this IS), you consent to the\nfollowing conditions:                 {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       The\nUSG routinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          to,\npenetration testing, COMSEC monitoring, network operations and defense,\npersonnel misconduct (PM), law      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\nenforcement (LE), and counterintelligence (CI) investigations.\n                                {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       At\nany time, the USG may inspect and seize data stored on this IS.\n                             {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nCommunications using, or data stored on, this IS are not private, are subject\nto routine monitoring,            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\ninterception, and search, and may be disclosed or used for any USG-authorized\npurpose.                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       This\nIS includes security measures (e.g., authentication and access controls) to\nprotect USG interests--not     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          for\nyour personal benefit or privacy.\n                            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nNotwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching    {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or\nmonitoring of the content of privileged communications, or work product,\nrelated to personal representation  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or\nservices by attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work       {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\nproduct are private and confidential. See User Agreement for details.\n                                {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2>\nAccept Conditions and Customize System / View Logs{/align}{align:right}<F12>\nAccept Conditions and Shut Down/Restart  {bgcolor:black}\n{/color}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n\"@\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage |\nSet-AdvancedSetting -Value $value\n\n<script end>"
      },
      "code": "control \"V-93961\" do\n  title \"The ESXi host must display the Standard Mandatory DoD Notice and\nConsent Banner before granting access to the system.\"\n  desc  \"Failure to display the DoD logon banner prior to a log in attempt will\nnegate legal proceedings resulting from unauthorized access to system\nresources.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000023-VMM-000060\"\n  tag \"gid\": \"V-93961\"\n  tag \"rid\": \"SV-104047r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000007\"\n  tag \"fix_id\": \"F-100209r1_fix\"\n  tag \"cci\": [\"CCI-000048\"]\n  tag \"nist\": [\"AC-8 a\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nAnnotations.WelcomeMessage value and verify it contains the DoD logon banner to\nfollow.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage\n\nCheck for either of the following login banners based on the character\nlimitations imposed by the system. An exact match of the text is required. If\none of these banners is not displayed, this is a finding.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent\nto the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests- -not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nOR\n\nI've read & consent to terms in IS user agreem't.\n\nIf the DCUI logon screen does not display the DoD logon banner, this is a\nfinding.\"\n  tag \"fix\": \"From a PowerCLI command prompt while connected to the ESXi host\ncopy the following contents into a script(.ps1 file) and run to set the DCUI\nscreen to display the DoD logon banner:\n\n<script begin>\n\n$value = @\\\"\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} ,\n{ip}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct}\n{esxversion}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory}\nRAM{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:white}\n{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are\naccessing a U.S. Government (USG) Information System (IS) that is provided for\nUSG-authorized use only. By      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this\nIS (which includes any device attached to this IS), you consent to the\nfollowing conditions:                 {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       The\nUSG routinely intercepts and monitors communications on this IS for purposes\nincluding, but not limited     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          to,\npenetration testing, COMSEC monitoring, network operations and defense,\npersonnel misconduct (PM), law      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\nenforcement (LE), and counterintelligence (CI) investigations.\n                                {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       At\nany time, the USG may inspect and seize data stored on this IS.\n                             {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nCommunications using, or data stored on, this IS are not private, are subject\nto routine monitoring,            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\ninterception, and search, and may be disclosed or used for any USG-authorized\npurpose.                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       This\nIS includes security measures (e.g., authentication and access controls) to\nprotect USG interests--not     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          for\nyour personal benefit or privacy.\n                            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -\nNotwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching    {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or\nmonitoring of the content of privileged communications, or work product,\nrelated to personal representation  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or\nservices by attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work       {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\nproduct are private and confidential. See User Agreement for details.\n                                {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}\n\n                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2>\nAccept Conditions and Customize System / View Logs{/align}{align:right}<F12>\nAccept Conditions and Shut Down/Restart  {bgcolor:black}\n{/color}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}\n\n                  {/color}{/bgcolor}\n\\\"@\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage |\nSet-AdvancedSetting -Value $value\n\n<script end>\"\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not eq \"\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93961.rb",
        "line": 1
      },
      "id": "V-93961"
    },
    {
      "title": "The ESXi host must verify the integrity of the installation media\nbefore installing ESXi.",
      "desc": "Always check the SHA1 or MD5 hash after downloading an ISO, offline\nbundle, or patch to ensure integrity and authenticity of the downloaded files.",
      "descriptions": {
        "default": "Always check the SHA1 or MD5 hash after downloading an ISO, offline\nbundle, or patch to ensure integrity and authenticity of the downloaded files."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94477",
        "rid": "SV-104307r1_rule",
        "stig_id": "ESXI-65-000071",
        "fix_id": "F-100593r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "The downloaded ISO, offline bundle, or patch hash must be\nverified against the vendor's checksum to ensure the integrity and authenticity\nof the files.\n\nSee some typical command line example(s) for both the md5 and sha1 hash\ncheck(s) directly below.\n\n# md5sum <filename>.iso\n# sha1sum <filename>.iso\n\nIf any of the system's downloaded ISO, offline bundle, or system patch hashes\ncannot be verified against the vendor's checksum, this is a finding.",
        "fix": "If the hash returned from the md5sum or sha1sum commands do not\nmatch the vendor's hash, the downloaded software must be discarded.\n\nIf the physical media is obtained from VMware and the security seal is broken,\nthe software must be returned to VMware for replacement."
      },
      "code": "control \"V-94477\" do\n  title \"The ESXi host must verify the integrity of the installation media\nbefore installing ESXi.\"\n  desc  \"Always check the SHA1 or MD5 hash after downloading an ISO, offline\nbundle, or patch to ensure integrity and authenticity of the downloaded files.\"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94477\"\n  tag \"rid\": \"SV-104307r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000071\"\n  tag \"fix_id\": \"F-100593r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"The downloaded ISO, offline bundle, or patch hash must be\nverified against the vendor's checksum to ensure the integrity and authenticity\nof the files.\n\nSee some typical command line example(s) for both the md5 and sha1 hash\ncheck(s) directly below.\n\n# md5sum <filename>.iso\n# sha1sum <filename>.iso\n\nIf any of the system's downloaded ISO, offline bundle, or system patch hashes\ncannot be verified against the vendor's checksum, this is a finding.\"\n  tag \"fix\": \"If the hash returned from the md5sum or sha1sum commands do not\nmatch the vendor's hash, the downloaded software must be discarded.\n\nIf the physical media is obtained from VMware and the security seal is broken,\nthe software must be returned to VMware for replacement.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94477.rb",
        "line": 1
      },
      "id": "V-94477"
    },
    {
      "title": "The ESXi host SSH daemon must set a timeout count on idle sessions.",
      "desc": "This ensures a user login will be terminated as soon as the\n\"ClientAliveCountMax\" is reached.",
      "descriptions": {
        "default": "This ensures a user login will be terminated as soon as the\n\"ClientAliveCountMax\" is reached."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93999",
        "rid": "SV-104085r1_rule",
        "stig_id": "ESXI-65-000026",
        "fix_id": "F-100247r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^ClientAliveCountMax\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"ClientAliveCountMax 3\",\nthis is a finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nClientAliveCountMax 3"
      },
      "code": "control \"V-93999\" do\n  title \"The ESXi host SSH daemon must set a timeout count on idle sessions.\"\n  desc  \"This ensures a user login will be terminated as soon as the\n\\\"ClientAliveCountMax\\\" is reached.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93999\"\n  tag \"rid\": \"SV-104085r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000026\"\n  tag \"fix_id\": \"F-100247r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^ClientAliveCountMax\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"ClientAliveCountMax 3\\\",\nthis is a finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nClientAliveCountMax 3\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93999.rb",
        "line": 1
      },
      "id": "V-93999"
    },
    {
      "title": "The ESXi host must enforce password complexity by requiring that at\nleast one numeric character be used.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000071-VMM-000380",
        "gid": "V-94525",
        "rid": "SV-104355r1_rule",
        "stig_id": "ESXI-65-200031",
        "fix_id": "F-100641r1_fix",
        "cci": [
          "CCI-000194"
        ],
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and verify it is set to\n\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" value is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94525\" do\n  title \"The ESXi host must enforce password complexity by requiring that at\nleast one numeric character be used.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000071-VMM-000380\"\n  tag \"gid\": \"V-94525\"\n  tag \"rid\": \"SV-104355r1_rule\"\n  tag \"stig_id\": \"ESXI-65-200031\"\n  tag \"fix_id\": \"F-100641r1_fix\"\n  tag \"cci\": [\"CCI-000194\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and verify it is set to\n\\\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \\\"Security.PasswordQualityControl\\\" value is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94525.rb",
        "line": 1
      },
      "id": "V-94525"
    },
    {
      "title": "The ESXi host SSH daemon must not permit tunnels.",
      "desc": "OpenSSH has the ability to create network tunnels (layer-2 and\nlayer-3) over an SSH connection. This function can provide similar convenience\nto a Virtual Private Network (VPN) with the similar risk of providing a path to\ncircumvent firewalls and network ACLs.",
      "descriptions": {
        "default": "OpenSSH has the ability to create network tunnels (layer-2 and\nlayer-3) over an SSH connection. This function can provide similar convenience\nto a Virtual Private Network (VPN) with the similar risk of providing a path to\ncircumvent firewalls and network ACLs."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-93997",
        "rid": "SV-104083r1_rule",
        "stig_id": "ESXI-65-000025",
        "fix_id": "F-100245r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \"^PermitTunnel\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitTunnel no\", this is\na finding.",
        "fix": "From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitTunnel no"
      },
      "code": "control \"V-93997\" do\n  title \"The ESXi host SSH daemon must not permit tunnels.\"\n  desc  \"OpenSSH has the ability to create network tunnels (layer-2 and\nlayer-3) over an SSH connection. This function can provide similar convenience\nto a Virtual Private Network (VPN) with the similar risk of providing a path to\ncircumvent firewalls and network ACLs.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-93997\"\n  tag \"rid\": \"SV-104083r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000025\"\n  tag \"fix_id\": \"F-100245r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From an SSH session connected to the ESXi host, or from the\nESXi shell, run the following command:\n\n# grep -i \\\"^PermitTunnel\\\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \\\"PermitTunnel no\\\", this is\na finding.\"\n  tag \"fix\": \"From an SSH session connected to the ESXi host, or from the ESXi\nshell, add or correct the following line in \\\"/etc/ssh/sshd_config\\\":\n\nPermitTunnel no\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93997.rb",
        "line": 1
      },
      "id": "V-93997"
    },
    {
      "title": "The ESXi host must disable Inter-VM transparent page sharing.",
      "desc": "Published academic papers have demonstrated that by forcing a flush\nand reload of cache memory, it is possible to measure memory timings to try and\ndetermine an AES encryption key in use on another virtual machine running on\nthe same physical processor of the host server if Transparent Page Sharing is\nenabled between the two virtual machines. This technique works only in a highly\ncontrolled system configured in a non-standard way that VMware believes would\nnot be recreated in a production environment.\n\n    Even though VMware believes information being disclosed in real world\nconditions is unrealistic, out of an abundance of caution upcoming ESXi Update\nreleases will no longer enable TPS between Virtual Machines by default (TPS\nwill still be utilized within individual VMs).",
      "descriptions": {
        "default": "Published academic papers have demonstrated that by forcing a flush\nand reload of cache memory, it is possible to measure memory timings to try and\ndetermine an AES encryption key in use on another virtual machine running on\nthe same physical processor of the host server if Transparent Page Sharing is\nenabled between the two virtual machines. This technique works only in a highly\ncontrolled system configured in a non-standard way that VMware believes would\nnot be recreated in a production environment.\n\n    Even though VMware believes information being disclosed in real world\nconditions is unrealistic, out of an abundance of caution upcoming ESXi Update\nreleases will no longer enable TPS between Virtual Machines by default (TPS\nwill still be utilized within individual VMs)."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94057",
        "rid": "SV-104143r1_rule",
        "stig_id": "ESXI-65-000055",
        "fix_id": "F-100305r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nMem.ShareForceSalting value and verify it is set to 2.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting\n\nIf the Mem.ShareForceSalting setting is not set to 2, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nMem.ShareForceSalting value and configure it to 2.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting |\nSet-AdvancedSetting -Value 2"
      },
      "code": "control \"V-94057\" do\n  title \"The ESXi host must disable Inter-VM transparent page sharing.\"\n  desc  \"Published academic papers have demonstrated that by forcing a flush\nand reload of cache memory, it is possible to measure memory timings to try and\ndetermine an AES encryption key in use on another virtual machine running on\nthe same physical processor of the host server if Transparent Page Sharing is\nenabled between the two virtual machines. This technique works only in a highly\ncontrolled system configured in a non-standard way that VMware believes would\nnot be recreated in a production environment.\n\n    Even though VMware believes information being disclosed in real world\nconditions is unrealistic, out of an abundance of caution upcoming ESXi Update\nreleases will no longer enable TPS between Virtual Machines by default (TPS\nwill still be utilized within individual VMs).\n  \"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94057\"\n  tag \"rid\": \"SV-104143r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000055\"\n  tag \"fix_id\": \"F-100305r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Select the\nMem.ShareForceSalting value and verify it is set to 2.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting\n\nIf the Mem.ShareForceSalting setting is not set to 2, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nMem.ShareForceSalting value and configure it to 2.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting |\nSet-AdvancedSetting -Value 2\"\n\n\ncommand = '(Get-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting).Value'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should match \"2\" }\nend\n\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94057.rb",
        "line": 1
      },
      "id": "V-94057"
    },
    {
      "title": "The ESXi host must use the vSphere Authentication Proxy to protect\npasswords when adding ESXi hosts to Active Directory.",
      "desc": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.",
      "descriptions": {
        "default": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000104-VMM-000500",
        "gid": "V-94023",
        "rid": "SV-104109r1_rule",
        "stig_id": "ESXI-65-000038",
        "fix_id": "F-100271r1_fix",
        "cci": [
          "CCI-000764"
        ],
        "nist": [
          "IA-2",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client go to Home >> Host Profiles >> and\nselect a Host Profile to edit. View the settings under Security and Services >>\nSecurity Settings >> Authentication Configuration >> Active Directory\nConfiguration >> Join Domain Method. Verify the method used to join hosts to a\ndomain is set to \"Use vSphere Authentication Proxy to add the host to domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, `\n@{N=\"JoinADEnabled\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\"JoinDomainMethod\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\"JoinDomainMethodPolicy\"}).Policyoption.Id}}\n\nVerify if JoinADEnabled is True then JoinDomainMethod should be\n\"FixedCAMConfigOption\".\n\nIf you are not using Host Profiles to join active directory, this is not a\nfinding.",
        "fix": "From the vSphere Web Client go to Home >> Host Profiles >> and\nselect a Host Profile to edit. View the settings under Security and Services >>\nSecurity Settings >> Authentication Configuration >> Active Directory\nConfiguration >> Join Domain Method. Set the method used to join hosts to a\ndomain to \"Use vSphere Authentication Proxy to add the host to domain\" and\nprovide the IP address of the vSphere Authentication Proxy server."
      },
      "code": "control \"V-94023\" do\n  title \"The ESXi host must use the vSphere Authentication Proxy to protect\npasswords when adding ESXi hosts to Active Directory.\"\n  desc  \"If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000104-VMM-000500\"\n  tag \"gid\": \"V-94023\"\n  tag \"rid\": \"SV-104109r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000038\"\n  tag \"fix_id\": \"F-100271r1_fix\"\n  tag \"cci\": [\"CCI-000764\"]\n  tag \"nist\": [\"IA-2\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client go to Home >> Host Profiles >> and\nselect a Host Profile to edit. View the settings under Security and Services >>\nSecurity Settings >> Authentication Configuration >> Active Directory\nConfiguration >> Join Domain Method. Verify the method used to join hosts to a\ndomain is set to \\\"Use vSphere Authentication Proxy to add the host to domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\\\"HostProfile\\\";E={$_ | Get-VMHostProfile}}, `\n@{N=\\\"JoinADEnabled\\\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\\\"JoinDomainMethod\\\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\\\"JoinDomainMethodPolicy\\\"}).Policyoption.Id}}\n\nVerify if JoinADEnabled is True then JoinDomainMethod should be\n\\\"FixedCAMConfigOption\\\".\n\nIf you are not using Host Profiles to join active directory, this is not a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client go to Home >> Host Profiles >> and\nselect a Host Profile to edit. View the settings under Security and Services >>\nSecurity Settings >> Authentication Configuration >> Active Directory\nConfiguration >> Join Domain Method. Set the method used to join hosts to a\ndomain to \\\"Use vSphere Authentication Proxy to add the host to domain\\\" and\nprovide the IP address of the vSphere Authentication Proxy server.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94023.rb",
        "line": 1
      },
      "id": "V-94023"
    },
    {
      "title": "The ESXi host must off-load audit records onto a different system or\nmedia than the system being audited by configuring remote logging.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000342-VMM-001230",
        "gid": "V-94551",
        "rid": "SV-104381r1_rule",
        "stig_id": "ESXI-65-400004",
        "fix_id": "F-100667r1_fix",
        "cci": [
          "CCI-001851"
        ],
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" value is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Syslog.global.logHost\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<insert syslog server hostname>\""
      },
      "code": "control \"V-94551\" do\n  title \"The ESXi host must off-load audit records onto a different system or\nmedia than the system being audited by configuring remote logging.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000342-VMM-001230\"\n  tag \"gid\": \"V-94551\"\n  tag \"rid\": \"SV-104381r1_rule\"\n  tag \"stig_id\": \"ESXI-65-400004\"\n  tag \"fix_id\": \"F-100667r1_fix\"\n  tag \"cci\": [\"CCI-001851\"]\n  tag \"nist\": [\"AU-4 (1)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand verify it is set to a site specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \\\"Syslog.global.logHost\\\" value is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Syslog.global.logHost\\\" value\nand configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<insert syslog server hostname>\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94551.rb",
        "line": 1
      },
      "id": "V-94551"
    },
    {
      "title": "The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by using the\nvSphere Authentication Proxy.",
      "desc": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.",
      "descriptions": {
        "default": "If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000109-VMM-000550",
        "gid": "V-94507",
        "rid": "SV-104337r1_rule",
        "stig_id": "ESXI-65-100038",
        "fix_id": "F-100623r1_fix",
        "cci": [
          "CCI-000770"
        ],
        "nist": [
          "IA-2 (5)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "For systems that do not use Active Directory and have no local\nuser accounts, other than \"root\" and/or \"vpxuser\", this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomain Method.  Verify the method used to join\nhosts to a domain is set to \"Use vSphere Authentication Proxy to add the host\nto domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, `\n@{N=\"JoinADEnabled\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\"JoinDomainMethod\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\"JoinDomainMethodPolicy\"}).Policyoption.Id}}\n\nVerify if JoinADEnabled is True then JoinDomainMethod should be\n\"FixedCAMConfigOption\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \"root\" and/or \"vpxuser\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.",
        "fix": "When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomain Method.  Set the method used to join\nhosts to a domain to \"Use vSphere Authentication Proxy to add the host to\ndomain\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi Host and go to Configuration >>\nAuthentication Services.  Click Properties and change the \"Directory Service\nType\" to Active Directory, enter the domain to join, check \"Use vSphere\nAuthentication Proxy\" and enter the proxy server address then click \"Join\nDomain\"."
      },
      "code": "control \"V-94507\" do\n  title \"The ESXi host must require individuals to be authenticated with an\nindividual authenticator prior to using a group authenticator by using the\nvSphere Authentication Proxy.\"\n  desc  \"If you configure your host to join an Active Directory domain using\nHost Profiles the Active Directory credentials are saved in the host profile\nand are transmitted over the network. To avoid having to save Active Directory\ncredentials in the Host Profile and to avoid transmitting Active Directory\ncredentials over the network use the vSphere Authentication Proxy.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000109-VMM-000550\"\n  tag \"gid\": \"V-94507\"\n  tag \"rid\": \"SV-104337r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100038\"\n  tag \"fix_id\": \"F-100623r1_fix\"\n  tag \"cci\": [\"CCI-000770\"]\n  tag \"nist\": [\"IA-2 (5)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For systems that do not use Active Directory and have no local\nuser accounts, other than \\\"root\\\" and/or \\\"vpxuser\\\", this is not applicable.\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomain Method.  Verify the method used to join\nhosts to a domain is set to \\\"Use vSphere Authentication Proxy to add the host\nto domain\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to vCenter run the following\ncommand:\n\nGet-VMHost | Select Name, ` @{N=\\\"HostProfile\\\";E={$_ | Get-VMHostProfile}}, `\n@{N=\\\"JoinADEnabled\\\";E={($_ |\nGet-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}},\n` @{N=\\\"JoinDomainMethod\\\";E={(($_ |\nGet-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory\n| Select -ExpandProperty Policy | Where {$_.Id -eq\n\\\"JoinDomainMethodPolicy\\\"}).Policyoption.Id}}\n\nVerify if JoinADEnabled is True then JoinDomainMethod should be\n\\\"FixedCAMConfigOption\\\".\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than \\\"root\\\" and/or \\\"vpxuser\\\", this is a finding.\n\nIf vSphere Authentication Proxy is not used to join hosts to an Active\nDirectory domain, this is a finding.\"\n  tag \"fix\": \"When using host profiles do the following:\n\nFrom the vSphere Client go to Home >> Host Profiles and select a Host Profile\nto edit.  View the settings under Authentication Configuration >> Active\nDirectory Configuration >> JoinDomain Method.  Set the method used to join\nhosts to a domain to \\\"Use vSphere Authentication Proxy to add the host to\ndomain\\\" and provide the IP address of the vSphere Authentication Proxy server.\n\nTo join a host to Active Directory manually without host profiles do the\nfollowing:\n\nFrom the vSphere Client select the ESXi Host and go to Configuration >>\nAuthentication Services.  Click Properties and change the \\\"Directory Service\nType\\\" to Active Directory, enter the domain to join, check \\\"Use vSphere\nAuthentication Proxy\\\" and enter the proxy server address then click \\\"Join\nDomain\\\".\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94507.rb",
        "line": 1
      },
      "id": "V-94507"
    },
    {
      "title": "For the ESXi host all port groups must be configured to a value other\nthan that of the native VLAN.",
      "desc": "ESXi does not use the concept of native VLAN. Frames with VLAN\nspecified in the port group will have a tag, but frames with VLAN not specified\nin the port group are not tagged and therefore will end up as belonging to\nnative VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco\nphysical switch will be untagged, because this is considered as the native\nVLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a\n\"1\"; therefore, traffic from ESXi that is destined for the native VLAN will\nnot be correctly routed (because it is tagged with a \"1\" instead of being\nuntagged), and traffic from the physical switch coming from the native VLAN\nwill not be visible (because it is not tagged). If the ESXi virtual switch port\ngroup uses the native VLAN ID, traffic from those VMs will not be visible to\nthe native VLAN on the switch, because the switch is expecting untagged\ntraffic.",
      "descriptions": {
        "default": "ESXi does not use the concept of native VLAN. Frames with VLAN\nspecified in the port group will have a tag, but frames with VLAN not specified\nin the port group are not tagged and therefore will end up as belonging to\nnative VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco\nphysical switch will be untagged, because this is considered as the native\nVLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a\n\"1\"; therefore, traffic from ESXi that is destined for the native VLAN will\nnot be correctly routed (because it is tagged with a \"1\" instead of being\nuntagged), and traffic from the physical switch coming from the native VLAN\nwill not be visible (because it is not tagged). If the ESXi virtual switch port\ngroup uses the native VLAN ID, traffic from those VMs will not be visible to\nthe native VLAN on the switch, because the switch is expecting untagged\ntraffic."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94073",
        "rid": "SV-104159r1_rule",
        "stig_id": "ESXI-65-000063",
        "fix_id": "F-100321r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to the native VLAN ID of\nthe attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with the native VLAN of the ESXi hosts attached\nphysical switch, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to native VLAN ID) and click Edit settings. Change the VLAN ID to a\nnon-native VLAN and click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId\n\"New VLAN#\""
      },
      "code": "control \"V-94073\" do\n  title \"For the ESXi host all port groups must be configured to a value other\nthan that of the native VLAN.\"\n  desc  \"ESXi does not use the concept of native VLAN. Frames with VLAN\nspecified in the port group will have a tag, but frames with VLAN not specified\nin the port group are not tagged and therefore will end up as belonging to\nnative VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco\nphysical switch will be untagged, because this is considered as the native\nVLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a\n\\\"1\\\"; therefore, traffic from ESXi that is destined for the native VLAN will\nnot be correctly routed (because it is tagged with a \\\"1\\\" instead of being\nuntagged), and traffic from the physical switch coming from the native VLAN\nwill not be visible (because it is not tagged). If the ESXi virtual switch port\ngroup uses the native VLAN ID, traffic from those VMs will not be visible to\nthe native VLAN on the switch, because the switch is expecting untagged\ntraffic.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94073\"\n  tag \"rid\": \"SV-104159r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000063\"\n  tag \"fix_id\": \"F-100321r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. For each virtual switch, review\nthe port group VLAN tags and verify they are not set to the native VLAN ID of\nthe attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with the native VLAN of the ESXi hosts attached\nphysical switch, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Networking >> Virtual switches. Highlight a port group (where VLAN\nID set to native VLAN ID) and click Edit settings. Change the VLAN ID to a\nnon-native VLAN and click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VirtualPortGroup -Name \\\"portgroup name\\\" | Set-VirtualPortGroup -VLanId\n\\\"New VLAN#\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94073.rb",
        "line": 1
      },
      "id": "V-94073"
    },
    {
      "title": "Remote logging for ESXi hosts must be configured.",
      "desc": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.",
      "descriptions": {
        "default": "Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000032-VMM-000130",
        "gid": "V-93955",
        "rid": "SV-104041r1_rule",
        "stig_id": "ESXI-65-000004",
        "fix_id": "F-100203r1_fix",
        "cci": [
          "CCI-000067"
        ],
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSyslog.global.logHost value and verify it is set to a site specific syslog\nserver hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the Syslog.global.logHost setting is not set to a site specific syslog\nserver, this is a finding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSyslog.global.logHost value and configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \"<syslog server hostname>\""
      },
      "code": "control \"V-93955\" do\n  title \"Remote logging for ESXi hosts must be configured.\"\n  desc  \"Remote logging to a central log host provides a secure, centralized\nstore for ESXi logs. By gathering host log files onto a central host it can\nmore easily monitor all hosts with a single tool. It can also do aggregate\nanalysis and searching to look for such things as coordinated attacks on\nmultiple hosts. Logging to a secure, centralized log server also helps prevent\nlog tampering and also provides a long-term audit record.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000032-VMM-000130\"\n  tag \"gid\": \"V-93955\"\n  tag \"rid\": \"SV-104041r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000004\"\n  tag \"fix_id\": \"F-100203r1_fix\"\n  tag \"cci\": [\"CCI-000067\"]\n  tag \"nist\": [\"AC-17 (1)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings.  Select the\nSyslog.global.logHost value and verify it is set to a site specific syslog\nserver hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the Syslog.global.logHost setting is not set to a site specific syslog\nserver, this is a finding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Advanced System Settings. Click Edit and select the\nSyslog.global.logHost value and configure it to a site specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost |\nSet-AdvancedSetting -Value \\\"<syslog server hostname>\\\"\"\n\ncommand = 'Get-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not eq '' }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93955.rb",
        "line": 1
      },
      "id": "V-93955"
    },
    {
      "title": "The ESXi host must use Active Directory for local user authentication.",
      "desc": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.",
      "descriptions": {
        "default": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \"ESX Admins\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000104-VMM-000500",
        "gid": "V-94021",
        "rid": "SV-104107r1_rule",
        "stig_id": "ESXI-65-000037",
        "fix_id": "F-100269r1_fix",
        "cci": [
          "CCI-000764"
        ],
        "nist": [
          "IA-2",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services.  Verify the Directory Services\nType is set to Active Directory.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and have no local user accounts,\nother than root and/or vpxuser, this is not applicable.\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than root and/or vpxuser, this is a finding.\n\nIf the Directory Services Type is not set to \"Active Directory\", this is a\nfinding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services. Click Join Domain and enter the\nAD domain to join, select the \"Using credentials” radio button and enter the\ncredentials of an account with permissions to join machines to AD (use UPN\nnaming – user@domain) and then click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \"domain name\" -User \"username\" -Password \"password\""
      },
      "code": "control \"V-94021\" do\n  title \"The ESXi host must use Active Directory for local user authentication.\"\n  desc  \"Join ESXi hosts to an Active Directory (AD) domain to eliminate the\nneed to create and maintain multiple local user accounts. Using AD for user\nauthentication simplifies the ESXi host configuration, ensures password\ncomplexity and reuse policies are enforced and reduces the risk of security\nbreaches and unauthorized access.  Note: If the AD group \\\"ESX Admins\\\"\n(default) exists then all users and groups that are assigned as members to this\ngroup will have full administrative access to all ESXi hosts the domain.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000104-VMM-000500\"\n  tag \"gid\": \"V-94021\"\n  tag \"rid\": \"SV-104107r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000037\"\n  tag \"fix_id\": \"F-100269r1_fix\"\n  tag \"cci\": [\"CCI-000764\"]\n  tag \"nist\": [\"IA-2\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services.  Verify the Directory Services\nType is set to Active Directory.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and have no local user accounts,\nother than root and/or vpxuser, this is not applicable.\n\nFor systems that do not use Active Directory and do have local user accounts,\nother than root and/or vpxuser, this is a finding.\n\nIf the Directory Services Type is not set to \\\"Active Directory\\\", this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Authentication Services. Click Join Domain and enter the\nAD domain to join, select the \\\"Using credentials” radio button and enter the\ncredentials of an account with permissions to join machines to AD (use UPN\nnaming – user@domain) and then click OK.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain\n-Domain \\\"domain name\\\" -User \\\"username\\\" -Password \\\"password\\\"\"\n\ncommand = '(Get-VMHost | Get-VMHostAuthentication).DomainMembershipStatus'\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not eq \"\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94021.rb",
        "line": 1
      },
      "id": "V-94021"
    },
    {
      "title": "The ESXi host must enable bidirectional CHAP authentication for iSCSI\ntraffic.",
      "desc": "When enabled, vSphere performs bidirectional authentication of both\nthe iSCSI target and host. There is a potential for a MiTM attack, when not\nauthenticating both the iSCSI target and host, in which an attacker might\nimpersonate either side of the connection to steal data. Bidirectional\nauthentication mitigates this risk.",
      "descriptions": {
        "default": "When enabled, vSphere performs bidirectional authentication of both\nthe iSCSI target and host. There is a potential for a MiTM attack, when not\nauthenticating both the iSCSI target and host, in which an attacker might\nimpersonate either side of the connection to steal data. Bidirectional\nauthentication mitigates this risk."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94055",
        "rid": "SV-104141r1_rule",
        "stig_id": "ESXI-65-000054",
        "fix_id": "F-100303r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Storage >> Storage Adapters >> Select the iSCSI adapter >>\nProperties >> Authentication method and view the CHAP configuration and verify\nCHAP is \"Required\" for target and host authentication.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \"iscsi\"} | Select\nAuthenticationProperties -ExpandProperty AuthenticationProperties\n\nIf iSCSI is not used, this is not a finding.\n\nIf iSCSI is used and CHAP is not set to \"Required\" for both the target and\nhost, this is a finding.\n\nIf iSCSI is used and unique CHAP secrets are not used for each host, this is a\nfinding.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Storage >> Storage Adapters >> Select the iSCSI adapter >>\nProperties >> Authentication and click the Edit button. Set Authentication\nmethod to “Use bidirectional CHAP” and enter a unique secret for each traffic\nflow direction.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \"iscsi\"} | Set-VMHostHba\n-ChapType Required -ChapName \"chapname\" -ChapPassword \"password\"\n-MutualChapEnabled $true -MutualChapName \"mutualchapname\" -MutualChapPassword\n\"mutualpassword\""
      },
      "code": "control \"V-94055\" do\n  title \"The ESXi host must enable bidirectional CHAP authentication for iSCSI\ntraffic.\"\n  desc  \"When enabled, vSphere performs bidirectional authentication of both\nthe iSCSI target and host. There is a potential for a MiTM attack, when not\nauthenticating both the iSCSI target and host, in which an attacker might\nimpersonate either side of the connection to steal data. Bidirectional\nauthentication mitigates this risk.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94055\"\n  tag \"rid\": \"SV-104141r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000054\"\n  tag \"fix_id\": \"F-100303r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Storage >> Storage Adapters >> Select the iSCSI adapter >>\nProperties >> Authentication method and view the CHAP configuration and verify\nCHAP is \\\"Required\\\" for target and host authentication.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \\\"iscsi\\\"} | Select\nAuthenticationProperties -ExpandProperty AuthenticationProperties\n\nIf iSCSI is not used, this is not a finding.\n\nIf iSCSI is used and CHAP is not set to \\\"Required\\\" for both the target and\nhost, this is a finding.\n\nIf iSCSI is used and unique CHAP secrets are not used for each host, this is a\nfinding.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> Storage >> Storage Adapters >> Select the iSCSI adapter >>\nProperties >> Authentication and click the Edit button. Set Authentication\nmethod to “Use bidirectional CHAP” and enter a unique secret for each traffic\nflow direction.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \\\"iscsi\\\"} | Set-VMHostHba\n-ChapType Required -ChapName \\\"chapname\\\" -ChapPassword \\\"password\\\"\n-MutualChapEnabled $true -MutualChapName \\\"mutualchapname\\\" -MutualChapPassword\n\\\"mutualpassword\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94055.rb",
        "line": 1
      },
      "id": "V-94055"
    },
    {
      "title": "The ESXi host must limit the number of concurrent sessions to ten for\nall accounts and/or account types by enabling lockdown mode.",
      "desc": "Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced.",
      "descriptions": {
        "default": "Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000027-VMM-000080",
        "gid": "V-93949",
        "rid": "SV-104035r1_rule",
        "stig_id": "ESXI-65-000001",
        "fix_id": "F-100197r1_fix",
        "cci": [
          "CCI-000054"
        ],
        "nist": [
          "AC-10",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Scroll down to \"Lockdown Mode\" and\nverify it is set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Select\nName,@{N=\"Lockdown\";E={$_.Extensiondata.Config.LockdownMode}}\n\nIf Lockdown Mode is disabled, this is a finding.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.",
        "fix": "From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Click edit on \"Lockdown Mode\" and\nset to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$level = \"lockdownNormal\" OR \"lockdownStrict\"\n$vmhost = Get-VMHost -Name <hostname> | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.ChangeLockdownMode($level)\n\nNote: In strict lockdown mode the DCUI service is stopped. If the connection to\nvCenter Server is lost and the vSphere Web Client is no longer available, the\nESXi host becomes inaccessible."
      },
      "code": "control \"V-93949\" do\n  title \"The ESXi host must limit the number of concurrent sessions to ten for\nall accounts and/or account types by enabling lockdown mode.\"\n  desc  \"Enabling lockdown mode disables direct access to an ESXi host\nrequiring the host be managed remotely from vCenter Server. This is done to\nensure the roles and access controls implemented in vCenter are always enforced\nand users cannot bypass them by logging into a host directly. By forcing all\ninteraction to occur through vCenter Server, the risk of someone inadvertently\nattaining elevated privileges or performing tasks that are not properly audited\nis greatly reduced.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000027-VMM-000080\"\n  tag \"gid\": \"V-93949\"\n  tag \"rid\": \"SV-104035r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000001\"\n  tag \"fix_id\": \"F-100197r1_fix\"\n  tag \"cci\": [\"CCI-000054\"]\n  tag \"nist\": [\"AC-10\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile.  Scroll down to \\\"Lockdown Mode\\\" and\nverify it is set to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Select\nName,@{N=\\\"Lockdown\\\";E={$_.Extensiondata.Config.LockdownMode}}\n\nIf Lockdown Mode is disabled, this is a finding.\n\nFor environments that do not use vCenter server to manage ESXi, this is not\napplicable.\"\n  tag \"fix\": \"From the vSphere Web Client select the ESXi Host and go to\nConfigure >> System >> Security Profile. Click edit on \\\"Lockdown Mode\\\" and\nset to Enabled (Normal or Strict).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$level = \\\"lockdownNormal\\\" OR \\\"lockdownStrict\\\"\n$vmhost = Get-VMHost -Name <hostname> | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.ChangeLockdownMode($level)\n\nNote: In strict lockdown mode the DCUI service is stopped. If the connection to\nvCenter Server is lost and the vSphere Web Client is no longer available, the\nESXi host becomes inaccessible.\"\n\ncommand = '(Get-VMHost).Extensiondata.Config.LockdownMode'\n\ndescribe powercli_command(command) do\n  its('stdout.strip') { should_not match \"lockdownDisabled\" }\nend\n\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-93949.rb",
        "line": 1
      },
      "id": "V-93949"
    },
    {
      "title": "The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown by setting an idle timeout.",
      "desc": "If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The \"ESXiShellInteractiveTimeOut\" value\nallows you to automatically terminate idle shell sessions.",
      "descriptions": {
        "default": "If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The \"ESXiShellInteractiveTimeOut\" value\nallows you to automatically terminate idle shell sessions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000279-VMM-001010",
        "gid": "V-94513",
        "rid": "SV-104343r1_rule",
        "stig_id": "ESXI-65-100041",
        "fix_id": "F-100629r1_fix",
        "cci": [
          "CCI-002361"
        ],
        "nist": [
          "AC-12",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\"\nUserVars.ESXiShellInteractiveTimeOut\" value and verify it is set to \"600\"\n(10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut\n\nIf the \"UserVars.ESXiShellInteractiveTimeOut\" value is not set to \"600\",\nthis is a finding.",
        "fix": "From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the\n\"UserVars.ESXiShellInteractiveTimeOut\" value and configure it to \"600\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut |\nSet-AdvancedSetting -Value 600"
      },
      "code": "control \"V-94513\" do\n  title \"The ESXi host must automatically terminate a user session after\ninactivity timeouts have expired or at shutdown by setting an idle timeout.\"\n  desc  \"If a user forgets to log out of their SSH session, the idle connection\nwill remains open indefinitely, increasing the potential for someone to gain\nprivileged access to the host.  The \\\"ESXiShellInteractiveTimeOut\\\" value\nallows you to automatically terminate idle shell sessions.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000279-VMM-001010\"\n  tag \"gid\": \"V-94513\"\n  tag \"rid\": \"SV-104343r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100041\"\n  tag \"fix_id\": \"F-100629r1_fix\"\n  tag \"cci\": [\"CCI-002361\"]\n  tag \"nist\": [\"AC-12\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\\\"\nUserVars.ESXiShellInteractiveTimeOut\\\" value and verify it is set to \\\"600\\\"\n(10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut\n\nIf the \\\"UserVars.ESXiShellInteractiveTimeOut\\\" value is not set to \\\"600\\\",\nthis is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"UserVars.ESXiShellInteractiveTimeOut\\\" value and configure it to \\\"600\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut |\nSet-AdvancedSetting -Value 600\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94513.rb",
        "line": 1
      },
      "id": "V-94513"
    },
    {
      "title": "The ESXi host must enforce password complexity by requiring that at\nleast one lower-case character be used.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000070-VMM-000370",
        "gid": "V-94501",
        "rid": "SV-104331r1_rule",
        "stig_id": "ESXI-65-100031",
        "fix_id": "F-100617r1_fix",
        "cci": [
          "CCI-000193"
        ],
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and verify it is set to\n\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" value is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94501\" do\n  title \"The ESXi host must enforce password complexity by requiring that at\nleast one lower-case character be used.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000070-VMM-000370\"\n  tag \"gid\": \"V-94501\"\n  tag \"rid\": \"SV-104331r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100031\"\n  tag \"fix_id\": \"F-100617r1_fix\"\n  tag \"cci\": [\"CCI-000193\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and verify it is set to\n\\\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \\\"Security.PasswordQualityControl\\\" value is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94501.rb",
        "line": 1
      },
      "id": "V-94501"
    },
    {
      "title": "The ESXi host must allow only the ISSM (or individuals or roles\nappointed by the ISSM) to select which auditable events are to be audited.",
      "desc": "Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.",
      "descriptions": {
        "default": "Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000063-VMM-000310",
        "gid": "V-94499",
        "rid": "SV-104329r1_rule",
        "stig_id": "ESXI-65-100030",
        "fix_id": "F-100615r1_fix",
        "cci": [
          "CCI-000171"
        ],
        "nist": [
          "AU-12 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Config.HostAgent.log.level\"\nvalue and verify it is set to the default level of \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level\n\nIf the \"Config.HostAgent.log.level\" value is not set to \"info\", this is a\nfinding.\n\nNote: Verbose logging level is acceptable for troubleshooting purposes.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \"Config.HostAgent.log.level\"\nvalue and configure it to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level |\nSet-AdvancedSetting -Value \"info\""
      },
      "code": "control \"V-94499\" do\n  title \"The ESXi host must allow only the ISSM (or individuals or roles\nappointed by the ISSM) to select which auditable events are to be audited.\"\n  desc  \"Without establishing what types of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000063-VMM-000310\"\n  tag \"gid\": \"V-94499\"\n  tag \"rid\": \"SV-104329r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100030\"\n  tag \"fix_id\": \"F-100615r1_fix\"\n  tag \"cci\": [\"CCI-000171\"]\n  tag \"nist\": [\"AU-12 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Config.HostAgent.log.level\\\"\nvalue and verify it is set to the default level of \\\"info\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level\n\nIf the \\\"Config.HostAgent.log.level\\\" value is not set to \\\"info\\\", this is a\nfinding.\n\nNote: Verbose logging level is acceptable for troubleshooting purposes.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the \\\"Config.HostAgent.log.level\\\"\nvalue and configure it to \\\"info\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level |\nSet-AdvancedSetting -Value \\\"info\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94499.rb",
        "line": 1
      },
      "id": "V-94499"
    },
    {
      "title": "The ESXi host must enforce a minimum 15-character password length.",
      "desc": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.",
      "descriptions": {
        "default": "To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000078-VMM-000450",
        "gid": "V-94553",
        "rid": "SV-104383r1_rule",
        "stig_id": "ESXI-65-400031",
        "fix_id": "F-100669r1_fix",
        "cci": [
          "CCI-000205"
        ],
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and verify it is set to\n\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" value is not set to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\"Security.PasswordQualityControl\" value and configure it to \"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\""
      },
      "code": "control \"V-94553\" do\n  title \"The ESXi host must enforce a minimum 15-character password length.\"\n  desc  \"To enforce the use of complex passwords, minimum numbers of characters\nof different classes are mandated. The use of complex passwords reduces the\nability of attackers to successfully obtain valid passwords using guessing or\nexhaustive search techniques. Complexity requirements increase the password\nsearch space by requiring users to construct passwords from a larger character\nset than they may otherwise use.\"\n  impact 0.5\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000078-VMM-000450\"\n  tag \"gid\": \"V-94553\"\n  tag \"rid\": \"SV-104383r1_rule\"\n  tag \"stig_id\": \"ESXI-65-400031\"\n  tag \"fix_id\": \"F-100669r1_fix\"\n  tag \"cci\": [\"CCI-000205\"]\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi Host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and verify it is set to\n\\\"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\\\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \\\"Security.PasswordQualityControl\\\" value is not set to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Advanced Settings.  Select the\n\\\"Security.PasswordQualityControl\\\" value and configure it to \\\"similar=deny\nretry=3 min=disabled,disabled,disabled,disabled,15\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl |\nSet-AdvancedSetting -Value \\\"similar=deny retry=3\nmin=disabled,disabled,disabled,disabled,15\\\"\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94553.rb",
        "line": 1
      },
      "id": "V-94553"
    },
    {
      "title": "All ESXi host-connected physical switch ports must be configured with\nspanning tree disabled.",
      "desc": "Since VMware virtual switches do not support STP, the ESXi\nhost-connected physical switch ports must have portfast configured if spanning\ntree is enabled to avoid loops within the physical switch network. If these are\nnot set, potential performance and connectivity issues might arise.",
      "descriptions": {
        "default": "Since VMware virtual switches do not support STP, the ESXi\nhost-connected physical switch ports must have portfast configured if spanning\ntree is enabled to avoid loops within the physical switch network. If these are\nnot set, potential performance and connectivity issues might arise."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000480-VMM-002000",
        "gid": "V-94081",
        "rid": "SV-104167r1_rule",
        "stig_id": "ESXI-65-000067",
        "fix_id": "F-100329r1_fix",
        "cci": [
          "CCI-000366"
        ],
        "nist": [
          "CM-6 b",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of upstream physical\nswitches must be documented to ensure that spanning tree protocol is disabled\nand/or portfast is configured for all physical ports connected to ESXi hosts.\nInspect the documentation and verify that the documentation is updated on an\norganization defined frequency and/or whenever modifications are made to either\nESXi hosts or the upstream physical switches. Alternatively, log in to the\nphysical switch and verify that spanning tree protocol is disabled and/or\nportfast is configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's spanning tree protocol is not disabled or portfast is\nnot configured for all physical ports connected to ESXi hosts, this is a\nfinding.",
        "fix": "Note that this check refers to an entity outside the scope of the\nESXi server system. Document the upstream physical switch configuration for\nspanning tree protocol disablement and/or portfast configuration for all\nphysical ports connected to ESXi hosts. Log in to the physical switch(es) and\ndisable spanning tree protocol and/or configure portfast for all physical ports\nconnected to ESXi hosts. Update the documentation on an organization defined\nfrequency or whenever modifications are made to either ESXi hosts or the\nupstream physical switches."
      },
      "code": "control \"V-94081\" do\n  title \"All ESXi host-connected physical switch ports must be configured with\nspanning tree disabled.\"\n  desc  \"Since VMware virtual switches do not support STP, the ESXi\nhost-connected physical switch ports must have portfast configured if spanning\ntree is enabled to avoid loops within the physical switch network. If these are\nnot set, potential performance and connectivity issues might arise.\"\n  impact 0.3\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000480-VMM-002000\"\n  tag \"gid\": \"V-94081\"\n  tag \"rid\": \"SV-104167r1_rule\"\n  tag \"stig_id\": \"ESXI-65-000067\"\n  tag \"fix_id\": \"F-100329r1_fix\"\n  tag \"cci\": [\"CCI-000366\"]\n  tag \"nist\": [\"CM-6 b\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note that this check refers to an entity outside the physical\nscope of the ESXi server system. The configuration of upstream physical\nswitches must be documented to ensure that spanning tree protocol is disabled\nand/or portfast is configured for all physical ports connected to ESXi hosts.\nInspect the documentation and verify that the documentation is updated on an\norganization defined frequency and/or whenever modifications are made to either\nESXi hosts or the upstream physical switches. Alternatively, log in to the\nphysical switch and verify that spanning tree protocol is disabled and/or\nportfast is configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's spanning tree protocol is not disabled or portfast is\nnot configured for all physical ports connected to ESXi hosts, this is a\nfinding.\"\n  tag \"fix\": \"Note that this check refers to an entity outside the scope of the\nESXi server system. Document the upstream physical switch configuration for\nspanning tree protocol disablement and/or portfast configuration for all\nphysical ports connected to ESXi hosts. Log in to the physical switch(es) and\ndisable spanning tree protocol and/or configure portfast for all physical ports\nconnected to ESXi hosts. Update the documentation on an organization defined\nfrequency or whenever modifications are made to either ESXi hosts or the\nupstream physical switches.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94081.rb",
        "line": 1
      },
      "id": "V-94081"
    },
    {
      "title": "The ESXi host must employ a deny-all, permit-by-exception policy to\nallow the execution of authorized software programs and guest VMs by verifying\nImage Profile and VIP Acceptance Levels.",
      "desc": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
      "descriptions": {
        "default": "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000370-VMM-001460",
        "gid": "V-94521",
        "rid": "SV-104351r1_rule",
        "stig_id": "ESXI-65-100047",
        "fix_id": "F-100637r1_fix",
        "cci": [
          "CCI-001774"
        ],
        "nist": [
          "CM-7 (5) (b)",
          "Rev_4"
        ],
        "false_negatives": null,
        "false_positives": null,
        "documentable": false,
        "mitigations": null,
        "severity_override_guidance": false,
        "potential_impacts": null,
        "third_party_tools": null,
        "mitigation_controls": null,
        "responsibility": null,
        "ia_controls": null,
        "check": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Host Image Profile Acceptance\nLevel\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is \"CommunitySupported\", this is a finding.",
        "fix": "From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \"Host Image Profile Acceptance\nLevel\" edit the acceptance level to be either \"VMwareCertified\",\n\"VMwareAccepted\", or \"PartnerSupported\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\"PartnerSupported\")\n\nNote: \"VMwareCertified\" or \"VMwareAccepted\" may be substituted for\n\"PartnerSupported\", depending upon local requirements."
      },
      "code": "control \"V-94521\" do\n  title \"The ESXi host must employ a deny-all, permit-by-exception policy to\nallow the execution of authorized software programs and guest VMs by verifying\nImage Profile and VIP Acceptance Levels.\"\n  desc  \"Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned\nVIB represents untested code installed on an ESXi host.  The ESXi Image profile\nsupports four acceptance levels:\n\n    (1) VMwareCertified - VIBs created, tested and signed by VMware\n    (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed\nby VMware,\n    (3) PartnerSupported - VIBs created, tested and signed by a certified\nVMware partner\n    (4) CommunitySupported - VIBs that have not been tested by VMware or a\nVMware partner.\n\n    Community Supported VIBs are not supported and do not have a digital\nsignature.  To protect the security and integrity of your ESXi hosts do not\nallow unsigned (CommunitySupported) VIBs to be installed on your hosts.\n  \"\n  impact 0.7\n  tag \"severity\": nil\n  tag \"gtitle\": \"SRG-OS-000370-VMM-001460\"\n  tag \"gid\": \"V-94521\"\n  tag \"rid\": \"SV-104351r1_rule\"\n  tag \"stig_id\": \"ESXI-65-100047\"\n  tag \"fix_id\": \"F-100637r1_fix\"\n  tag \"cci\": [\"CCI-001774\"]\n  tag \"nist\": [\"CM-7 (5) (b)\", \"Rev_4\"]\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Host Image Profile Acceptance\nLevel\\\" view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.get()\n\nIf the acceptance level is \\\"CommunitySupported\\\", this is a finding.\"\n  tag \"fix\": \"From the vSphere Client select the ESXi host and go to\nConfiguration >> Security Profile.  Under \\\"Host Image Profile Acceptance\nLevel\\\" edit the acceptance level to be either \\\"VMwareCertified\\\",\n\\\"VMwareAccepted\\\", or \\\"PartnerSupported\\\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host run the\nfollowing commands:\n\n$esxcli = Get-EsxCli\n$esxcli.software.acceptance.Set(\\\"PartnerSupported\\\")\n\nNote: \\\"VMwareCertified\\\" or \\\"VMwareAccepted\\\" may be substituted for\n\\\"PartnerSupported\\\", depending upon local requirements.\"\nend\n",
      "source_location": {
        "ref": "./VMWare ESXI 6.5 STIG/controls/V-94521.rb",
        "line": 1
      },
      "id": "V-94521"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "V-94029"
      ],
      "id": "controls/V-94029.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93993"
      ],
      "id": "controls/V-93993.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94013"
      ],
      "id": "controls/V-94013.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93971"
      ],
      "id": "controls/V-93971.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94495"
      ],
      "id": "controls/V-94495.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94015"
      ],
      "id": "controls/V-94015.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94067"
      ],
      "id": "controls/V-94067.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94009"
      ],
      "id": "controls/V-94009.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94017"
      ],
      "id": "controls/V-94017.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94523"
      ],
      "id": "controls/V-94523.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94487"
      ],
      "id": "controls/V-94487.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93995"
      ],
      "id": "controls/V-93995.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94043"
      ],
      "id": "controls/V-94043.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94059"
      ],
      "id": "controls/V-94059.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94027"
      ],
      "id": "controls/V-94027.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94489"
      ],
      "id": "controls/V-94489.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94517"
      ],
      "id": "controls/V-94517.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94491"
      ],
      "id": "controls/V-94491.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94529"
      ],
      "id": "controls/V-94529.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93959"
      ],
      "id": "controls/V-93959.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94509"
      ],
      "id": "controls/V-94509.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94519"
      ],
      "id": "controls/V-94519.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94045"
      ],
      "id": "controls/V-94045.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93969"
      ],
      "id": "controls/V-93969.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94537"
      ],
      "id": "controls/V-94537.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94511"
      ],
      "id": "controls/V-94511.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94019"
      ],
      "id": "controls/V-94019.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94503"
      ],
      "id": "controls/V-94503.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94001"
      ],
      "id": "controls/V-94001.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93979"
      ],
      "id": "controls/V-93979.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94033"
      ],
      "id": "controls/V-94033.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94051"
      ],
      "id": "controls/V-94051.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94485"
      ],
      "id": "controls/V-94485.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94025"
      ],
      "id": "controls/V-94025.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94063"
      ],
      "id": "controls/V-94063.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93967"
      ],
      "id": "controls/V-93967.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94555"
      ],
      "id": "controls/V-94555.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94531"
      ],
      "id": "controls/V-94531.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94031"
      ],
      "id": "controls/V-94031.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93975"
      ],
      "id": "controls/V-93975.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93951"
      ],
      "id": "controls/V-93951.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94505"
      ],
      "id": "controls/V-94505.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93981"
      ],
      "id": "controls/V-93981.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94493"
      ],
      "id": "controls/V-94493.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93965"
      ],
      "id": "controls/V-93965.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93963"
      ],
      "id": "controls/V-93963.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94047"
      ],
      "id": "controls/V-94047.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93987"
      ],
      "id": "controls/V-93987.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94053"
      ],
      "id": "controls/V-94053.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94005"
      ],
      "id": "controls/V-94005.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94007"
      ],
      "id": "controls/V-94007.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94497"
      ],
      "id": "controls/V-94497.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94479"
      ],
      "id": "controls/V-94479.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94557"
      ],
      "id": "controls/V-94557.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94527"
      ],
      "id": "controls/V-94527.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94535"
      ],
      "id": "controls/V-94535.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93983"
      ],
      "id": "controls/V-93983.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94075"
      ],
      "id": "controls/V-94075.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94515"
      ],
      "id": "controls/V-94515.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94349"
      ],
      "id": "controls/V-94349.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94549"
      ],
      "id": "controls/V-94549.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94061"
      ],
      "id": "controls/V-94061.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94481"
      ],
      "id": "controls/V-94481.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94069"
      ],
      "id": "controls/V-94069.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94037"
      ],
      "id": "controls/V-94037.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94041"
      ],
      "id": "controls/V-94041.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94065"
      ],
      "id": "controls/V-94065.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93953"
      ],
      "id": "controls/V-93953.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94543"
      ],
      "id": "controls/V-94543.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93985"
      ],
      "id": "controls/V-93985.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94077"
      ],
      "id": "controls/V-94077.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94071"
      ],
      "id": "controls/V-94071.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94541"
      ],
      "id": "controls/V-94541.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94083"
      ],
      "id": "controls/V-94083.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94035"
      ],
      "id": "controls/V-94035.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94533"
      ],
      "id": "controls/V-94533.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93957"
      ],
      "id": "controls/V-93957.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94003"
      ],
      "id": "controls/V-94003.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93973"
      ],
      "id": "controls/V-93973.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94079"
      ],
      "id": "controls/V-94079.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93991"
      ],
      "id": "controls/V-93991.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94545"
      ],
      "id": "controls/V-94545.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94547"
      ],
      "id": "controls/V-94547.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94039"
      ],
      "id": "controls/V-94039.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93977"
      ],
      "id": "controls/V-93977.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94539"
      ],
      "id": "controls/V-94539.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94011"
      ],
      "id": "controls/V-94011.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94049"
      ],
      "id": "controls/V-94049.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94483"
      ],
      "id": "controls/V-94483.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93989"
      ],
      "id": "controls/V-93989.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93961"
      ],
      "id": "controls/V-93961.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94477"
      ],
      "id": "controls/V-94477.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93999"
      ],
      "id": "controls/V-93999.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94525"
      ],
      "id": "controls/V-94525.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93997"
      ],
      "id": "controls/V-93997.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94057"
      ],
      "id": "controls/V-94057.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94023"
      ],
      "id": "controls/V-94023.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94551"
      ],
      "id": "controls/V-94551.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94507"
      ],
      "id": "controls/V-94507.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94073"
      ],
      "id": "controls/V-94073.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93955"
      ],
      "id": "controls/V-93955.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94021"
      ],
      "id": "controls/V-94021.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94055"
      ],
      "id": "controls/V-94055.rb"
    },
    {
      "title": null,
      "controls": [
        "V-93949"
      ],
      "id": "controls/V-93949.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94513"
      ],
      "id": "controls/V-94513.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94501"
      ],
      "id": "controls/V-94501.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94499"
      ],
      "id": "controls/V-94499.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94553"
      ],
      "id": "controls/V-94553.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94081"
      ],
      "id": "controls/V-94081.rb"
    },
    {
      "title": null,
      "controls": [
        "V-94521"
      ],
      "id": "controls/V-94521.rb"
    }
  ],
  "inputs": [],
  "sha256": "b5ce48f47f5d879078046d4be3f7740e3b445c04abbc1d3243a28b7ed78fcc79",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.23.15"
  }
}